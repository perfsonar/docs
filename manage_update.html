
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Updating perfSONAR &#8212; perfSONAR Toolkit 5.1.3 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/perfsonar.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Central Archive with Grafana Cookbook" href="cookbook_central_archive.html" />
    <link rel="prev" title="Using perfSONAR with Ansible" href="install_ansible.html" />
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-52RNZ729B1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());
		gtag('config', 'G-52RNZ729B1');
	</script>
	 

  </head><body>
    <header>
        <div class="headerContents">
          <a href="index.html" border="0"><img src="_static/perfsonar-logo-black-full-100.png"></a>
          <div class="acctSearchContainer">
              <section id="searchBox" class="searchBox">
                  <!--Use of this code assumes agreement with the Google Custom Search Terms of Service. -->
                  <!--The terms of service are available at http://www.google.com/cse/docs/tos.html -->
                  <form action="search.html" id="cse-search-box" method="get">
                    <input type="text" name="q" size="25" class="searchInput" placeholder="Search"/>
                    <input type="hidden" name="check_keywords" value="yes" />
                    <input type="hidden" name="area" value="default" />
                  </form>
              </section>
         </div>
        </div>
    </header>
    <div style="display:block;clear:both;">
    
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="cookbook_central_archive.html" title="Central Archive with Grafana Cookbook"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="install_ansible.html" title="Using perfSONAR with Ansible"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">perfSONAR Toolkit 5.1.3 documentation</a> &#187;</li> 
      </ul>
    </div>
    </div>
    
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="updating-perfsonar">
<h1>Updating perfSONAR<a class="headerlink" href="#updating-perfsonar" title="Permalink to this headline">¶</a></h1>
<p>Just like any other host on your network, it is critical to stay up-to-date with the latest packages on your perfSONAR Toolkit. You will want to make sure you have the latest security fixes as well as the ability to take advantage of the great new features constantly being added to the tools. In general you will keep your host up-to-date with the operating system’s package manager (e.g. yum or apt), but in some special cases things may be more involved. Be sure to watch release notes and this page when such cases arise.</p>
<div class="section" id="manually-updating-with-yum-or-apt">
<h2>Manually Updating with Yum or APT<a class="headerlink" href="#manually-updating-with-yum-or-apt" title="Permalink to this headline">¶</a></h2>
<p>Anytime you want to manually update your host, simply run the following</p>
<p><em>CentOS</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">yum</span> <span class="n">update</span>
</pre></div>
</div>
<p><em>Debian</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span> <span class="n">update</span>
<span class="n">apt</span> <span class="n">upgrade</span>
</pre></div>
</div>
<p>The <em>yum</em> package manager is used by RedHat-based operating systems like CentOS to update packages, <em>apt-get</em> is used by Debian-based OS. Running the command above will download the latest perfSONAR packages as well as any operating system packages available.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When upgrading a Debian based host to a new minor version (X.Y.Z with X or Y changing), you’ll be asked by APT to accept the change in Version and Codename of the perfsonar-release repository.</p>
</div>
</div>
<div class="section" id="automatic-updates">
<span id="manage-update-auto"></span><h2>Automatic Updates<a class="headerlink" href="#automatic-updates" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Automatic updates are enabled by default in the perfSONAR Toolkit.</p>
</div>
<p>You may choose to enable automatic updates to aid in applying the latest software packages to your system. Automatic updates include all perfSONAR, operating system and third-party packages. Enabling this feature will help keep the latest security fixes on the system, but keep in mind it is possible some updates may break your host unexpectedly. The following rule of thumb from <a class="reference external" href="http://fedoraproject.org/wiki/AutoUpdates">Fedora</a> may be useful when considering whether to enable this feature:</p>
<blockquote class="epigraph">
<div><p>If the machine is a critical server, for which unplanned downtime of a service on the machine can not be tolerated, then you should not use automatic updates. Otherwise, you <strong>may</strong> choose to use them.</p>
</div></blockquote>
<p>It is also important to note that automatic updates do not perform all required system reboots or service restarts. Also, auto-updates happen nightly so there may be a period of up to 24 hours where you do not receive a patch. Enabling this feature still requires close monitoring of the host to make sure all updates are applied completely and properly.</p>
<div class="section" id="managing-automatic-updates-from-the-command-line">
<span id="manage-update-auto-cli"></span><h3>Managing Automatic Updates from the Command-Line<a class="headerlink" href="#managing-automatic-updates-from-the-command-line" title="Permalink to this headline">¶</a></h3>
<p>You can manage auto updates from the command-line by enabling/disabling the yum-cron service on CentOS and configuring the unattended-upgrades option of APT on Debian and Ubuntu.</p>
<p>Run the following commands to <strong>enable</strong> automatic updates (must be run as a root user):</p>
<p><em>CentOS</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">systemctl</span> <span class="n">enable</span> <span class="n">yum</span><span class="o">-</span><span class="n">cron</span>
<span class="n">systemctl</span> <span class="n">start</span> <span class="n">yum</span><span class="o">-</span><span class="n">cron</span>
</pre></div>
</div>
<p><em>Debian/Ubuntu</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">unattended</span><span class="o">-</span><span class="n">upgrades</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">perfsonar</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">system_environment</span><span class="o">/</span><span class="n">enable_auto_updates</span> <span class="n">new</span>
</pre></div>
</div>
<p>Likewise, you may <strong>disable</strong> auto-updates from the command-line by running the following:</p>
<p><em>CentOS</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">systemctl</span> <span class="n">stop</span> <span class="n">yum</span><span class="o">-</span><span class="n">cron</span>
<span class="n">systemctl</span> <span class="n">disable</span> <span class="n">yum</span><span class="o">-</span><span class="n">cron</span>
</pre></div>
</div>
<p><em>Debian/Ubuntu</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">purge</span> <span class="n">unattended</span><span class="o">-</span><span class="n">upgrades</span>
<span class="n">rm</span> <span class="o">-</span><span class="n">f</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">apt</span><span class="o">/</span><span class="n">apt</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="mi">60</span><span class="n">unattended</span><span class="o">-</span><span class="n">upgrades</span><span class="o">-</span><span class="n">perfsonar</span>
</pre></div>
</div>
<p><em>CentOS</em>:</p>
<p>These commands will automatically update <strong>all packages</strong> on the system. Also note that the main configuration file for auto-updates lives at <em>/etc/yum</em>. See the yum-cron man page or the page <a class="reference external" href="http://fedoraproject.org/wiki/AutoUpdates">here</a> for more information on using auto-updates and advanced options like excluding packages from update. Also see <a class="reference internal" href="#manage-update-auto-disable"><span class="std std-ref">Disabling Automatic Updates for perfSONAR Packages</span></a>.</p>
<p><em>Debian/Ubuntu</em>:</p>
<p>This configuration enables automatic updates for <a class="reference external" href="https://www.debian.org/security/">Debian security updates</a> or <a class="reference external" href="https://wiki.ubuntu.com/Security/Upgrades">Ubuntu security updates</a> and perfSONAR packages.</p>
</div>
<div class="section" id="managing-automatic-updates-from-the-toolkit-web-interface">
<span id="manage-update-auto-gui"></span><h3>Managing Automatic Updates from the Toolkit Web Interface<a class="headerlink" href="#managing-automatic-updates-from-the-toolkit-web-interface" title="Permalink to this headline">¶</a></h3>
<p>If you are running the perfSONAR Toolkit, you may enable/disable automatic updates for <strong>all packages</strong> (not just perfSONAR) on the system from the web interface as follows:</p>
<ol class="arabic">
<li><p>Open your toolkit web interface in a browser.</p></li>
<li><p>Click on the <strong>Configuration</strong> button in the right-upper corner and login as the web administrator user created during installation.</p>
<blockquote>
<div><img alt="_images/manage_update-configure-icon.png" src="_images/manage_update-configure-icon.png" />
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>See <a class="reference internal" href="manage_users.html"><span class="doc">Managing Users</span></a> for more details on creating a web administrator account.</p>
</div>
</div></blockquote>
</li>
<li><p>On the <strong>Host</strong> tab click the button under the <strong>Auto Updates</strong> heading to enable or disable auto-updates as indicated by the color and status text of the button.</p>
<blockquote>
<div><img alt="_images/manage_update-enable.png" src="_images/manage_update-enable.png" />
</div></blockquote>
</li>
<li><p>Click <strong>Save</strong> to apply your changes. After a loading screen you should see a green message at the bottom indicating your changes have been saved.</p></li>
</ol>
</div>
<div class="section" id="disabling-automatic-updates-for-perfsonar-packages">
<span id="manage-update-auto-disable"></span><h3>Disabling Automatic Updates for perfSONAR Packages<a class="headerlink" href="#disabling-automatic-updates-for-perfsonar-packages" title="Permalink to this headline">¶</a></h3>
<p>The commands in the previous sections control updates for the entire system. If you want to leave automatic updates on for base system packages, but would like to just disable the perfSONAR updates you can do so by following the steps in the previous sections and editing the file <strong>/etc/yum.repos.d/perfSONAR.repo</strong> with the option <strong>enabled</strong> set to <strong>0</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are running against one of our testing repositories you may also need to update the files <strong>/etc/yum.repos.d/perfSONAR-staging.repo</strong> and <strong>/etc/yum.repos.d/perfSONAR-nightly.repo</strong>.</p>
</div>
<p>To disable the automatic updating of perfSONAR packages on Debian/Ubuntu delete the line with <code class="docutils literal notranslate"><span class="pre">origin=perfSONAR</span></code> pattern from <code class="docutils literal notranslate"><span class="pre">/etc/apt/apt.conf.d/60unattended-upgrades-perfsonar</span></code>.  After that only the Debian security updates will be installed automatically.</p>
</div>
</div>
<div class="section" id="special-upgrade-notes">
<span id="manage-update-notes"></span><h2>Special Upgrade Notes<a class="headerlink" href="#special-upgrade-notes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="upgrading-to-perfsonar-5-x">
<h3>Upgrading to perfSONAR 5.X<a class="headerlink" href="#upgrading-to-perfsonar-5-x" title="Permalink to this headline">¶</a></h3>
<div class="section" id="archive-changes">
<h4>Archive changes<a class="headerlink" href="#archive-changes" title="Permalink to this headline">¶</a></h4>
<p>perfSONAR 5.0.0 brings with it a number of changes, the largest of which is the migration away from the default archive of esmond to a new archive based on <a class="reference external" href="https://opensearch.org/">OpenSearch</a>. <strong>DATA WILL NOT BE MIGRATED FROM ESMOND TO OPENSEARCH</strong></p>
<p>The update behavior you will see depends on the bundle you have installed:</p>
<ul class="simple">
<li><p><strong>perfsonar-toolkit and perfsonar-core</strong> - Your system will auto-update if enabled. <strong>YOUR DATA WILL NOT BE MIGRATED BUT WILL NOT BE DELETED</strong>. Esmond will be disabled but the data will stay on disk. You can re-enable Esmond but be aware that running Esmond and Opensearch simultaneously can consume significant system resources. If you want to access the data, we recomend moving to a new system running standalone esmond as detailed <a class="reference internal" href="legacy_archive_esmond.html"><span class="doc">here</span></a>.</p></li>
<li><p><strong>perfsonar-centralmanagement</strong> - This package will NOT auto-update since it is no longer available in perfSONAR 5.0.0. This gives large central archives a chance to control when they want to move users.</p></li>
</ul>
</div>
<div class="section" id="iso-image-no-longer-avaiable">
<h4>ISO Image No Longer Avaiable<a class="headerlink" href="#iso-image-no-longer-avaiable" title="Permalink to this headline">¶</a></h4>
<p>The CentOS 7 based ISO image for the Toolkit is no longer available starting in 5.0. The operating system packages (.rpm and .deb packages) as well as Docker containers will be the supported options going forward.</p>
</div>
<div class="section" id="esmond-api-compatibility">
<h4>Esmond API Compatibility<a class="headerlink" href="#esmond-api-compatibility" title="Permalink to this headline">¶</a></h4>
<p>perfSONAR 5.0.0 includes a component named elmond that provides full backward compatibility for esmond queries. The URL and format are exactly the same, so should be transparent to clients.</p>
</div>
<div class="section" id="pscheduler-limits-changes">
<h4>pScheduler Limits changes<a class="headerlink" href="#pscheduler-limits-changes" title="Permalink to this headline">¶</a></h4>
<p>pScheduler has removed support for the <em>test</em> limit type. It has been folded into the <em>jq</em> type. <strong>If you have not modified your limits file, then your limits file will be upgraded automatically.</strong> If you have made changes then you will have to manually migrate to the new format. The exact change will depend on your rul but an example of the new and old style can be found below:</p>
<p><em>Old format</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;#&quot;</span><span class="p">:</span> <span class="s2">&quot;This prevents denial of service by scheduling long tasks.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;idleex-default&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Default limits for idleex&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;idleex&quot;</span><span class="p">,</span>
    <span class="s2">&quot;limit&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;range&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;lower&quot;</span><span class="p">:</span> <span class="s2">&quot;PT1S&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;upper&quot;</span><span class="p">:</span> <span class="s2">&quot;PT2S&quot;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
    <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><em>New format</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;#&quot;</span><span class="p">:</span> <span class="s2">&quot;This prevents denial of service by scheduling long tasks.&quot;</span><span class="p">,</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;idleex-default&quot;</span><span class="p">,</span>
    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Default limits for idleex&quot;</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;jq&quot;</span><span class="p">,</span>
    <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;script&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;import </span><span class="se">\&quot;</span><span class="s2">pscheduler/iso8601</span><span class="se">\&quot;</span><span class="s2"> as iso;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;if .test.type == </span><span class="se">\&quot;</span><span class="s2">idleex</span><span class="se">\&quot;</span><span class="s2"> and iso::duration_as_seconds(.test.spec.duration) &gt; 2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;then </span><span class="se">\&quot;</span><span class="s2">Duration for idleex must be less than 2 seconds.</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="s2">&quot;else true&quot;</span><span class="p">,</span>
            <span class="s2">&quot;end&quot;</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <nav id="channelNav" class="channelNav">
                
                <ul>
<li><a class="reference internal" href="#">Updating perfSONAR</a><ul>
<li><a class="reference internal" href="#manually-updating-with-yum-or-apt">Manually Updating with Yum or APT</a></li>
<li><a class="reference internal" href="#automatic-updates">Automatic Updates</a><ul>
<li><a class="reference internal" href="#managing-automatic-updates-from-the-command-line">Managing Automatic Updates from the Command-Line</a></li>
<li><a class="reference internal" href="#managing-automatic-updates-from-the-toolkit-web-interface">Managing Automatic Updates from the Toolkit Web Interface</a></li>
<li><a class="reference internal" href="#disabling-automatic-updates-for-perfsonar-packages">Disabling Automatic Updates for perfSONAR Packages</a></li>
</ul>
</li>
<li><a class="reference internal" href="#special-upgrade-notes">Special Upgrade Notes</a><ul>
<li><a class="reference internal" href="#upgrading-to-perfsonar-5-x">Upgrading to perfSONAR 5.X</a><ul>
<li><a class="reference internal" href="#archive-changes">Archive changes</a></li>
<li><a class="reference internal" href="#iso-image-no-longer-avaiable">ISO Image No Longer Avaiable</a></li>
<li><a class="reference internal" href="#esmond-api-compatibility">Esmond API Compatibility</a></li>
<li><a class="reference internal" href="#pscheduler-limits-changes">pScheduler Limits changes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

                <ul>
                  <li>
                  <a href="install_ansible.html">Previous topic</a>
                  <ul><li><a href="install_ansible.html" title="previous chapter">Using perfSONAR with Ansible</a></li></ul>
                  </li>
                </ul>
                  <ul>
                      <li>
                      <a href="cookbook_central_archive.html">Next topic</a>
                      <ul><li><a href="cookbook_central_archive.html" title="next chapter">Central Archive with Grafana Cookbook</a></li></ul>
                      </li>
                  </ul>
                
                
            </nav>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="cookbook_central_archive.html" title="Central Archive with Grafana Cookbook"
             >next</a> |</li>
        <li class="right" >
          <a href="install_ansible.html" title="Using perfSONAR with Ansible"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">perfSONAR Toolkit 5.1.3 documentation</a> &#187;</li> 
      </ul>
    </div>
    <footer id="fat">
        <div class="footerContents">
            <nav id="fatFooterNav" class="fatFooterNav">
                <ul id="menu-partners" class="menu depth-0">
                    <li id="footer-partner-text" class="partner-menu">
                        perfSONAR 
                        <br>
                        partners 
                        <br>
                        include: 
                    </li>
    
                <li id="footer-partner-esnet" class="partner-menu">
                    <a href="http://www.es.net/" title="Visit DOE's Energy Sciences Network"><img src="_static/ESnet-ps.png" alt="" style="border:none;"></a> </li>
                
                <li id="footer-partner-geant" class="partner-menu">
                    <a href="http://www.geant.org/" title="Visit GEANT"><img src="_static/geant-ps.png" alt="" style="border:none;"/></a> </li>
        
                <li id="footer-partner-iu" class="partner-menu">
                    <a href="http://www.iu.edu/" title="Visit Indiana University"><img src="_static/IU-ps.png" alt="" style="border:none;"></a> </li>

                <li id="footer-partner-i2" class="partner-menu">
                    <a href="http://www.internet2.edu/" title="Visit Internet2"><img src="_static/I2-ps.png" alt="" style="border:none;"></a> </li>
					
				<li id="footer-partner-rnp" class="partner-menu">
                    <a href="https://www.rnp.br/en" title="Visit RNP"><img src="_static/rnp.png" alt="" style="border:none;"></a> </li>
                
                <li id="footer-partner-um" class="partner-menu">
                    <a href="http://www.umich.edu/" title="Visit University of Michigan"><img src="_static/UM-ps.png" alt="" style="border:none;"></a> </li>

                </ul>

            </nav>
            <nav id="minFooterNav" class="minFooterNav">
                <span class="copyright">PERFormance Service Oriented Network monitoring ARchitecture </span>
            </nav>
          
        </div> <!-- /footerContents -->
    </footer>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2024, perfSONAR Project.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.4.
    </div>
  </body>
</html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Operational Guide &mdash; perfSONAR Toolkit 4.0rc2 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/perfsonar.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '4.0rc2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="perfSONAR Toolkit 4.0rc2 documentation" href="index.html" />
    <link rel="up" title="MeshConfig Administrative GUI" href="mca.html" />
    <link rel="next" title="Deploying a Central Measurement Archive" href="multi_ma_install.html" />
    <link rel="prev" title="Hosts" href="mca_userguide_host.html" /> 
  </head>
  <body>
    <header>
        <div class="headerContents">
          <a href="index.html" border="0"><img src="_static/perfSONAR-header.gif"></a>
          <div class="acctSearchContainer">
              <section id="searchBox" class="searchBox">
                  <!--Use of this code assumes agreement with the Google Custom Search Terms of Service. -->
                  <!--The terms of service are available at http://www.google.com/cse/docs/tos.html -->
                  <form action="search.html" id="cse-search-box" method="get">
                    <input type="text" name="q" size="25" class="searchInput" placeholder="Search"/>
                    <input type="hidden" name="check_keywords" value="yes" />
                    <input type="hidden" name="area" value="default" />
                  </form>
              </section>
         </div>
        </div>
    </header>
    <div style="display:block;clear:both;">
    
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="multi_ma_install.html" title="Deploying a Central Measurement Archive"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mca_userguide_host.html" title="Hosts"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">perfSONAR Toolkit 4.0rc2 documentation</a> &raquo;</li>
          <li><a href="mca.html" accesskey="U">MeshConfig Administrative GUI</a> &raquo;</li> 
      </ul>
    </div>
    </div>
    
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="operational-guide">
<h1>Operational Guide<a class="headerlink" href="#operational-guide" title="Permalink to this headline">¶</a></h1>
<div class="section" id="service-status">
<h2>Service Status<a class="headerlink" href="#service-status" title="Permalink to this headline">¶</a></h2>
<p>MCA uses pm2 to monitor various MCA realted services and load-balance incoming requests. You can see a list of services by ..</p>
<div class="highlight-python"><div class="highlight"><pre>root@8f480cb15257 /]# su - mca
[mca@8f480cb15257 ~]$ pm2 list
┌──────────┬────┬──────┬─────┬────────┬─────────┬────────┬──────────────┬──────────┐
│ App name │ id │ mode │ pid │ status │ restart │ uptime │ memory       │ watching │
├──────────┼────┼──────┼─────┼────────┼─────────┼────────┼──────────────┼──────────┤
│ profile  │ 0  │ fork │ 234 │ online │ 0       │ 18h    │ 70.754 MB    │  enabled │
│ auth     │ 1  │ fork │ 238 │ online │ 0       │ 18h    │ 79.684 MB    │  enabled │
│ mcadmin  │ 2  │ fork │ 242 │ online │ 0       │ 18h    │ 86.453 MB    │  enabled │
│ mccache  │ 3  │ fork │ 244 │ online │ 0       │ 18h    │ 114.012 MB   │  enabled │
│ mcpub    │ 4  │ fork │ 248 │ online │ 0       │ 18h    │ 75.031 MB    │  enabled │
└──────────┴────┴──────┴─────┴────────┴─────────┴────────┴──────────────┴──────────┘
 Use `pm2 show &lt;id|name&gt;` to get more details about an app
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Docker container runs all services under root, so you don&#8217;t need to do &#8220;su - mca&#8221; before running pm2 commands</p>
</div>
<p>profile and auth services provide MCA authentication and profile settings service. mcadmin is the main MCA UI (server side component), and mcpub generates MeshConfing to be downloaded by external services. You can safely shutdown / restart mcadmin without impacting mcpub service. mccache periodically loads host information from configured sLS and global LS instances.</p>
<p>You should see all service to show &#8220;online&#8221; with small number of restart (if you update configuration for any service, the service will be automatically restarted, so you will see non-0 restart in such case). You can reset restart count by</p>
<div class="highlight-python"><div class="highlight"><pre>pm2 reset mcadmin
</pre></div>
</div>
<p>or</p>
<div class="highlight-python"><div class="highlight"><pre>pm2 reset all
</pre></div>
</div>
<p>You can monitor realtime stats of each services via</p>
<div class="highlight-python"><div class="highlight"><pre>pm2 monit
</pre></div>
</div>
<p>For more information on pm2, please see <a class="reference external" href="http://pm2.keymetrics.io/">PM2</a></p>
</div>
<div class="section" id="log-files">
<h2>Log files<a class="headerlink" href="#log-files" title="Permalink to this headline">¶</a></h2>
<p>/var/log/sca</p>
<div class="highlight-python"><div class="highlight"><pre>[root@8f480cb15257 mca]# ls -lrt
total 18308
-rw-rw-r-- 1 mca mca       77 Jan 22 02:11 profile.err
-rw-rw-r-- 1 mca mca     1303 Jan 22 02:11 pub.err
-rw-rw-r-- 1 mca mca     1976 Jan 22 02:14 pub-4.log
-rw-rw-r-- 1 mca mca      112 Jan 22 02:30 auth.err
-rw-rw-r-- 1 mca mca    13065 Jan 22 02:30 auth-1.log
-rw-rw-r-- 1 mca mca     4079 Jan 22 02:31 admin.err
-rw-rw-r-- 1 mca mca    71736 Jan 22 02:31 admin-2.log
-rw-rw-r-- 1 mca mca    32915 Jan 22 02:31 profile-0.log
-rw-rw-r-- 1 mca mca   198110 Jan 22 20:14 cache-3.log
-rw-rw-r-- 1 mca mca 18390157 Jan 22 20:37 cache.err
</pre></div>
</div>
</div>
<div class="section" id="backup-volatile-data">
<h2>Backup (Volatile Data)<a class="headerlink" href="#backup-volatile-data" title="Permalink to this headline">¶</a></h2>
<p>MCA stores MeshConfig related information in postgreSQL. For RHEL7, postgreSQL data directory can be found in</p>
<div class="highlight-python"><div class="highlight"><pre>/var/lib/pgsql/data
</pre></div>
</div>
<p>For RHEL6,</p>
<div class="highlight-python"><div class="highlight"><pre>/opt/rh/postgresql92/root/var/lib/pgsql/data
</pre></div>
</div>
<p>SCA auth service stores authentication information in a sqlite3 DB at (by default)</p>
<div class="highlight-python"><div class="highlight"><pre>/var/lib/mca/auth.sqlite
</pre></div>
</div>
<p>SCA profile service stores profile information in a sqlite3 DB at (by default)</p>
<div class="highlight-python"><div class="highlight"><pre>/var/lib/mca/profile.sqlite
</pre></div>
</div>
<p>Following configuration directory should be backed-up</p>
<div class="highlight-python"><div class="highlight"><pre>/opt/mca/mca/api/config
/opt/mca/auth/api/config
/opt/mca/profile/api/config
</pre></div>
</div>
<p>And UI has its own set of configuration files. These should be backed-up if you have modified from the RPM installed content</p>
<div class="highlight-python"><div class="highlight"><pre>/opt/mca/mca/ui/config.js
/opt/mca/auth/ui/config.js
/opt/mca/profile/ui/config.js
/opt/mca/shared/ui/config.js
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <nav id="channelNav" class="channelNav">
                
                <ul>
<li><a class="reference internal" href="#">Operational Guide</a><ul>
<li><a class="reference internal" href="#service-status">Service Status</a></li>
<li><a class="reference internal" href="#log-files">Log files</a></li>
<li><a class="reference internal" href="#backup-volatile-data">Backup (Volatile Data)</a></li>
</ul>
</li>
</ul>

                <ul>
                  <li>
                  <a href="mca_userguide_host.html">Previous topic</a>
                  <ul><li><a href="mca_userguide_host.html" title="previous chapter">Hosts</a></li></ul>
                  </li>
                </ul>
                  <ul>
                      <li>
                      <a href="multi_ma_install.html">Next topic</a>
                      <ul><li><a href="multi_ma_install.html" title="next chapter">Deploying a Central Measurement Archive</a></li></ul>
                      </li>
                  </ul>
                
                
            </nav>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="multi_ma_install.html" title="Deploying a Central Measurement Archive"
             >next</a> |</li>
        <li class="right" >
          <a href="mca_userguide_host.html" title="Hosts"
             >previous</a> |</li>
        <li><a href="index.html">perfSONAR Toolkit 4.0rc2 documentation</a> &raquo;</li>
          <li><a href="mca.html" >MeshConfig Administrative GUI</a> &raquo;</li> 
      </ul>
    </div>
    <footer id="fat">
        <div class="footerContents">
            <nav id="fatFooterNav" class="fatFooterNav">
                <ul id="menu-partners" class="menu depth-0">
                    <li id="footer-partner-text" class="partner-menu">
                        perfSONAR 
                        <br>
                        partners 
                        <br>
                        include: 
                    </li>
    
                <li id="footer-partner-esnet" class="partner-menu">
                    <a href="http://www.es.net/" title="Visit DOE's Energy Sciences Network"><img src="_static/ESnet-ps.png" alt="" style="border:none;"></a> </li>
                
                <li id="footer-partner-geant" class="partner-menu">
                    <a href="http://www.geant.org/" title="Visit GEANT"><img src="_static/geant-ps.png" alt="" style="border:none;"/></a> </li>
        
                <li id="footer-partner-iu" class="partner-menu">
                    <a href="http://www.iu.edu/" title="Visit Indiana University"><img src="_static/IU-ps.png" alt="" style="border:none;"></a> </li>

                <li id="footer-partner-i2" class="partner-menu">
                    <a href="http://www.internet2.edu/" title="Visit Internet2"><img src="_static/I2-ps.png" alt="" style="border:none;"></a> </li>
    
                </ul>

             
            </nav>
            <nav id="minFooterNav" class="minFooterNav">
                <span class="copyright">PERFormance Service Oriented Network monitoring ARchitecture </span>
            </nav>
          
        </div> <!-- /footerContents -->
    </footer>
    
    <div class="footer">
        &copy; Copyright 2016, perfSONAR Project.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Configuring pScheduler Limits &mdash; perfSONAR Toolkit 5.0.0b1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/perfsonar.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '5.0.0b1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="perfSONAR Toolkit 5.0.0b1 documentation" href="index.html" />
    <link rel="next" title="OWAMP Server Configuration File" href="config_owamp.html" />
    <link rel="prev" title="Configuring pScheduler" href="config_pscheduler.html" /> 
  </head>
  <body>
    <header>
        <div class="headerContents">
          <a href="index.html" border="0"><img src="_static/perfSONAR-header.gif"></a>
          <div class="acctSearchContainer">
              <section id="searchBox" class="searchBox">
                  <!--Use of this code assumes agreement with the Google Custom Search Terms of Service. -->
                  <!--The terms of service are available at http://www.google.com/cse/docs/tos.html -->
                  <form action="search.html" id="cse-search-box" method="get">
                    <input type="text" name="q" size="25" class="searchInput" placeholder="Search"/>
                    <input type="hidden" name="check_keywords" value="yes" />
                    <input type="hidden" name="area" value="default" />
                  </form>
              </section>
         </div>
        </div>
    </header>
    <div style="display:block;clear:both;">
    
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="config_owamp.html" title="OWAMP Server Configuration File"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="config_pscheduler.html" title="Configuring pScheduler"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">perfSONAR Toolkit 5.0.0b1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    </div>
    
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="configuring-pscheduler-limits">
<h1>Configuring pScheduler Limits<a class="headerlink" href="#configuring-pscheduler-limits" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>pScheduler offers the ability to control what tasks may be run, by
whom and with what parameters.  This is achieved by writing and
installing a <em>limit configuration file</em>.</p>
<p>A number of commented samples may be found in
<tt class="docutils literal"><span class="pre">/usr/share/doc/pscheduler/limit-examples</span></tt> on systems with the
pScheduler bundle installed.  The limit configuration that ships with
the perfSONAR toolkit may be found <a class="reference external" href="https://github.com/perfsonar/toolkit/blob/master/etc/default_service_configs/pscheduler_limits.conf">in the toolkit sources</a>.</p>
</div>
<div class="section" id="the-limit-configuration-file">
<h2>The Limit Configuration File<a class="headerlink" href="#the-limit-configuration-file" title="Permalink to this headline">¶</a></h2>
<div class="section" id="installing-a-limit-configuration">
<h3>Installing a Limit Configuration<a class="headerlink" href="#installing-a-limit-configuration" title="Permalink to this headline">¶</a></h3>
<p>The limit configuration is installed in <tt class="docutils literal"><span class="pre">/etc/pscheduler/limits.conf</span></tt> and must be readable by the <tt class="docutils literal"><span class="pre">pscheduler</span></tt> user.  The recommended file attributes are owner <tt class="docutils literal"><span class="pre">root</span></tt>, group <tt class="docutils literal"><span class="pre">pscheduler</span></tt> and permissions <cite>0644</cite>.</p>
<p>pScheduler server automatically detect changes to the limit configuration and put them into effect upon the arrival of the first request that requires checking limits or 15 seconds, whichever is longer.  Changes to the limit file are noted in the pScheduler log (usually <tt class="docutils literal"><span class="pre">/var/log/pscheduler/pscheduler.log</span></tt>), as are notifications of problems.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If the configuration file does not exist, is removed or fails to load, pScheduler will enforce no limits and grant every task request it receives.  For this reason, it is strongly recommended that configurations be verified as described in <a class="reference internal" href="#config-pscheduler-limits-check-validity"><em>Checking Limit Configuration Files for Validity</em></a> before they are installed.</p>
</div>
</div>
<div class="section" id="content">
<h3>Content<a class="headerlink" href="#content" title="Permalink to this headline">¶</a></h3>
<p>The contents of the limit file can be either a URL with a scheme
(e.g., <tt class="docutils literal"><span class="pre">https://...</span></tt>) or <a class="reference external" href="http://www.json.org">JavaScript Object Notation</a> (JSON).</p>
<p>If the file contains a URL, the content at that location will be
fetched and its contents will be parsed as shown below.</p>
<p>Whether read directly or fetched, the limit file contains a single
JSON object with the pairs shown here:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;#&quot;</span><span class="p">:</span> <span class="s">&quot;Skeletal pScheduler limit configuration&quot;</span><span class="p">,</span>

    <span class="s">&quot;identifiers&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="o">...</span> <span class="p">],</span>
    <span class="s">&quot;classifications&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="o">...</span> <span class="p">],</span>
    <span class="s">&quot;rewrite&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="o">...</span> <span class="p">],</span>
    <span class="s">&quot;limits&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="o">...</span> <span class="p">],</span>
    <span class="s">&quot;applications&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="o">...</span> <span class="p">],</span>
    <span class="s">&quot;priority&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="o">...</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Each pair is described in the sections below.</p>
</div>
<div class="section" id="comments">
<h3>Comments<a class="headerlink" href="#comments" title="Permalink to this headline">¶</a></h3>
<p>All JSON read by pScheduler supports in-line commenting by ignoring
any pair whose key begins with a pound sign (<tt class="docutils literal"><span class="pre">#</span></tt>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;#&quot;</span><span class="p">:</span> <span class="s">&quot;This is a comment.&quot;</span><span class="p">,</span>
    <span class="s">&quot;#This&quot;</span><span class="p">:</span> <span class="s">&quot;is also a comment.&quot;</span><span class="p">,</span>
    <span class="s">&quot;This&quot;</span><span class="p">:</span> <span class="s">&quot;#is not a comment.&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that this behavior is not part of ECMA 404, the JSON standard.</p>
</div>
</div>
<div class="section" id="identifiers-who-s-asking">
<h2>Identifiers:  <em>Who&#8217;s Asking?</em><a class="headerlink" href="#identifiers-who-s-asking" title="Permalink to this headline">¶</a></h2>
<p>The first phase of vetting a task or run is <em>identification</em>, where
attributes of the arriving request are used to create a list of narrow
categories into which the requester fits.  Note that _requester_ means
the system making the request, identified by its IP address, and can
be either the system that submitted the task to pScheduler or one
pScheduler node setting up the task with another.</p>
<p>The <tt class="docutils literal"><span class="pre">identifiers</span></tt> section of the limit configuration contains an
array of <em>identifier objects</em>, each containing the following pairs:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">name</span></tt> - A string which gives the identifier a name which must be
unique among all identifiers.</li>
<li><tt class="docutils literal"><span class="pre">description</span></tt> - A human-readable string describing the identifier.</li>
<li><tt class="docutils literal"><span class="pre">type</span></tt> - A string indicating what the method to be used in
determining whether or not the requester should be identified in
this category.  (See <em>Identifier Types</em>.)</li>
<li><tt class="docutils literal"><span class="pre">data</span></tt> - A JSON object containing <tt class="docutils literal"><span class="pre">type</span></tt>-specific data used in
determining whether the requester should be identified in this
category.  (See <em>Identifier Types</em>.)</li>
<li><tt class="docutils literal"><span class="pre">invert</span></tt> - An optional boolean value indicating whether or not
the identification should be inverted after evaluation (i.e.,
<tt class="docutils literal"><span class="pre">true</span></tt> would make a requester identify in this category when it
otherwise would not have done so and <tt class="docutils literal"><span class="pre">false</span></tt> would do the
opposite).</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><pre>{
    "identifiers": [
        {
            "name": "partners-bio",
            "description": "Research Partners in biology",
            "type": "ip-cidr-list",
            "data": {
                "cidrs": [ "192.0.2.0/24", "198.51.100.0/24" ]
            },
            "invert": false
        },
        {
            "name": "local",
            "description": "Requesters on the local system",
            "type": "localif",
            "data": { }
        },
        {
            "name": "everyone",
            "description": "All requesters",
            "type": "always",
            "data": { }
        },
    ],
    ...
}</pre>
</div>
<div class="section" id="identifier-types">
<h3>Identifier Types<a class="headerlink" href="#identifier-types" title="Permalink to this headline">¶</a></h3>
<div class="section" id="always-identify-everyone">
<h4><tt class="docutils literal"><span class="pre">always</span></tt> - Identify Everyone<a class="headerlink" href="#always-identify-everyone" title="Permalink to this headline">¶</a></h4>
<p>The <tt class="docutils literal"><span class="pre">always</span></tt> identifier unconditionally identifies every requester,
useful in catch-alls.</p>
<p>Its <tt class="docutils literal"><span class="pre">data</span></tt> is an empty object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>There are exactly two useful configurations of this identifier:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;everybody&quot;</span><span class="p">,</span>
    <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;An identifier that identifies every requester&quot;</span><span class="p">,</span>
    <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;always&quot;</span><span class="p">,</span>
    <span class="s">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="p">}</span>
<span class="p">}</span>

<span class="p">{</span>
    <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;nobody&quot;</span><span class="p">,</span>
    <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;An identifier that identifies no requesters&quot;</span><span class="p">,</span>
    <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;always&quot;</span><span class="p">,</span>
    <span class="s">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="p">},</span>
    <span class="s">&quot;invert&quot;</span><span class="p">:</span> <span class="n">true</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="hint-identify-using-server-provided-hints">
<h4><tt class="docutils literal"><span class="pre">hint</span></tt> - Identify Using Server-Provided Hints<a class="headerlink" href="#hint-identify-using-server-provided-hints" title="Permalink to this headline">¶</a></h4>
<p>The <tt class="docutils literal"><span class="pre">hint</span></tt> identifier matches information about the requester to
make identifications.</p>
<p>Its <tt class="docutils literal"><span class="pre">data</span></tt> is an object containing the following pairs:</p>
<ul>
<li><dl class="first docutils">
<dt><tt class="docutils literal"><span class="pre">hint</span></tt> - The name of the hint to be checked.  Valid hints are</dt>
<dd><p class="first last"><tt class="docutils literal"><span class="pre">requester</span></tt>, a string containing the IP address of the host
making the request, and <tt class="docutils literal"><span class="pre">server</span></tt>, a string containing the IP
address of the interface on the local system where the request
arrived.</p>
</dd>
</dl>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">match</span></tt> - A <tt class="docutils literal"><span class="pre">StringMatch</span></tt> object.  (See <em>Standard Objects</em>.)</p>
</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;internal&quot;</span><span class="p">,</span>
    <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;Requests arriving on our internal-facing interface&quot;</span><span class="p">,</span>
    <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;hint&quot;</span><span class="p">,</span>
    <span class="s">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;hint&quot;</span><span class="p">:</span> <span class="s">&quot;server&quot;</span><span class="p">,</span>
        <span class="s">&quot;match&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&quot;style&quot;</span><span class="p">:</span> <span class="s">&quot;exact&quot;</span><span class="p">,</span>
            <span class="s">&quot;match&quot;</span><span class="p">:</span> <span class="s">&quot;198.51.100.23&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="ip-cidr-list-identify-by-requesting-ip-address">
<h4><tt class="docutils literal"><span class="pre">ip-cidr-list</span></tt> - Identify By Requesting IP Address<a class="headerlink" href="#ip-cidr-list-identify-by-requesting-ip-address" title="Permalink to this headline">¶</a></h4>
<p>The <tt class="docutils literal"><span class="pre">ip-cidr-list</span></tt> identifier determines whether or not the IP
address of the host making a request falls into any of a list of
<cite>Classless Inter-Domain Routing
&lt;https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing&gt;`_</cite>
(CIDR) blocks.</p>
<p>Its <tt class="docutils literal"><span class="pre">data</span></tt> is an object containing the following pairs:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">cidrs</span></tt> - A list of IPv4 or IPv6 CIDR blocks.</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;partners&quot;</span><span class="p">,</span>
    <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;Networks used by research partners&quot;</span><span class="p">,</span>
    <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;ip-cidr-list&quot;</span><span class="p">,</span>
    <span class="s">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;cidrs&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s">&quot;203.0.113.62&quot;</span><span class="p">,</span>
            <span class="s">&quot;192.168.19.0/24&quot;</span><span class="p">,</span>
            <span class="s">&quot;192.168.84.0/24&quot;</span><span class="p">,</span>
            <span class="s">&quot;2001:db8::1234&quot;</span><span class="p">,</span>
            <span class="s">&quot;fc00:1bad:cafe::/48&quot;</span><span class="p">,</span>
            <span class="s">&quot;fc00:dead:beef::/48&quot;</span>
            <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="ip-cidr-list-url-identify-by-requesting-ip-address-with-downloaded-list">
<h4><tt class="docutils literal"><span class="pre">ip-cidr-list-url</span></tt> - Identify By Requesting IP Address with Downloaded List<a class="headerlink" href="#ip-cidr-list-url-identify-by-requesting-ip-address-with-downloaded-list" title="Permalink to this headline">¶</a></h4>
<p>The <tt class="docutils literal"><span class="pre">ip-cidr-list-url</span></tt> identifier serves the same purpose as
<tt class="docutils literal"><span class="pre">ip-cidr-list</span></tt> but downloads the list of CIDRs from a URL and
periodically updates it.</p>
<p>Its <tt class="docutils literal"><span class="pre">data</span></tt> is an object containing the following pairs:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">source</span></tt> - A string containing a URL from which the list should
be downloaded.  The format of the downloaded data is a plain text
list of individual IPs or CIDRs separated by newlines.  Empty lines
or those beginning with a pound sign (<tt class="docutils literal"><span class="pre">#</span></tt>) are treated as
comments and ignored.</li>
<li><tt class="docutils literal"><span class="pre">update</span></tt> - An ISO 8601 duration indicating how often the limit
processor should attempt to retrieve a new copy of the list from
the <tt class="docutils literal"><span class="pre">source</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">retry</span></tt> - An ISO 8601 duration indicating how often the limit
processor should attempt to retrieve a new copy of the list should
the initial download or an update result in a failure.</li>
<li><tt class="docutils literal"><span class="pre">fail-state</span></tt> - A boolean value indicating whether or not the
identifer should identify all requesters when the CIDR list is not
been successfully retrieved.</li>
</ul>
<p>Note that this identifier will continue to use the list it last
successfully downloaded until an update can be successfully retrieved.</p>
<p><strong>Examples</strong></p>
<p>This identifier downloads ESNet&#8217;s list of CIDRs for research and
education networks, updates it daily with four-hour retries on failure
and excludes the private networks defined by RFC 1918:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;r-and-e&quot;</span><span class="p">,</span>
    <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;Requests from research and education networks&quot;</span><span class="p">,</span>
    <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;ip-cidr-list-url&quot;</span><span class="p">,</span>
    <span class="s">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;source&quot;</span><span class="p">:</span> <span class="s">&quot;http://stats.es.net/sample_configs/pscheduler/ren&quot;</span><span class="p">,</span>
        <span class="s">&quot;update&quot;</span><span class="p">:</span> <span class="s">&quot;P1D&quot;</span><span class="p">,</span>
        <span class="s">&quot;retry&quot;</span><span class="p">:</span> <span class="s">&quot;PT4H&quot;</span><span class="p">,</span>
        <span class="s">&quot;exclude&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s">&quot;10.0.0.0/8&quot;</span><span class="p">,</span>
            <span class="s">&quot;172.16.0.0/12&quot;</span><span class="p">,</span>
            <span class="s">&quot;192.168.0.0/16&quot;</span>
        <span class="p">],</span>
        <span class="s">&quot;fail-state&quot;</span><span class="p">:</span> <span class="n">false</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This identifier downloads the <a class="reference external" href="https://docs.aws.amazon.com/general/latest/gr/aws-ip-ranges.html">Amazon Web Services CIDR block list</a> and uses jq to translate it into the expected format:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;aws&quot;</span><span class="p">,</span>
    <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;Requests from Amazon Web Services hosts&quot;</span><span class="p">,</span>
    <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;ip-cidr-list-url&quot;</span><span class="p">,</span>
    <span class="s">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;source&quot;</span><span class="p">:</span> <span class="s">&quot;https://ip-ranges.amazonaws.com/ip-ranges.json&quot;</span><span class="p">,</span>
        <span class="s">&quot;transform&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&quot;script&quot;</span><span class="p">:</span> <span class="s">&quot;.prefixes[].ip_prefix, .ipv6_prefixes[].ipv6_prefix&quot;</span><span class="p">,</span>
            <span class="s">&quot;output-raw&quot;</span><span class="p">:</span> <span class="n">true</span>
        <span class="p">},</span>
        <span class="s">&quot;update&quot;</span><span class="p">:</span> <span class="s">&quot;P1D&quot;</span><span class="p">,</span>
        <span class="s">&quot;retry&quot;</span><span class="p">:</span> <span class="s">&quot;PT4H&quot;</span><span class="p">,</span>
        <span class="s">&quot;fail-state&quot;</span><span class="p">:</span> <span class="n">false</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="ip-cymru-bogon-identify-bogon-addresses">
<h4><tt class="docutils literal"><span class="pre">ip-cymru-bogon</span></tt> - Identify Bogon Addresses<a class="headerlink" href="#ip-cymru-bogon-identify-bogon-addresses" title="Permalink to this headline">¶</a></h4>
<p>The <tt class="docutils literal"><span class="pre">ip-cymru-bogon</span></tt> identifier determines whether or not the
requester&#8217;s address is in Team Cymru&#8217;s <a class="reference external" href="http://www.team-cymru.org/bogon-reference.html">Bogon Refernce List</a>.</p>
<p>Its <tt class="docutils literal"><span class="pre">data</span></tt> is an object containing the following pairs:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">exclude</span></tt> - A list of IP addresses and CIDR blocks that should
not be treated as bogons even if they are on Team Cymru&#8217;s list.</li>
<li><tt class="docutils literal"><span class="pre">timeout</span></tt> - An ISO 8601 duration indicating how long the
identifier should try to get an answer before giving up.</li>
<li><tt class="docutils literal"><span class="pre">fail-result</span></tt> - A boolean value indicating whether or not the
identifer should identify all requesters as bogons when a
definitive answer cannot be found.</li>
</ul>
<p>Note that this identifier uses the <a class="reference external" href="http://www.team-cymru.org/bogon-reference-dns.html">Domain Name Service</a> to check
whether or not an address is in the list, and therefore its use
requires that the host be able to resolve hosts on the public
Internet.  This system works with caching DNS servers, so direct
access to the internet is not required.</p>
<p>For example, this identifier checks incoming request addresses,
excludes three of the RFC1918 blocks, gives up after one second and
does not identify the requester as a bogon if a definitive answer
cannot be found:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;bogons&quot;</span><span class="p">,</span>
    <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;Requests arriving from bogon/martian addresses&quot;</span><span class="p">,</span>
    <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;ip-cymru-bogon&quot;</span><span class="p">,</span>
    <span class="s">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;exclude&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s">&quot;10.10.0.0/16&quot;</span><span class="p">,</span>
            <span class="s">&quot;192.168.86.0/24&quot;</span><span class="p">,</span>
            <span class="s">&quot;192.168.99.0/24&quot;</span>
        <span class="p">],</span>
        <span class="s">&quot;timeout&quot;</span><span class="p">:</span> <span class="s">&quot;PT1S&quot;</span><span class="p">,</span>
        <span class="s">&quot;fail-result&quot;</span><span class="p">:</span> <span class="n">false</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="ip-cymru-asn-identify-requesters-by-asn">
<h4><tt class="docutils literal"><span class="pre">ip-cymru-asn</span></tt> - Identify Requesters by ASN<a class="headerlink" href="#ip-cymru-asn-identify-requesters-by-asn" title="Permalink to this headline">¶</a></h4>
<p>The <tt class="docutils literal"><span class="pre">ip-cymru-asn</span></tt> identifier uses <a class="reference external" href="https://team-cymru.com/community-services/ip-asn-mapping/#dns">Team Cymru&#8217;s IP to ASN service</a> to
determine whether or not the requester&#8217;s address is part of an
autonomous system number (ASN) or is peered with one in a provided
list.</p>
<p>Its <tt class="docutils literal"><span class="pre">data</span></tt> is an object containing the following pairs:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">asns</span></tt> - A list containing the ASNs to be checked, each as an
integer.</li>
<li><tt class="docutils literal"><span class="pre">peers</span></tt> - A boolean indicating whether the list of peers for the
IP&#8217;s AS should be checked.  Note that the nature of routing makes
this is an inexact science, so this option should be used with care.</li>
<li><tt class="docutils literal"><span class="pre">timeout</span></tt> - An ISO 8601 duration indicating how long the
identifier should try to get an answer before giving up.</li>
<li><tt class="docutils literal"><span class="pre">fail-result</span></tt> - A boolean value indicating whether or not the
identifer should identify all requesters as bogons when a
definitive answer cannot be found.</li>
</ul>
<p>Note that this identifier uses the <a class="reference external" href="http://www.team-cymru.org/asn-reference-dns.html">Domain Name Service</a> to check
whether or not an address is in the list, and therefore its use
requires that the host be able to resolve hosts on the public
Internet.  This system works with caching DNS servers, so direct
access to the internet is not required.</p>
<p>For example, this identifier checks that the requester&#8217;s address is
within ANs 123, 456 or 789:</p>
<div class="highlight-python"><pre>{
    "name": "friendly-asns",
    "description": "ASNs we like"
    "type": "ip-cymru-asn",
    "data": {
        "asns": [ 123, 456, 789 ],
        "timeout": "PT3S",
        "fail-result": false
    }
}</pre>
</div>
</div>
<div class="section" id="ip-reverse-dns-identify-requesters-by-host-name">
<h4><tt class="docutils literal"><span class="pre">ip-reverse-dns</span></tt> - Identify Requesters By Host Name<a class="headerlink" href="#ip-reverse-dns-identify-requesters-by-host-name" title="Permalink to this headline">¶</a></h4>
<p>The <tt class="docutils literal"><span class="pre">ip-reverse-dns</span></tt> identifier attempts to reverse-resolve the
requester&#8217;s IP address to a fully-qualified domain name and matches
it against a pattern.</p>
<p>Its <tt class="docutils literal"><span class="pre">data</span></tt> is an object containing the following pairs:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">match</span></tt> - A <tt class="docutils literal"><span class="pre">StringMatch</span></tt> object.  (See <em>Standard Objects</em>.)</li>
<li><tt class="docutils literal"><span class="pre">timeout</span></tt> - An ISO 8601 duration indicating how long the
identifier should try to get an answer before giving up.</li>
</ul>
<p>As a security measure, the fully-qualified domain name found during
reverse resolution will be forward-resolved to an IP which must match
that of the requester.</p>
<p>For example, this identifier determines whether or not the incoming
requester&#8217;s fully-qualified domain name falls within <tt class="docutils literal"><span class="pre">example.org</span></tt>,
giving up after two seconds:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;example-dot-org&quot;</span><span class="p">,</span>
    <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;Requests arriving from example.org IPs&quot;</span><span class="p">,</span>
    <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;ip-reverse-dns&quot;</span><span class="p">,</span>
    <span class="s">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;match&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&quot;style&quot;</span><span class="p">:</span> <span class="s">&quot;regex&quot;</span><span class="p">,</span>
            <span class="s">&quot;match&quot;</span><span class="p">:</span> <span class="s">&quot;</span><span class="se">\\</span><span class="s">.example</span><span class="se">\\</span><span class="s">.org$&quot;</span>
        <span class="p">},</span>
        <span class="s">&quot;timeout&quot;</span><span class="p">:</span> <span class="s">&quot;PT2S&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="jq-use-a-jq-script-to-identify-requesters">
<h4><tt class="docutils literal"><span class="pre">jq</span></tt> - Use a jq Script to Identify Requesters<a class="headerlink" href="#jq-use-a-jq-script-to-identify-requesters" title="Permalink to this headline">¶</a></h4>
<p>The <tt class="docutils literal"><span class="pre">jq</span></tt> identifier allows decisions to be made based on hints about
the requester provided by the system using a <a class="reference external" href="https://stedolan.github.io/jq">jq</a>
script.</p>
<p>Input to the script is a JSON object containing pairs for each of the
hints that pScheduler provides.  For example:</p>
<div class="highlight-python"><pre>{
    "requester": "198.51.100.19",    IP making the request
    "server": "192.0.2.202"          IP on which the request arrived
}</pre>
</div>
<p>The script should return a single Boolean value, <tt class="docutils literal"><span class="pre">true</span></tt> to indicate
that an identification was made, <tt class="docutils literal"><span class="pre">false</span></tt> otherwise.  Return of any
other type will be treated the same as a value <tt class="docutils literal"><span class="pre">false</span></tt>.</p>
<p><strong>Examples</strong></p>
<p><strong>Note:  Both of these examples would be better carried out using the ``ip-cidr-list`` identifier</strong> but are also good examples of jq scripting in this context.</p>
<p>Check to see if the requesting IP is a single IP that should not be
allowed to use the system. (Note that the <tt class="docutils literal"><span class="pre">ip-cidr-list</span></tt> identifier
is a better choice for this example.)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;do-not-want&quot;</span><span class="p">,</span>
    <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;One IP we really, really dislike.&quot;</span><span class="p">,</span>
    <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;jq&quot;</span><span class="p">,</span>
    <span class="s">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;script&quot;</span><span class="p">:</span> <span class="s">&quot;.requester == </span><span class="se">\&quot;</span><span class="s">198.51.100.86</span><span class="se">\&quot;</span><span class="s">&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Identify requests not being made to an address that&#8217;s not considered
one of the management interfaces:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;non-management-if&quot;</span><span class="p">,</span>
    <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;Requests not arriving on a management interface(s)&quot;</span><span class="p">,</span>
    <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;jq&quot;</span><span class="p">,</span>
    <span class="s">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;script&quot;</span><span class="p">:</span> <span class="s">&quot;[.server == $management_ips[]] | any | not&quot;</span><span class="p">,</span>
        <span class="s">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&quot;management_ips&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="s">&quot;198.51.100.46&quot;</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="localif-identify-requesters-on-local-interfaces">
<h4><tt class="docutils literal"><span class="pre">localif</span></tt> - Identify Requesters On Local Interfaces<a class="headerlink" href="#localif-identify-requesters-on-local-interfaces" title="Permalink to this headline">¶</a></h4>
<p>The <tt class="docutils literal"><span class="pre">localif</span></tt> identifier determines whether or not the requester&#8217;s
IP address is bound to an interface on the local system.</p>
<p>Its <tt class="docutils literal"><span class="pre">data</span></tt> is an empty object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;local-requester&quot;</span><span class="p">,</span>
    <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;Requests arriving from local interfaces&quot;</span><span class="p">,</span>
    <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;localif&quot;</span><span class="p">,</span>
    <span class="s">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="classifiers-how-do-we-group-the-identifiers">
<h2>Classifiers:  <em>How Do We Group the Identifiers?</em><a class="headerlink" href="#classifiers-how-do-we-group-the-identifiers" title="Permalink to this headline">¶</a></h2>
<p>Once a list of identifiers is determined, the second phase is grouping
them into broader categories called <em>classifiers</em>.  Classifiers are
simple groups containing a list of one or more identifiers.</p>
<p>The <tt class="docutils literal"><span class="pre">classifiers</span></tt> section of the limit configuration contains an
array of <em>classifier objects</em>, each containing the following pairs:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">name</span></tt> - A string which gives the identifier a name which must be
unique among all classifiers.  To avoid confusion, it is
recommended, but not required, that classifier names and identifier
names do not overlap.</li>
<li><tt class="docutils literal"><span class="pre">description</span></tt> - A human-readable string describing the classifier.</li>
<li><tt class="docutils literal"><span class="pre">identifiers</span></tt> - An array of strings indicating what identifiers
should be part of the classifier.</li>
<li><tt class="docutils literal"><span class="pre">require</span></tt> - A string specifying how many of the listed identifiers
must be present for the requester to meet the requested
classification.  Valid values are <tt class="docutils literal"><span class="pre">none</span></tt>, <tt class="docutils literal"><span class="pre">one</span></tt>, <tt class="docutils literal"><span class="pre">any</span></tt> and
<tt class="docutils literal"><span class="pre">all</span></tt>.  If not provided, the default behavior will be <tt class="docutils literal"><span class="pre">any</span></tt>.
(Use of this parameter requires a <tt class="docutils literal"><span class="pre">schema</span></tt> of <tt class="docutils literal"><span class="pre">4</span></tt> or higher.)</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><pre>{
    ...
    "classifiers": [
        {
            "name": "friendlies",
            "description": "Requesters we like",
            "identifiers": [ "local", "partners", "r-and-e" ]
        },
        {
            "name": "hostiles",
            "description": "Requesters we don't want using the system",
            "identifiers": [ "bogons", "example-dot-org" ]
        },
        {
            "name": "neutrals",
            "description": "Requesters we neither like nor dislike",
            "identifiers": [ "everybody" ]
        },
        {
            "name": "r-and-e-partners",
            "description": "Partners from research and education"
            "identifiers": [ "partners", "r-and-e" ],
            "require": "all"
        },
    ...
}</pre>
</div>
<p>Note that the <tt class="docutils literal"><span class="pre">neutrals</span></tt> classification will include all requesters,
which makes it overlap with <tt class="docutils literal"><span class="pre">friendlies</span></tt> and <tt class="docutils literal"><span class="pre">hostiles</span></tt>.  As will
be illustrated later, the narrower classifications can be used to
allow or deny tasks before the wider ones.</p>
</div>
<div class="section" id="task-rewriting-what-should-be-changed">
<h2>Task Rewriting:  <em>What Should Be Changed?</em><a class="headerlink" href="#task-rewriting-what-should-be-changed" title="Permalink to this headline">¶</a></h2>
<p>Before applying limits to an incoming task, the pScheduler limit
system can apply a <a class="reference external" href="https://stedolan.github.io/jq">jq</a> script to the
task to make changes on the fly.</p>
<p>If a <cite>rewrite</cite> pair is present in a limit configuration where the
<cite>schema</cite> is <cite>2</cite> or later and the submission is on a system that is the
lead participant, it specifies a jq transform applied to the task
immediately after initial validation and prior to limit enforcement
and tool selection.  Note that because the rewriter provides a set of
functions that are inserted into the script, all <cite>import</cite> and
<cite>include</cite> statements are extracted and relocated in order to the top
to maintain correct jq syntax.</p>
<p>Input to the transform&#8217;s script is a JSON object containing the
contents of the task as it was submitted to the server.  The rewriter
adds a private pair for its own internal use (currently named
<cite>__REWRITER_PRIVATE__</cite>) which should not be examined or modified.</p>
<p>Changes to the task are made by modifying the JSON in place (e.g.,
<cite>.test.spec.bandwidth = 100000000</cite>) and must be followed by a call to
the <cite>change()</cite> function (described below) with a message that will be
meaningful to the end user (e.g., <cite>Limited bandwidth to 100 Mb/s</cite>).</p>
<p>Conditions that would require that the incoming task be rejected may
be dealt with by calling the <cite>reject()</cite> function (described below)
with a message that will be meaningful to the end user (e.g., <cite>Cannot
use tools whose names contain the letter T</cite>).  Tasks rejected in this
way will _not_ be screened by other limits that might have allowed it
to proceed, so use this feature carefully.  Also note that rewriting
takes place only on the node which is the lead participant, so other
nodes should not rely on this mechanism as a way of enforcing limits.</p>
<p>Should the script fail when it is run, the incoming task will be
rejected with a suitable diagnostic message.</p>
<p><strong>Rewriter Built-In Functions</strong></p>
<p>The following functions will be made available to rewriting scripts:</p>
<p><cite>change(message)</cite> - Signals that a change has been made to the task
and adds the string <cite>message</cite> to the set of diagnostics added to the
task&#8217;s details.  This function must be called at least once if the
script modifies the JSON in any way.  Any non-string value for
<cite>message</cite> will be passed through jq&#8217;s <cite>tostring</cite> function.  A value of
<cite>null</cite> will result in no message being appended to the diagnostics,
although this is strongly discouraged.</p>
<p><cite>classifiers</cite> - Returns an array of the classifiers into which the
node requesting the task were grouped (e.g., <cite>[ &#8220;friendlies&#8221;,
&#8220;partners&#8221; ]</cite>).</p>
<p><cite>classifiers_has(value)</cite> - Returns a boolean indicating whether or not
the string <cite>value</cite> is one of the classifiers.</p>
<p><cite>reject(message)</cite> - Signals that the task should be rejected for the
reason described by <cite>message</cite>.  Any non-string value for <cite>message</cite>
will be passed through jq&#8217;s <cite>tostring</cite> function.</p>
<p><strong>Examples</strong></p>
<p>Force certain tests to operate from a specific interface:</p>
<div class="highlight-python"><pre>{
    ...
    "rewrite": {
        "script": [
            "import \"pscheduler/iso8601\" as iso;",

            "# Recommended so the pipeline statements all begin with |.",
            ".",

            "# Hold this in a variable for use where it's not in-context",
            "| .task.type as $tasktype",

            "# Force latency onto a specific interface",
            "| if ( [\"latency\", \"latencybg\" ] | contains([$tasktype]) )",
            "  then",
            "    .task.spec.source = \"ps7-latency.example.org\"",
            "    | change(\"Forced use of interface reserved for latency\")",
            "  else",
            "    .",
            "  end",

            "# The end.  (This takes care of the no-comma-at-end problem)"
        ]
    },
    ...
}</pre>
</div>
<p>Throttle the <cite>bandwidth</cite> parameter of <cite>throughput</cite> tests for all but
certain groups to 50 Mb/s:</p>
<div class="highlight-python"><pre>{
    ...
    "rewrite": {
        "script": [
            ".",

            "# Throttle non-friendlies to 50 Mb/s for throughput",
            "| if .task.type == \"throughput\"",
            "    and (",
            "      (.task.spec.bandwidth == null)",
            "      or (.task.spec.bandwidth &gt; 50000000)",
            "    )",
            "    and (.classifiers | contains([\"friendlies\"]) | not)",
            "  then",
            "    .task.spec.bandwidth = 50000000",
            "    | change(\"Throttled bandwidth to 50 Mb/s\")",
            "  else",
            "    .",
            "  end",

            "# The end."
        ]
    },
    ...
}</pre>
</div>
<p>Force the minimum duration for certain tests that specify one to 5 seconds:</p>
<div class="highlight-python"><pre>{
    ...
    "rewrite": {
        "script": [
            "import \"pscheduler/iso8601\" as iso;",

            ".",

            "# Hold this in a variable for use where it's not in-context",
            "| .task.type as $tasktype",

            "# Make some tests run a minimum of 5 seconds",
            "| if ( [\"idle\", \"idlebgm\", \"idleex\", \"latency\", \"latencybg\", \"throughput\" ]",
            "       | contains([$tasktype]) )",
            "    and iso::duration_as_seconds(.task.spec.duration) &lt; 5",
            "  then",
            "    .task.spec.duration = \"PT5S\"",
            "    | change(\"Bumped duration to 5-second minimum\")",
            "  else",
            "    .",
            "  end",

            "# The end."
        ]
    },
    ...
}</pre>
</div>
<p>Force the repeat interval, if specified, to a minimum of one minute:</p>
<div class="highlight-python"><pre>{
    ...
    "rewrite": {
        "script": [
            "import \"pscheduler/iso8601\" as iso;",

            ".",
            "| if .schedule.repeat != null"
            "    and iso::duration_as_seconds(.schedule.repeat) &lt; 60",
            "  then",
            "    .schedule.repeat = \"PT1M\"",
            "    | change(\"Bumped repeat to one-minute minimum\")",
            "  else",
            "    .",
            "  end",

            "# The end."
        ]
    },
    ...
}</pre>
</div>
</div>
<div class="section" id="limits-what-are-the-restrictions">
<h2>Limits:  <em>What Are the Restrictions?</em><a class="headerlink" href="#limits-what-are-the-restrictions" title="Permalink to this headline">¶</a></h2>
<p>The third phase of vetting a task is determining whether or not its
parameters fall within acceptable values.  Each limit is evaluated and
either <em>passes</em> (i.e., the task parameters fell within the limit&#8217;s
restrictions) or <em>fails</em> (i.e., it did not).</p>
<p>The <tt class="docutils literal"><span class="pre">limits</span></tt> section of the limit configuration is nearly identical
to the <tt class="docutils literal"><span class="pre">identifiers</span></tt> section and contains the following pairs:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">name</span></tt> - A string which gives the limit a name which must be
unique among all limits.</li>
<li><tt class="docutils literal"><span class="pre">description</span></tt> - A human-readable string describing the limit.</li>
<li><tt class="docutils literal"><span class="pre">clone</span></tt> - A string naming another limit that should be used as a
starting point for this one.</li>
<li><tt class="docutils literal"><span class="pre">type</span></tt> - If the limit was not cloned from another, a string
indicating what the type of limit to be checked.  (See <em>Limit
Parameter Types</em>.)</li>
<li><tt class="docutils literal"><span class="pre">data</span></tt> - A JSON object containing <tt class="docutils literal"><span class="pre">type</span></tt>-specific data used in
determining whether the task meets this limit.  (See <em>Limit
Parameter Types</em>.)</li>
<li><tt class="docutils literal"><span class="pre">invert</span></tt> - An optional boolean value indicating whether or not
the result should be inverted after evaluation (i.e., <tt class="docutils literal"><span class="pre">true</span></tt>
would pass a limit that would otherwise have failed and <tt class="docutils literal"><span class="pre">false</span></tt>
would do the opposite).</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><pre>{
    ...
    "limits": [
        {
            "name": "always",
            "description": "Always passes",
            "type": "pass-fail",
            "data": {
                "pass": true
            }
        },
        {
            "name": "innocuous-tests",
            "description": "Tests that are harmless",
            "type": "test-type",
            "data": {
                "types": [ "idle", "latency", "rtt", "trace" ]
            }
        },
        {
            "name": "throughput-default-time",
            "description": "Throughput time limits",
            "type": "jq",
            "data": {
                "script": [
                    "import \"pscheduler/iso8601\" as iso;",
                    "if .test.type == \"throughput\"",
                    "   and iso::duration_as_seconds(.test.spec.duration) &gt; 60",
                    "then \"Duration for throughput must be 60 seconds or less.\"",
                    "else true",
                    "end"
                ]
            }
        },
        {
            "name": "throughput-default-udp",
            "description": "UDP throughput bandwidth limits",
            "type": "jq",
            "data": {
                "script": [
                    "import \"pscheduler/iso8601\" as iso;",
                    "if .test.type == \"throughput\"",
                    "   and .test.spec.udp == true",
                    "   and (.test.spec.bandwidth == null or.test.spec.bandwidth &gt; 50000000)",
                    "then",
                    "  \"UDP throughput bandwidth must be less than 50 Mb/s\"",
                    "else true",
                    "end"
                ]
            }
        }
    ],
    ...
}</pre>
</div>
<div class="section" id="limit-types">
<h3>Limit Types<a class="headerlink" href="#limit-types" title="Permalink to this headline">¶</a></h3>
<div class="section" id="jq-use-a-jq-script-to-make-a-pass-fail-decision">
<h4><tt class="docutils literal"><span class="pre">jq</span></tt> - Use a jq Script to Make a Pass/Fail Decision<a class="headerlink" href="#jq-use-a-jq-script-to-make-a-pass-fail-decision" title="Permalink to this headline">¶</a></h4>
<p>The <tt class="docutils literal"><span class="pre">jq</span></tt> limit hands the proposed task to a
<a class="reference external" href="https://stedolan.github.io/jq">jq</a> script and passes or fails based
on the script&#8217;s return value.</p>
<p>Input to the script is a single JSON object containing the following
pairs:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">test</span></tt> - A JSON object containing the proposed test with a
<tt class="docutils literal"><span class="pre">type</span></tt> (a string) and <tt class="docutils literal"><span class="pre">spec</span></tt> (a JSON object containing the test
specification).</li>
<li><tt class="docutils literal"><span class="pre">tool</span></tt> - A string that names the tool that was selected.</li>
<li><tt class="docutils literal"><span class="pre">schedule</span></tt> - A JSON object containing all schedule paramaters
submitted with the test (any of <tt class="docutils literal"><span class="pre">start</span></tt>, <tt class="docutils literal"><span class="pre">repeat</span></tt>, <tt class="docutils literal"><span class="pre">repeat-cron</span></tt>,
<tt class="docutils literal"><span class="pre">max-runs</span></tt>, <tt class="docutils literal"><span class="pre">until</span></tt>, <tt class="docutils literal"><span class="pre">slip</span></tt>, and <tt class="docutils literal"><span class="pre">sliprand</span></tt>)</li>
<li><tt class="docutils literal"><span class="pre">run_schedule</span></tt> - An optional JSON object containing an ISO8601
timestamp (<cite>start</cite>) and ISO8601 duration (<cite>duration</cite>) specifying
when the run is proposed to start and how much time it will spend
running.  (Note that the latter is usually greater than the test&#8217;s
<cite>duration</cite> parameter if it has one.)  This object will not be
present if a new task is being evaluated but will be for evaluation
of runs.</li>
</ul>
</div></blockquote>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;test&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;throughput&quot;</span><span class="p">,</span>
        <span class="s">&quot;spec&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&quot;dest&quot;</span><span class="p">:</span> <span class="s">&quot;ps.example.com&quot;</span><span class="p">,</span>
            <span class="s">&quot;bandwidth&quot;</span><span class="p">:</span> <span class="s">&quot;200M&quot;</span><span class="p">,</span>
            <span class="s">&quot;duration&quot;</span><span class="p">:</span> <span class="s">&quot;PT1M&quot;</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="s">&quot;tool&quot;</span><span class="p">:</span> <span class="s">&quot;iperf3&quot;</span><span class="p">,</span>
    <span class="s">&quot;schedule&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;repeat&quot;</span><span class="p">:</span> <span class="s">&quot;PT10M&quot;</span><span class="p">,</span>
        <span class="s">&quot;max-runs&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="s">&quot;run_schedule&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;start&quot;</span><span class="p">:</span> <span class="s">&quot;2018-06-19T12:34:56&quot;</span><span class="p">,</span>
        <span class="s">&quot;duration&quot;</span><span class="p">:</span> <span class="s">&quot;PT1M8S&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The script should produce one of the following values:</p>
<blockquote>
<div><ul class="simple">
<li>Boolean (<tt class="docutils literal"><span class="pre">true</span></tt> or <tt class="docutils literal"><span class="pre">false</span></tt>) - Signifies that the proposed task passes or does not pass the limit.  If the value is <tt class="docutils literal"><span class="pre">false</span></tt>, the limit system&#8217;s diagnostic output will indicate an unspecified reason for the failure.</li>
<li>String - Signifies that the proposed task  does not pass the limit and uses the contents of the string as the reason for the failure in diagnostic output.</li>
</ul>
</div></blockquote>
<p>Non-boolean or non-string output will be treated as if the limit did not pass and a suitable diagnostic message will be provided.</p>
<p><strong>Examples</strong></p>
<p>(Note that whitespace has been added to some strings for clarity.)</p>
<p>Limit the <cite>length</cite> parameter of any test to 256:</p>
<div class="highlight-python"><pre>{
    "name": "big-packets",
    "description": "Limit packet size for all tests",
    "type": "jq",
    "data": {
        "script": "256 as $max_length
                   | if .spec.length &gt; $max_length
                     then \"Packets are limited to \\($max_length) bytes\"
                     else true
                     end"
    }
}</pre>
</div>
<p>Limit any the number of hops in a <cite>trace</cite> test to 20:</p>
<div class="highlight-python"><pre>{
    "name": "trace-hops",
    "description": "Limit trace hops",
    "type": "jq",
    "data": {
        "script": "20 as $max_hops
                   | if .type == \"trace\" and .spec.hops &gt; $max_hops
                     then \"No more than \\($max_hops) hops allowed.\"
                     else true
                     end"
    }
}</pre>
</div>
<p>Limit the bandwidth of <cite>throughput</cite> tests to 500 Mb/s:</p>
<div class="highlight-python"><pre>{
    "name": "throughput-low-bandwidth",
    "description": "Limit throughput test bandwidth",
    "type": "jq",
    "data": {
        "script": "import \"pscheduler/si\" as si;
                   "500M" as $max_bandwidth
                   | if .type == \"throughput\"
                         and si::as_integer(.spec.bandwidth) &gt; si::as_integer($max_bandwidth)
                     then \"Bandwidth is limited to \\($max_bandwidth)\"
                     else true
                     end"
    }
}</pre>
</div>
</div>
<div class="section" id="pass-fail-explicitly-pass-or-fail">
<h4><tt class="docutils literal"><span class="pre">pass-fail</span></tt> - Explicitly Pass or Fail<a class="headerlink" href="#pass-fail-explicitly-pass-or-fail" title="Permalink to this headline">¶</a></h4>
<p>The <tt class="docutils literal"><span class="pre">pass-fail</span></tt> limit will either pass or fail depending on a value
in its <tt class="docutils literal"><span class="pre">data</span></tt>.</p>
<p>Its <tt class="docutils literal"><span class="pre">data</span></tt> is an object containing the following pair:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">pass</span></tt> - A boolean indicating whether or not the limit will pass
or fail.</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;never&quot;</span><span class="p">,</span>
    <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;Fail to pass&quot;</span><span class="p">,</span>
    <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;pass-fail&quot;</span><span class="p">,</span>
    <span class="s">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;pass&quot;</span><span class="p">:</span> <span class="n">false</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="run-daterange-check-run-times-against-a-range">
<h4><tt class="docutils literal"><span class="pre">run-daterange</span></tt> - Check Run Times Against a Range<a class="headerlink" href="#run-daterange-check-run-times-against-a-range" title="Permalink to this headline">¶</a></h4>
<p>The <tt class="docutils literal"><span class="pre">run-daterange</span></tt> limit tests to see whether the time range for a
run falls within a specified range.</p>
<p>Its <tt class="docutils literal"><span class="pre">data</span></tt> is an object containing the following pairs:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">start</span></tt> - An ISO 8601 timestamp specifying the start of the range.</li>
<li><tt class="docutils literal"><span class="pre">end</span></tt> - An ISO 8601 timestamp specifying the end of the range.</li>
<li><tt class="docutils literal"><span class="pre">overlap</span></tt> - A boolean which, if <tt class="docutils literal"><span class="pre">true</span></tt>, will let the limit pass
if the run&#8217;s time range overlaps the specified range but does not
fall completely within it.</li>
</ul>
<p>Note that limits of this type are only evaluated when scheduling runs
and will be considered having passed when a task is submitted.</p>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;summer-2017&quot;</span><span class="p">,</span>
    <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;The summer of 2017&quot;</span><span class="p">,</span>
    <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;run-daterange&quot;</span><span class="p">,</span>
    <span class="s">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;start&quot;</span><span class="p">:</span> <span class="s">&quot;2017-06-21T00:00:00&quot;</span><span class="p">,</span>
        <span class="s">&quot;end&quot;</span><span class="p">:</span> <span class="s">&quot;2017-09-22T23:59:59&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="run-schedule-check-attributes-of-the-run-time">
<h4><tt class="docutils literal"><span class="pre">run-schedule</span></tt> - Check Attributes of the Run Time<a class="headerlink" href="#run-schedule-check-attributes-of-the-run-time" title="Permalink to this headline">¶</a></h4>
<p>The <tt class="docutils literal"><span class="pre">run-schedule</span></tt> limit tests to see whether attributes of the time
range for a run matches those specified.</p>
<p>Its <tt class="docutils literal"><span class="pre">data</span></tt> is an object containing the following pairs.  The format
of the pairs is described below.</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">year</span></tt> - The years in which the run will happen.</li>
<li><tt class="docutils literal"><span class="pre">month</span></tt> - The months in which the run will happen, numbered from <tt class="docutils literal"><span class="pre">1</span></tt> to <tt class="docutils literal"><span class="pre">12</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">day</span></tt> - The days of the month in which the run will happen, numbered from <tt class="docutils literal"><span class="pre">1</span></tt> to <tt class="docutils literal"><span class="pre">31</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">weekday</span></tt> - The days of the week in which the run will happen,
numbered from <tt class="docutils literal"><span class="pre">1</span></tt> (Monday) to <tt class="docutils literal"><span class="pre">7</span></tt> (Sunday) according to
ISO 8601.</li>
<li><tt class="docutils literal"><span class="pre">hour</span></tt> - The hours in which the run will happen, numbered from <tt class="docutils literal"><span class="pre">0</span></tt> to <tt class="docutils literal"><span class="pre">23</span></tt></li>
<li><tt class="docutils literal"><span class="pre">minute</span></tt> - The minutes in which the run will happen, numbered from <tt class="docutils literal"><span class="pre">0</span></tt> to <tt class="docutils literal"><span class="pre">59</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">second</span></tt> - The seconds in which the run will happen, numbered from <tt class="docutils literal"><span class="pre">0</span></tt> to <tt class="docutils literal"><span class="pre">59</span></tt>.</li>
</ul>
<p>All pairs are optional.</p>
<p>Each pair consists of a key (e.g., <tt class="docutils literal"><span class="pre">month</span></tt>) and an array of
individual numbers or ranges.  Each range is an object containing the
following pairs:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">lower</span></tt> - An integer specifying the lower end of the range.</li>
<li><tt class="docutils literal"><span class="pre">upper</span></tt> - An integer specifying the upper end of the range.</li>
</ul>
<p>Note that limits of this type are only evaluated when scheduling runs
and will be considered having passed when a task is submitted.</p>
<p>For example:</p>
<div class="highlight-python"><pre>{
    "name": "not-in-maint-window",
    "description": "Outside weekly maintenance windows (Wed &amp; Sun, 2 and 4-8 a.m.)",
    "type": "run-schedule",
    "data": {
        "weekday": [ 3, 7 ],
        "hour": [ 2, { "lower": 4, "upper": 7 } ],
        "overlap": true
        "invert": true
    }
}</pre>
</div>
</div>
<div class="section" id="test-type-check-test-type">
<h4><tt class="docutils literal"><span class="pre">test-type</span></tt> - Check Test Type<a class="headerlink" href="#test-type-check-test-type" title="Permalink to this headline">¶</a></h4>
<p>The <tt class="docutils literal"><span class="pre">test-type</span></tt> limit compares the type of the proposed test to a
list of test types.</p>
<p>Its <tt class="docutils literal"><span class="pre">data</span></tt> is an object containing the following pair:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">types</span></tt> - An array of strings to be compared in deciding whether
or not the limit passes.</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;inoccuous-tests&quot;</span><span class="p">,</span>
    <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;Tests that are harmless&quot;</span><span class="p">,</span>
    <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;test-type&quot;</span><span class="p">,</span>
    <span class="s">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;types&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s">&quot;idle&quot;</span><span class="p">,</span> <span class="s">&quot;latency&quot;</span><span class="p">,</span> <span class="s">&quot;rtt&quot;</span><span class="p">,</span> <span class="s">&quot;trace&quot;</span> <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="url-fetch-get-a-decision-by-fetching-a-url">
<h4><tt class="docutils literal"><span class="pre">url-fetch</span></tt> - Get a decision by fetching a URL<a class="headerlink" href="#url-fetch-get-a-decision-by-fetching-a-url" title="Permalink to this headline">¶</a></h4>
<p>The <tt class="docutils literal"><span class="pre">url-fetch</span></tt> limit asks an external HTTP(S) server for a
pass/fail decision based on information passed in as parameters or
part of the URL.</p>
<p>If the <tt class="docutils literal"><span class="pre">success-only</span></tt> parameter is <tt class="docutils literal"><span class="pre">false</span></tt>, the server must return
an HTTP status of <tt class="docutils literal"><span class="pre">200</span></tt> and a document of type <tt class="docutils literal"><span class="pre">applicastion/json</span></tt>
containing an object with the following pairs:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">passed</span></tt> - A boolean indicating whether or not this limit should
pass.</li>
<li><tt class="docutils literal"><span class="pre">message</span></tt> - An string containing a message that the server thinks
is relevant about the transaction.  A simple <tt class="docutils literal"><span class="pre">OK</span></tt> is sufficient if
<tt class="docutils literal"><span class="pre">passed</span></tt> is <tt class="docutils literal"><span class="pre">true</span></tt>.</li>
</ul>
<p>Any other HTTP status will be treated as an error.</p>
<p>The limit&#8217;s <tt class="docutils literal"><span class="pre">data</span></tt> is an object containing the following pairs:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">url</span></tt> - The URL to be queried.  Note that this value is required
even if <tt class="docutils literal"><span class="pre">url-transform</span></tt> (below) is being used to produce the URL.
(An empty string is acceptable.)</li>
<li><tt class="docutils literal"><span class="pre">url-transform</span></tt> - An optional jq transform to alter the contents
of the <tt class="docutils literal"><span class="pre">url</span></tt> parameter.  The returned value must be a string.  The
proposed task may be accessed with <tt class="docutils literal"><span class="pre">.task</span></tt> and server hints are
available by calling the <tt class="docutils literal"><span class="pre">hint($value)</span></tt> function.  The original
URL can be accessed as <tt class="docutils literal"><span class="pre">.url</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">bind</span></tt> - An optional string indicating the hostname or address to
which the system should bind when connecting.</li>
<li><tt class="docutils literal"><span class="pre">verify-keys</span></tt> - An optional boolean indicating whether or not
HTTPS protocol should verify the server&#8217;s keys as part of the
connection process.  If not provided, the default is <tt class="docutils literal"><span class="pre">true</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">follow-redirects</span></tt> - An optional boolean indicating whether or not
server-provided redirects should be followed.  If <tt class="docutils literal"><span class="pre">false</span></tt>, a
redirection will be treated as an error.  If not provided, the
default is <tt class="docutils literal"><span class="pre">true</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">headers</span></tt> - An optional JSON object containing headers to be sent
to the server during the fetch.  If not provided, no headers will be
added.</li>
<li><tt class="docutils literal"><span class="pre">headers-transform</span></tt> - An optional jq transform to alter the
contents of the <tt class="docutils literal"><span class="pre">headers</span></tt> parameter by modifying <tt class="docutils literal"><span class="pre">.headers</span></tt> in
place.  The transform should return everything provided as input.
The proposed task may be accessed in <tt class="docutils literal"><span class="pre">.task</span></tt> and server hints
are available by calling the <tt class="docutils literal"><span class="pre">hint($value)</span></tt> function.</li>
<li><tt class="docutils literal"><span class="pre">params</span></tt> - An optional JSON object containing parameters to be added to the</li>
<li><tt class="docutils literal"><span class="pre">params-transform</span></tt> - An optional jq transform to alter the
contents of the <tt class="docutils literal"><span class="pre">params</span></tt> parameter by modifying <tt class="docutils literal"><span class="pre">.params</span></tt> in
place.  The transform should return everything provided as input.
The proposed task may be accessed in <tt class="docutils literal"><span class="pre">.task</span></tt> and server hints
are available by calling the <tt class="docutils literal"><span class="pre">hint($value)</span></tt> function.</li>
<li><tt class="docutils literal"><span class="pre">timeout</span></tt> - An optional ISO 8601 duration that determines how much
time can elapse before the fetch is considered a failure and
aborted.  The default is <tt class="docutils literal"><span class="pre">PT3S</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">success-only</span></tt> - An optional boolean that, if <tt class="docutils literal"><span class="pre">true</span></tt>, disregards
any content returned by the server and treats the limit as having
passed if the HTTP status is <tt class="docutils literal"><span class="pre">200</span></tt> or failed if it is <tt class="docutils literal"><span class="pre">404</span></tt>.
Any other error is treated as a failure and will be handled
according to the state of <tt class="docutils literal"><span class="pre">fail-result</span></tt>, described below.  If not
provided, the default is <tt class="docutils literal"><span class="pre">false</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">fail-result</span></tt> - An optional boolean that determines whether the
limit passes or fails when the fetch returns any HTTP status other
than <tt class="docutils literal"><span class="pre">200</span></tt>.  If not provided, the default is <tt class="docutils literal"><span class="pre">false</span></tt>.</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;name&quot;</span><span class="p">:</span> <span class="s">&quot;server-says-ok&quot;</span><span class="p">,</span>
    <span class="s">&quot;description&quot;</span><span class="p">:</span> <span class="s">&quot;An external server approves of this task&quot;</span><span class="p">,</span>
    <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;url-fetch&quot;</span><span class="p">,</span>
    <span class="s">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s">&quot;url&quot;</span><span class="p">:</span> <span class="s">&quot;https://decider.example.org/is-okay&quot;</span><span class="p">,</span>
        <span class="s">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&quot;check-type&quot;</span><span class="p">:</span> <span class="s">&quot;whatever&quot;</span>
        <span class="p">},</span>
        <span class="s">&quot;params-transform&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&quot;script&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s">&quot;  .params.requester = hint(</span><span class="se">\&quot;</span><span class="s">requester</span><span class="se">\&quot;</span><span class="s">)&quot;</span><span class="p">,</span>
                <span class="s">&quot;| .params.test  = .test.type&quot;</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="s">&quot;headers&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&quot;Cache-Control&quot;</span><span class="p">:</span> <span class="s">&quot;no-cache&quot;</span>
        <span class="p">},</span>
        <span class="s">&quot;headers-transform&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s">&quot;script&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s">&quot;.Authorizatiion = </span><span class="se">\&quot;</span><span class="s">Basic </span><span class="se">\\</span><span class="s">($auth)</span><span class="se">\&quot;</span><span class="s">&quot;</span>
            <span class="p">],</span>
            <span class="s">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s">&quot;auth&quot;</span><span class="p">:</span> <span class="s">&quot;bXVtYmxlbXVtYmxlbXVtYmxlCg==&quot;</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="applications-to-whom-do-we-apply-the-limits">
<h2>Applications: <em>To Whom do We Apply the Limits?</em><a class="headerlink" href="#applications-to-whom-do-we-apply-the-limits" title="Permalink to this headline">¶</a></h2>
<p>The final phase of vetting a task or run is determining whether or not
its parameters make it permissible.  This is accomplished by
evaluating a series of <em>limit applications</em>, each of which ties a
classifier to a series of conditions which must be met before approval
can happen.</p>
<p>Each limit application is a JSON object consisting of the following:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">description</span></tt> - A human-readable string describing what the application does.</li>
<li><tt class="docutils literal"><span class="pre">classifier</span></tt> - A string naming a classifier to which the
application should be applied.</li>
<li><tt class="docutils literal"><span class="pre">apply</span></tt> - An array of <em>limit requirements</em> (described in detail
in <em>Applying Limit Requirements</em>, below), all of which must be
satisfied for the application to have passed.</li>
<li><tt class="docutils literal"><span class="pre">invert</span></tt> - A boolean indicating that the application&#8217;s result
should be inverted (i.e., an application that passes should be
treated as if it failed and one that fails should be treated as if
it passed).</li>
<li><tt class="docutils literal"><span class="pre">stop-on-failure</span></tt> - A boolean indicating that if an application
does not pass, the task or run should be denied without evaluating
any further applications in the list.  This us useful for
short-circuiting the process of denying requests you do not wish to
service.</li>
</ul>
<p>The system will evaluate each application in sequence.  (This process
is described in detail in <em>Applying Limit Requirements</em>, below.)  If
an application <em>passes</em> (i.e., its conditions will allow the task or
run to happen), the task or run is permitted.  If it <em>fails</em> and
<tt class="docutils literal"><span class="pre">stop-on-failure</span></tt> is <tt class="docutils literal"><span class="pre">true</span></tt>, it is denied.  If if fails and
<tt class="docutils literal"><span class="pre">stop-on-failure</span></tt> is <tt class="docutils literal"><span class="pre">false</span></tt>, the next application in the list is
evaluated.  If the end of the list is reached with no application
having passed, the task or run is denied.</p>
<p>For example:</p>
<div class="highlight-python"><pre>{
    ...
    "applications": [
        {
            "description": "Allow users on the local system to do anything",
            "classifier": "local-requester",
            "apply": [
                {
                    "require": "all",
                    "limits": [ "always" ]
                }
            ]
        },
        {
            "description": "What we allow guests to do",
            "classifier": "guests",
            "apply": [
                {
                    "require": "any",
                    "limits": [
                        "innocuous-tests",
                        "guest-throughput",
                        "guest-rtt"
                    ]
                }
            ],
            "stop-on-failure": true
        }
    ]
}</pre>
</div>
<p>The first application allows any requester in the <tt class="docutils literal"><span class="pre">local-requester</span></tt>
classification to run anything because it applies the <tt class="docutils literal"><span class="pre">always</span></tt>
limit, which always passes.  The second application alows requesters
in the <tt class="docutils literal"><span class="pre">guests</span></tt> classifier be runing any of the harmless tests or a
throughput or round-trip time test that meets predefined limits for
guests.  Failing both of those will result in denial because the
policy is to deny unless explicitly allowed.</p>
<div class="section" id="applying-limit-requirements">
<h3>Applying Limit Requirements<a class="headerlink" href="#applying-limit-requirements" title="Permalink to this headline">¶</a></h3>
<p>Each limit requirement is a JSON object containing the following:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">limits</span></tt> - An array of strings naming one or more limits to be
considered when deciding if this limit requirement passes.</li>
<li><tt class="docutils literal"><span class="pre">require</span></tt> - A string specifying how many of the requirement&#8217;s
limits must pass for the requirement to be considered met.  Valid
values are:</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">none</span></tt> - Consider the requirement met if none of the limits
passes.</li>
<li><tt class="docutils literal"><span class="pre">one</span></tt> - Consider the requirement met if exactly one of the
limits passes.</li>
<li><tt class="docutils literal"><span class="pre">any</span></tt> - Consider the requirement met if at least one of the
limits passes.</li>
<li><tt class="docutils literal"><span class="pre">all</span></tt> - Consider the requirement met only if all of the limits
pass.</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="priorities-which-runs-happen-and-which-do-not">
<span id="config-pscheduler-limits-priorities"></span><h2>Priorities: <em>Which Runs Happen and Which Do Not?</em><a class="headerlink" href="#priorities-which-runs-happen-and-which-do-not" title="Permalink to this headline">¶</a></h2>
<p>Once a run has been vetted by the limit system, it can be assigned a
priority used in resolving conflicts with other runs scheduled at the
same time.  This applies to tests like <tt class="docutils literal"><span class="pre">throughput</span></tt>, which are given
exclusive use of the system.  Tests which run in the background may be
given priorities but will be unaffected.</p>
<p>The priority value is an integer.  When comparing two or more runs,
the one wit the highest priority value will be run.  Nominally, the
dafault priority is <tt class="docutils literal"><span class="pre">0</span></tt>, but any initial value can be configured.</p>
<p>During scheduling, pScheduler will make two attempts to schedule each
run within the allowed slip time.  The first is without regard to
priority as a way to avoid conflicts by adjusting the start time
within the allowed slip range.  If that fails, the second will be made
with the priority and disregarding the presence of lower-priority
runs, effectively preempting them.  If neither attempt succeeds, the
run will be posted as a non-starter.</p>
<p>Once a run is posted to the schedule, it remains there even if one
with a higher priority is scheduled.  At the scheduled start time, the
run will happen if there are no overlapping runs of higher priority.
Otherwise, the lower-priority run will be considered preempted in
favor of the higher-priority run.</p>
<div class="section" id="the-priority-script">
<h3>The Priority Script<a class="headerlink" href="#the-priority-script" title="Permalink to this headline">¶</a></h3>
<p>If the limit configuration contains a <tt class="docutils literal"><span class="pre">priority</span></tt> object, its
contents will be a standard jq transform as used elsewhere in
pScheduler.  If it does not, the priority system will be disabled and
the default of <tt class="docutils literal"><span class="pre">0</span></tt> will be assigned to all runs scheduled.  Note
that participants in multi-participant tests having a priority
configuration may still prioritize runs.</p>
<p>Input to the transform&#8217;s script is a JSON object containing the
contents of the task as it was submitted to the server.  The
prioritizer adds a private pair for its own internal use (currently
named <cite>__PRIOIRITIZER_PRIVATE__</cite>) which should not be examined or
modified.</p>
<p>The jq script is passed the task in the same format as other jq
scripts used in the limit system.</p>
<p>Scripts will have the following functions available to get additional
information and make changes:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">classifiers</span></tt> - Returns an array of the classifiers into which the node requesting the task were grouped (e.g., <cite>[ &#8220;friendlies&#8221;, &#8220;partners&#8221; ]</cite>).</li>
<li><tt class="docutils literal"><span class="pre">classifiers_has(value)</span></tt> - Returns a boolean indicating whether or not the string <cite>value</cite> is one of the classifiers.</li>
<li><tt class="docutils literal"><span class="pre">default</span></tt> - Returns the default priority, normally <tt class="docutils literal"><span class="pre">0</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">requested</span></tt> - Returns the requested priority or <tt class="docutils literal"><span class="pre">null</span></tt> if no priority was requested.</li>
</ul>
</div></blockquote>
<p>The following functions can be used to make changes to the</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">note(message)</span></tt> - Adds <tt class="docutils literal"><span class="pre">message</span></tt> to the diagnostics.</li>
<li><tt class="docutils literal"><span class="pre">set(value;</span> <span class="pre">message)</span></tt> - Sets the priority to <tt class="docutils literal"><span class="pre">value</span></tt> and adds
<tt class="docutils literal"><span class="pre">message</span></tt> to the diagnostics.</li>
<li><tt class="docutils literal"><span class="pre">adjust(value;</span> <span class="pre">message)</span></tt> - Adjusts the priority by <tt class="docutils literal"><span class="pre">value</span></tt>, which can be positive or negative, and adds <tt class="docutils literal"><span class="pre">message</span></tt> to the diagnostics.</li>
</ul>
</div></blockquote>
<p>The priority in effect at the end of the script will be assigned to
the run and any diagnostics produced will be stored.</p>
</div>
</div>
<div class="section" id="checking-limit-configuration-files-for-validity">
<span id="config-pscheduler-limits-check-validity"></span><h2>Checking Limit Configuration Files for Validity<a class="headerlink" href="#checking-limit-configuration-files-for-validity" title="Permalink to this headline">¶</a></h2>
<p>pScheduler includes a <tt class="docutils literal"><span class="pre">validate-limits</span></tt> command which can be used to
verify that a limit configuration is valid during development and
prior to installation on the system.</p>
<p>To validate limits in a file:</p>
<div class="highlight-python"><pre>% pscheduler validate-limits valid-limits.conf
Limit configuration is valid.

% pscheduler validate-limits invalid-limits.conf
Invalid limit file: At /: Additional properties are not allowed (u'notvalid' were unexpected)</pre>
</div>
<p>To validate the installed configuration, become <tt class="docutils literal"><span class="pre">root</span></tt> and execute:</p>
<div class="highlight-python"><pre># pscheduler validate-limits
Limit configuration is valid.</pre>
</div>
<p>The command will exit with a status of <tt class="docutils literal"><span class="pre">0</span></tt> if the limit file was
valid or nonzero if it was not.  Errors will be sent to the standard
error and a message indicating that the configuration is valid will be
sent to the standard output if it is a TTY or the <tt class="docutils literal"><span class="pre">--quiet</span></tt> switch
is not in effect.</p>
<p>Details on command-line switches and sample invocations can be
obtained by running the command <tt class="docutils literal"><span class="pre">pscheduler</span> <span class="pre">validate-limits</span> <span class="pre">--help</span></tt>.</p>
</div>
<div class="section" id="standard-objects">
<h2>Standard Objects<a class="headerlink" href="#standard-objects" title="Permalink to this headline">¶</a></h2>
<p>This section describes standard JSON objects used in the limit configuration.</p>
<p>Content in this section is forthcoming.</p>
<div class="section" id="stringmatch-string-matching-specification">
<h3><tt class="docutils literal"><span class="pre">StringMatch</span></tt> - String Matching Specification<a class="headerlink" href="#stringmatch-string-matching-specification" title="Permalink to this headline">¶</a></h3>
<p><tt class="docutils literal"><span class="pre">StringMatch</span></tt> is a JSON object containing the following pairs:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">style</span></tt> - A string specifying what type of matching should be
done with the <tt class="docutils literal"><span class="pre">match</span></tt> string (see below).  Valid values are:</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">exact</span></tt> - The compared string must be exactly equal to <tt class="docutils literal"><span class="pre">match</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">contains</span></tt> - The <tt class="docutils literal"><span class="pre">match</span></tt> string must be contained somewhere
within the compared string.</li>
<li><tt class="docutils literal"><span class="pre">regex</span></tt> - The compared string must match the <a class="reference external" href="https://docs.python.org/2/library/re.html#regular-expression-syntax">Python 2 regular
expression</a>
specified in <tt class="docutils literal"><span class="pre">match</span></tt>.</li>
</ul>
</div></blockquote>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">match</span></tt> - The string to be matched, subject to the specified <tt class="docutils literal"><span class="pre">style</span></tt>.</li>
</ul>
<p>For example, this <tt class="docutils literal"><span class="pre">StringMatch</span></tt> looks for an empty string or one
containing a vowel:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;style&quot;</span><span class="p">:</span> <span class="s">&quot;regex&quot;</span><span class="p">,</span>
    <span class="s">&quot;match&quot;</span><span class="p">:</span> <span class="s">&quot;(^$|[aeiou])&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="limit-parameter-types">
<h2>Limit Parameter Types<a class="headerlink" href="#limit-parameter-types" title="Permalink to this headline">¶</a></h2>
<p>This section describes standard types of objects used by the <tt class="docutils literal"><span class="pre">test</span></tt>
limit.</p>
<div class="section" id="boolean-compares-boolean-values">
<h3><tt class="docutils literal"><span class="pre">Boolean</span></tt> - Compares Boolean Values<a class="headerlink" href="#boolean-compares-boolean-values" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">description</span></tt> - An optional human-readable description.</li>
<li><tt class="docutils literal"><span class="pre">match</span></tt> - A boolean value (<tt class="docutils literal"><span class="pre">true</span></tt> or <tt class="docutils literal"><span class="pre">false</span></tt>) to be matched</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;match&quot;</span><span class="p">:</span> <span class="n">false</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="cardinal-compares-one-based-integers">
<h3><tt class="docutils literal"><span class="pre">Cardinal</span></tt> - Compares One-Based Integers<a class="headerlink" href="#cardinal-compares-one-based-integers" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">description</span></tt> - An optional human-readable description.</li>
<li><tt class="docutils literal"><span class="pre">range</span></tt> - A range of <tt class="docutils literal"><span class="pre">Cardinal</span></tt> values to be matched.</li>
<li><tt class="docutils literal"><span class="pre">invert</span></tt> - An optional Boolean indicating that the result should
be negated.</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;range&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s">&quot;lower&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s">&quot;upper&quot;</span><span class="p">:</span> <span class="mi">8</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="cardinallist-compares-a-list-of-one-based-integers">
<h3><tt class="docutils literal"><span class="pre">CardinalList</span></tt> - Compares a List of One-Based Integers<a class="headerlink" href="#cardinallist-compares-a-list-of-one-based-integers" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">description</span></tt> - An optional human-readable description.</li>
<li><tt class="docutils literal"><span class="pre">match</span></tt> - A list of <tt class="docutils literal"><span class="pre">Cardinal</span></tt> values to be matched.</li>
<li><tt class="docutils literal"><span class="pre">invert</span></tt> - An optional Boolean indicating that the result should
be negated.</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;match&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span> <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="cardinalzero-compares-zero-based-integers">
<h3><tt class="docutils literal"><span class="pre">CardinalZero</span></tt> - Compares Zero-Based Integers<a class="headerlink" href="#cardinalzero-compares-zero-based-integers" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">description</span></tt> - An optional human-readable description.</li>
<li><tt class="docutils literal"><span class="pre">range</span></tt> - A range of <tt class="docutils literal"><span class="pre">CardinalZero</span></tt> values to be matched.</li>
<li><tt class="docutils literal"><span class="pre">invert</span></tt> - An optional Boolean indicating that the result should
be negated.</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;range&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s">&quot;lower&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;upper&quot;</span><span class="p">:</span> <span class="mi">19</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="cardinalzerolist-compares-a-list-of-zero-based-integers">
<h3><tt class="docutils literal"><span class="pre">CardinalZeroList</span></tt> - Compares a List of Zero-Based Integers<a class="headerlink" href="#cardinalzerolist-compares-a-list-of-zero-based-integers" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">description</span></tt> - An optional human-readable description.</li>
<li><tt class="docutils literal"><span class="pre">match</span></tt> - A list of <tt class="docutils literal"><span class="pre">CardinalZero</span></tt> values to be matched.</li>
<li><tt class="docutils literal"><span class="pre">invert</span></tt> - An optional Boolean indicating that the result should
be negated.</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;match&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span> <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="duration-compares-iso-8601-durations">
<h3><tt class="docutils literal"><span class="pre">Duration</span></tt> - Compares ISO 8601 Durations<a class="headerlink" href="#duration-compares-iso-8601-durations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">description</span></tt> - An optional human-readable description.</li>
<li><tt class="docutils literal"><span class="pre">range</span></tt> - A range of <tt class="docutils literal"><span class="pre">Duration</span></tt> values to be matched.</li>
<li><tt class="docutils literal"><span class="pre">invert</span></tt> - An optional Boolean indicating that the result should
be negated.</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;range&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s">&quot;lower&quot;</span><span class="p">:</span> <span class="s">&quot;PT15S&quot;</span><span class="p">,</span> <span class="s">&quot;upper&quot;</span><span class="p">:</span> <span class="s">&quot;PT1M&quot;</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="sinumber-compares-ranges-of-integers-with-si-units">
<h3><tt class="docutils literal"><span class="pre">SINumber</span></tt> - Compares Ranges of Integers with SI Units<a class="headerlink" href="#sinumber-compares-ranges-of-integers-with-si-units" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">description</span></tt> - An optional human-readable description.</li>
<li><tt class="docutils literal"><span class="pre">range</span></tt> - A range of <tt class="docutils literal"><span class="pre">SINumber</span></tt> values to be matched.</li>
<li><tt class="docutils literal"><span class="pre">invert</span></tt> - An optional Boolean indicating that the result should
be negated.</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;range&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s">&quot;lower&quot;</span><span class="p">:</span> <span class="s">&quot;600K&quot;</span><span class="p">,</span> <span class="s">&quot;upper&quot;</span><span class="p">:</span> <span class="s">&quot;5G&quot;</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="ipversion-compares-internet-protocol-versions">
<h3><tt class="docutils literal"><span class="pre">IPVersion</span></tt> - Compares Internet Protocol Versions<a class="headerlink" href="#ipversion-compares-internet-protocol-versions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">description</span></tt> - An optional human-readable description.</li>
<li><tt class="docutils literal"><span class="pre">match</span></tt> - An IP version to be matched</li>
<li><tt class="docutils literal"><span class="pre">invert</span></tt> - An optional Boolean indicating that the result should
be negated.</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;match&quot;</span><span class="p">:</span> <span class="mi">6</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="ipversionlist-compares-a-list-of-ip-protocol-versions">
<h3><tt class="docutils literal"><span class="pre">IPVersionList</span></tt> - Compares a List of IP Protocol Versions<a class="headerlink" href="#ipversionlist-compares-a-list-of-ip-protocol-versions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">description</span></tt> - An optional human-readable description.</li>
<li><tt class="docutils literal"><span class="pre">enumeration</span></tt> - A list of <tt class="docutils literal"><span class="pre">IPVersion</span></tt> values to be matched.</li>
<li><tt class="docutils literal"><span class="pre">invert</span></tt> - An optional Boolean indicating that the result should
be negated.</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;enumeration&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span> <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="probability-compares-ranges-of-decimal-probabilities">
<h3><tt class="docutils literal"><span class="pre">Probability</span></tt> - Compares Ranges of Decimal Probabilities<a class="headerlink" href="#probability-compares-ranges-of-decimal-probabilities" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">description</span></tt> - An optional human-readable description.</li>
<li><tt class="docutils literal"><span class="pre">range</span></tt> - A range of <tt class="docutils literal"><span class="pre">Probability</span></tt> values to be matched.</li>
<li><tt class="docutils literal"><span class="pre">invert</span></tt> - An optional Boolean indicating that the result should
be negated.</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;range&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s">&quot;lower&quot;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span> <span class="s">&quot;upper&quot;</span><span class="p">:</span> <span class="mf">1.0</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="string-compares-strings">
<h3><tt class="docutils literal"><span class="pre">String</span></tt> - Compares Strings<a class="headerlink" href="#string-compares-strings" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">description</span></tt> - An optional human-readable description.</li>
<li><tt class="docutils literal"><span class="pre">match</span></tt> - A <tt class="docutils literal"><span class="pre">StringMatch</span></tt> object.  (See <em>Standard Objects</em>, above.)</li>
<li><tt class="docutils literal"><span class="pre">invert</span></tt> - An optional Boolean indicating that the result should
be negated.</li>
</ul>
<p>For example:</p>
<div class="highlight-python"><pre>{
    "match": {
        style": "regex",
        "match": "platypus",
        "invert": true
    }
}</pre>
</div>
<p>Note that it is possible to have <tt class="docutils literal"><span class="pre">invert</span></tt> in both the limit and the
<tt class="docutils literal"><span class="pre">match</span></tt> <tt class="docutils literal"><span class="pre">StringMatch</span></tt> object.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <nav id="channelNav" class="channelNav">
                
                <ul>
<li><a class="reference internal" href="#">Configuring pScheduler Limits</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#the-limit-configuration-file">The Limit Configuration File</a><ul>
<li><a class="reference internal" href="#installing-a-limit-configuration">Installing a Limit Configuration</a></li>
<li><a class="reference internal" href="#content">Content</a></li>
<li><a class="reference internal" href="#comments">Comments</a></li>
</ul>
</li>
<li><a class="reference internal" href="#identifiers-who-s-asking">Identifiers:  <em>Who&#8217;s Asking?</em></a><ul>
<li><a class="reference internal" href="#identifier-types">Identifier Types</a><ul>
<li><a class="reference internal" href="#always-identify-everyone"><tt class="docutils literal"><span class="pre">always</span></tt> - Identify Everyone</a></li>
<li><a class="reference internal" href="#hint-identify-using-server-provided-hints"><tt class="docutils literal"><span class="pre">hint</span></tt> - Identify Using Server-Provided Hints</a></li>
<li><a class="reference internal" href="#ip-cidr-list-identify-by-requesting-ip-address"><tt class="docutils literal"><span class="pre">ip-cidr-list</span></tt> - Identify By Requesting IP Address</a></li>
<li><a class="reference internal" href="#ip-cidr-list-url-identify-by-requesting-ip-address-with-downloaded-list"><tt class="docutils literal"><span class="pre">ip-cidr-list-url</span></tt> - Identify By Requesting IP Address with Downloaded List</a></li>
<li><a class="reference internal" href="#ip-cymru-bogon-identify-bogon-addresses"><tt class="docutils literal"><span class="pre">ip-cymru-bogon</span></tt> - Identify Bogon Addresses</a></li>
<li><a class="reference internal" href="#ip-cymru-asn-identify-requesters-by-asn"><tt class="docutils literal"><span class="pre">ip-cymru-asn</span></tt> - Identify Requesters by ASN</a></li>
<li><a class="reference internal" href="#ip-reverse-dns-identify-requesters-by-host-name"><tt class="docutils literal"><span class="pre">ip-reverse-dns</span></tt> - Identify Requesters By Host Name</a></li>
<li><a class="reference internal" href="#jq-use-a-jq-script-to-identify-requesters"><tt class="docutils literal"><span class="pre">jq</span></tt> - Use a jq Script to Identify Requesters</a></li>
<li><a class="reference internal" href="#localif-identify-requesters-on-local-interfaces"><tt class="docutils literal"><span class="pre">localif</span></tt> - Identify Requesters On Local Interfaces</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#classifiers-how-do-we-group-the-identifiers">Classifiers:  <em>How Do We Group the Identifiers?</em></a></li>
<li><a class="reference internal" href="#task-rewriting-what-should-be-changed">Task Rewriting:  <em>What Should Be Changed?</em></a></li>
<li><a class="reference internal" href="#limits-what-are-the-restrictions">Limits:  <em>What Are the Restrictions?</em></a><ul>
<li><a class="reference internal" href="#limit-types">Limit Types</a><ul>
<li><a class="reference internal" href="#jq-use-a-jq-script-to-make-a-pass-fail-decision"><tt class="docutils literal"><span class="pre">jq</span></tt> - Use a jq Script to Make a Pass/Fail Decision</a></li>
<li><a class="reference internal" href="#pass-fail-explicitly-pass-or-fail"><tt class="docutils literal"><span class="pre">pass-fail</span></tt> - Explicitly Pass or Fail</a></li>
<li><a class="reference internal" href="#run-daterange-check-run-times-against-a-range"><tt class="docutils literal"><span class="pre">run-daterange</span></tt> - Check Run Times Against a Range</a></li>
<li><a class="reference internal" href="#run-schedule-check-attributes-of-the-run-time"><tt class="docutils literal"><span class="pre">run-schedule</span></tt> - Check Attributes of the Run Time</a></li>
<li><a class="reference internal" href="#test-type-check-test-type"><tt class="docutils literal"><span class="pre">test-type</span></tt> - Check Test Type</a></li>
<li><a class="reference internal" href="#url-fetch-get-a-decision-by-fetching-a-url"><tt class="docutils literal"><span class="pre">url-fetch</span></tt> - Get a decision by fetching a URL</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#applications-to-whom-do-we-apply-the-limits">Applications: <em>To Whom do We Apply the Limits?</em></a><ul>
<li><a class="reference internal" href="#applying-limit-requirements">Applying Limit Requirements</a></li>
</ul>
</li>
<li><a class="reference internal" href="#priorities-which-runs-happen-and-which-do-not">Priorities: <em>Which Runs Happen and Which Do Not?</em></a><ul>
<li><a class="reference internal" href="#the-priority-script">The Priority Script</a></li>
</ul>
</li>
<li><a class="reference internal" href="#checking-limit-configuration-files-for-validity">Checking Limit Configuration Files for Validity</a></li>
<li><a class="reference internal" href="#standard-objects">Standard Objects</a><ul>
<li><a class="reference internal" href="#stringmatch-string-matching-specification"><tt class="docutils literal"><span class="pre">StringMatch</span></tt> - String Matching Specification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#limit-parameter-types">Limit Parameter Types</a><ul>
<li><a class="reference internal" href="#boolean-compares-boolean-values"><tt class="docutils literal"><span class="pre">Boolean</span></tt> - Compares Boolean Values</a></li>
<li><a class="reference internal" href="#cardinal-compares-one-based-integers"><tt class="docutils literal"><span class="pre">Cardinal</span></tt> - Compares One-Based Integers</a></li>
<li><a class="reference internal" href="#cardinallist-compares-a-list-of-one-based-integers"><tt class="docutils literal"><span class="pre">CardinalList</span></tt> - Compares a List of One-Based Integers</a></li>
<li><a class="reference internal" href="#cardinalzero-compares-zero-based-integers"><tt class="docutils literal"><span class="pre">CardinalZero</span></tt> - Compares Zero-Based Integers</a></li>
<li><a class="reference internal" href="#cardinalzerolist-compares-a-list-of-zero-based-integers"><tt class="docutils literal"><span class="pre">CardinalZeroList</span></tt> - Compares a List of Zero-Based Integers</a></li>
<li><a class="reference internal" href="#duration-compares-iso-8601-durations"><tt class="docutils literal"><span class="pre">Duration</span></tt> - Compares ISO 8601 Durations</a></li>
<li><a class="reference internal" href="#sinumber-compares-ranges-of-integers-with-si-units"><tt class="docutils literal"><span class="pre">SINumber</span></tt> - Compares Ranges of Integers with SI Units</a></li>
<li><a class="reference internal" href="#ipversion-compares-internet-protocol-versions"><tt class="docutils literal"><span class="pre">IPVersion</span></tt> - Compares Internet Protocol Versions</a></li>
<li><a class="reference internal" href="#ipversionlist-compares-a-list-of-ip-protocol-versions"><tt class="docutils literal"><span class="pre">IPVersionList</span></tt> - Compares a List of IP Protocol Versions</a></li>
<li><a class="reference internal" href="#probability-compares-ranges-of-decimal-probabilities"><tt class="docutils literal"><span class="pre">Probability</span></tt> - Compares Ranges of Decimal Probabilities</a></li>
<li><a class="reference internal" href="#string-compares-strings"><tt class="docutils literal"><span class="pre">String</span></tt> - Compares Strings</a></li>
</ul>
</li>
</ul>
</li>
</ul>

                <ul>
                  <li>
                  <a href="config_pscheduler.html">Previous topic</a>
                  <ul><li><a href="config_pscheduler.html" title="previous chapter">Configuring pScheduler</a></li></ul>
                  </li>
                </ul>
                  <ul>
                      <li>
                      <a href="config_owamp.html">Next topic</a>
                      <ul><li><a href="config_owamp.html" title="next chapter">OWAMP Server Configuration File</a></li></ul>
                      </li>
                  </ul>
                
                
            </nav>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="config_owamp.html" title="OWAMP Server Configuration File"
             >next</a> |</li>
        <li class="right" >
          <a href="config_pscheduler.html" title="Configuring pScheduler"
             >previous</a> |</li>
        <li><a href="index.html">perfSONAR Toolkit 5.0.0b1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <footer id="fat">
        <div class="footerContents">
            <nav id="fatFooterNav" class="fatFooterNav">
                <ul id="menu-partners" class="menu depth-0">
                    <li id="footer-partner-text" class="partner-menu">
                        perfSONAR 
                        <br>
                        partners 
                        <br>
                        include: 
                    </li>
    
                <li id="footer-partner-esnet" class="partner-menu">
                    <a href="http://www.es.net/" title="Visit DOE's Energy Sciences Network"><img src="_static/ESnet-ps.png" alt="" style="border:none;"></a> </li>
                
                <li id="footer-partner-geant" class="partner-menu">
                    <a href="http://www.geant.org/" title="Visit GEANT"><img src="_static/geant-ps.png" alt="" style="border:none;"/></a> </li>
        
                <li id="footer-partner-iu" class="partner-menu">
                    <a href="http://www.iu.edu/" title="Visit Indiana University"><img src="_static/IU-ps.png" alt="" style="border:none;"></a> </li>

                <li id="footer-partner-i2" class="partner-menu">
                    <a href="http://www.internet2.edu/" title="Visit Internet2"><img src="_static/I2-ps.png" alt="" style="border:none;"></a> </li>
					
				<li id="footer-partner-rnp" class="partner-menu">
                    <a href="https://www.rnp.br/en" title="Visit RNP"><img src="_static/rnp.png" alt="" style="border:none;"></a> </li>
                
                <li id="footer-partner-um" class="partner-menu">
                    <a href="http://www.umich.edu/" title="Visit University of Michigan"><img src="_static/UM-ps.png" alt="" style="border:none;"></a> </li>

                </ul>

            </nav>
            <nav id="minFooterNav" class="minFooterNav">
                <span class="copyright">PERFormance Service Oriented Network monitoring ARchitecture </span>
            </nav>
          
        </div> <!-- /footerContents -->
    </footer>
    
    <div class="footer">
        &copy; Copyright 2023, perfSONAR Project.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>perfSONAR FAQ &mdash; perfSONAR Toolkit 4.0rc3 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/perfsonar.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '4.0rc3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="perfSONAR Toolkit 4.0rc3 documentation" href="index.html" />
    <link rel="next" title="perfSONAR Client Tools" href="client_tools.html" />
    <link rel="prev" title="Troubleshooting perfSONAR 4.0" href="troubleshooting_overview.html" /> 
  </head>
  <body>
    <header>
        <div class="headerContents">
          <a href="index.html" border="0"><img src="_static/perfSONAR-header.gif"></a>
          <div class="acctSearchContainer">
              <section id="searchBox" class="searchBox">
                  <!--Use of this code assumes agreement with the Google Custom Search Terms of Service. -->
                  <!--The terms of service are available at http://www.google.com/cse/docs/tos.html -->
                  <form action="search.html" id="cse-search-box" method="get">
                    <input type="text" name="q" size="25" class="searchInput" placeholder="Search"/>
                    <input type="hidden" name="check_keywords" value="yes" />
                    <input type="hidden" name="area" value="default" />
                  </form>
              </section>
         </div>
        </div>
    </header>
    <div style="display:block;clear:both;">
    
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="client_tools.html" title="perfSONAR Client Tools"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="troubleshooting_overview.html" title="Troubleshooting perfSONAR 4.0"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">perfSONAR Toolkit 4.0rc3 documentation</a> &raquo;</li> 
      </ul>
    </div>
    </div>
    
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="perfsonar-faq">
<h1>perfSONAR FAQ<a class="headerlink" href="#perfsonar-faq" title="Permalink to this headline">¶</a></h1>
<p>(page very under construction!)</p>
<p>Here are the FAQ items from www.perfsonar.net. These need to be formatted and reorganized. Note that most of the links did not copy over.</p>
<p>categories should include:</p>
<blockquote>
<div><ul class="simple">
<li>tool questions</li>
<li>host admin questions</li>
<li>installation questions</li>
<li>perfSONAR project questions</li>
<li>etc.</li>
</ul>
</div></blockquote>
<p><em>Q: How do I join the perfSONAR Collaboration?</em></p>
<p>A: Please contact us at <a class="reference external" href="mailto:perfsonar-lead&#37;&#52;&#48;internet2&#46;edu">perfsonar-lead<span>&#64;</span>internet2<span>&#46;</span>edu</a>.</p>
<p><em>Q: Where can I ask questions or report bugs?</em></p>
<p>A: For questions, send email to perfsonar-user at internet2 dot edu. You may also join the mailing list by visiting <a class="reference external" href="https://lists.internet2.edu/sympa/info/perfsonar-user">https://lists.internet2.edu/sympa/info/perfsonar-user</a>. For bugs, report at <a class="reference external" href="https://github.com/perfsonar/project/issues">https://github.com/perfsonar/project/issues</a>.</p>
<p><em>Q: What is pscheduler, and how do I use it?</em></p>
<p><em>Q: What is BWCTL, and how do I use it?</em></p>
<p>A: BWCTL is... For more info see: ....</p>
<p><em>Q: What is OWAMP, and how do I use it?</em></p>
<p>A: OWAMP (One-Way Ping) is a client server program that was developed to provide delay and jitter measurements between two target computers. At boot time, the perfSONAR Toolkit starts an OWAMP server process and leaves it listening on TCP port 861. This server may then be used by remote clients. Additionally, perfSONAR includes an OWAMP client application that can be used to test to remote instances. For more info see XXX</p>
<p><em>Q: Can I Use a Firewall?</em></p>
<p>A: Please see <a class="reference external" href="http://www.perfsonar.net/deploy/security-considerations/">http://www.perfsonar.net/deploy/security-considerations/</a> page on the perfSONAR website, that discusses firewall use.</p>
<p><em>Q: What should I enter for the *Communities</em> section of my <em>Administrative Information</em> configuration?*</p>
<p>A: The goal of <em>communities</em> is to associate some loosely coupled labels to the data that the perfSONAR Toolkit disk will be making available to the larger world. Think of this step similar to assigning labels to photos or music. Some examples of valid answers are:</p>
<ul class="simple">
<li>Internet2 - The data made available somehow connects the Internet2 backbone</li>
<li>LHC (CMS, ATLAS, etc.) - The disk is part of the LHC deployment structure</li>
<li>eVLBI - The disk is a part of the larger telescope community</li>
<li>MAX - A connector of member of the MAX gigapop</li>
<li>DOE-SC-LAB - US Department of Energy Office of Science Labs</li>
</ul>
<p>Use as many community names as necessary to properly categorize the data from the installation.</p>
<p><em>Q: I do not think I am a member of a community, should I put anything?</em></p>
<p>A: Communities are not required, but they allow other individuals and organizations to find and use your services. It is a good practice to join as many as you may think are applicable.</p>
<p><em>Q: What are the hardware requirements for running the perfSONAR Toolkit?</em></p>
<p>A: See this page XXX. Note that the perfSONAR Toolkit development team has not created hard minimum or maximum requirements - the perfSONAR Toolkit will function on almost any form of hardware. Performance considerations do favor meeting or exceeding the minimum guidelines.</p>
<p><em>Q: Does my machine have to meet the System Requirements?</em></p>
<p>A: There is nothing on the perfSONAR Toolkit that will prevent systems that do not meet the requirements from starting. Erroneous or inaccurate behavior is possible if the hardware cannot support the measurement tools.</p>
<p><em>Q: The Services screen shows many services in the non-running state when first started, what is wrong?</em></p>
<p>A: Services should start right away. It may be an indication of an installation problem. See <a class="reference internal" href="manage_logs.html"><em>Reading Log Files</em></a> for information on where to look for more information.</p>
<p><em>Q: I do not see my service in the Directory Of Services, where is it?</em></p>
<p>A: Much like DNS, the information that will populate the Lookup Service will take time to propagate. Please allow some time (e.g. a few hours) before your service will be fully visible.</p>
<p><em>Q: What is the purpose of pscheduler limits?</em></p>
<p>A: These allow you to limit the influence that outside users have on your system performance. For example, to prevent your machine/network from being saturated with BWCTL tests, limit the duration and maximum bandwidth available.</p>
<p><em>Q: How can I set limits to prevent others from overusing pScheduler/BWCTL/OWAMP?</em></p>
<p>A: pScheduler, BWCTL and OWAMP have configurable files that allows the administrator to limit the resources consumed. See XXX for more information</p>
<p><em>Q: How many NTP servers do I need, can I select them all?</em></p>
<p>A: It is recommended that 4 to 5 close and active servers be used. The Select Closest Servers button will help with this decision. Note that some servers may not be available due to routing (e.g. non-R&amp;E networks vs R&amp;E networks - a common problem for Internet2 and ESnet servers).</p>
<p><em>Q:Can I boot from a USB key instead of a DVD?</em></p>
<p>A: The perfSONAR Toolkit Netinstall and Fullinstall images are capable of being installed on a USB stick instead of a CD. To write these images to the media, we recommend using dd:</p>
<p>sudo dd if=pS-Performance_Toolkit-4.0-FullInstall-x86_64.iso of=/dev/disk3</p>
<p><em>Q: A CVE announcement was made for the current perfSONAR Toolkit Kernel, what do I do?</em></p>
<p>A: The perfSONAR development effort subscribes to all major outlets that will announce kernel CVEs. In the event that a CVE is announce that directly effects operation of the pS Performance Toolit, the following steps will take place:</p>
<ul class="simple">
<li>Announcements regarding the CVE will be posted to the perfsonar-user and perfsonar-announce mailing lists, more information on the mailing lists can be found here: <a class="reference external" href="https://lists.internet2.edu/sympa/info/perfsonar-user">https://lists.internet2.edu/sympa/info/perfsonar-user</a> and <a class="reference external" href="https://lists.internet2.edu/sympa/info/perfsonar-announce">https://lists.internet2.edu/sympa/info/perfsonar-announce</a></li>
<li>A timeline will be relayed regarding availability of new kernels.</li>
<li>The CentOS project will make the patched kernel available first, and it will be available through the yum repositories on the toolkit before the perfSONAR project is able to apply the web100 patches.</li>
<li>It is strongly suggested that perfSONAR Toolkit users utilizing the NetInstall option upgrade immediately.</li>
</ul>
<p>Run the following command: sudo yum update</p>
<p><em>Q: During the NetInstall, I see errors about a corrupt file being downloaded. What should I do?</em></p>
<p>A: During the NetInstall, you may see some errors about a corrupt file being downloaded along with buttons like Reboot and Retry. This happens if it fails to download an RPM from a mirror, which can happen for numerous reasons. Usually, that error can be solved by hitting Retry. You may have to hit that multiple times depending on which mirrors the install is trying to download the RPM from.</p>
<p><em>Q: How do I change the MTU for a device?</em></p>
<p>A: Changing the MTU on your perfSONAR host should only be done if the underlying network supports the chosen size. Please work with your local network staff before making this change on any host.
You can view the MTU of your network devices by executing the /sbin/ifconfig command.
To temporarily change the MTU for a device, you use the ifconfig command and specify the device and the new MTU. For example: ifconfig eth0 mtu 9000 up</p>
<p>To make these changes permanent you need to modify the specific devices configuration file. These files are in /etc/sysconfig/network-scripts/ and have names like ifcfg-eth0 for the device eth0 and ifcfg-eth1 for eth1.</p>
<p>For example you could add the line MTU=&#8221;9000&#8221; for IPv4 or IPV6_MTU=&#8221;9000&#8221; for IPv6 to /etc/sysconfig/network-scripts/ifcfg-eth0.
After making the changes you need to restart the network services by running the command &#8216;service network restart&#8217; as root.</p>
<p><em>Q: How do I change the SSL certificate used by the web server?</em></p>
<p>A: The toolkit by default generates a self-signed SSL certificate that it configures for use with the Apache web server. Some users may desire to replace this certificate with a certificate signed by a certificate authority (CA).</p>
<p>You may also need to replace the certificate due to a problem sometimes encountered with browsers not accepting the self-signed certificate. You may see an error like the following:</p>
<blockquote>
<div>HOST uses an invalid security certificate.
The certificate is not trusted because it is self-signed.
The certificate is only valid for localhost.localdomain
(Error code: sec_error_untrusted_issuer)</div></blockquote>
<p>You can find instructions for installing a new certificate in Apache here.</p>
<p><em>Q: I forgot to enable IPv6 in CentOS when I installed the toolkit. How do I enable it?</em></p>
<p>A: It is recommended that you always enable IPv6 during the CentOS installation portion of the toolkit setup. If you did not enable it, then you can do so with the following steps:</p>
<p>Login to the toolkit as a user capable of running sudo
Run sudo and enter your sudo password
Open the file /etc/modprobe.conf in a text editor and remove the following lines:
alias net-pf-10 off
alias ipv6 off
options ipv6 disable=1
Restart the host
You can now assign an IPv6 address.</p>
<p><em>Q: Why is the static IPv6 address I assigned during the net-install process not configured when my host starts-up?</em></p>
<p>A: When you perform the net-install of the toolkit, you will be prompted twice to enter networking information by CentOS. The first time is to define the networking to be used for downloading required packages. The second prompt is later in the installation and defines what will be configured on the host post-installation. It is a known CentOS behavior that IPv6 information entered at the first prompt is not automatically filled-in at the second prompt. This can be confusing because the IPv4 information does get automatically filled-in. If you do not manually enter the IPv6 information a second time, then your host will not have the address configured post-installation. You will have to manually assign the address if this happens.</p>
<p><em>Q: The drivers that are included for my &#8220;foo&#8221; network card old, what should I do?</em></p>
<p>A: The perfSONAR Toolkit includes drivers from the upstream CentOS distribution and a very limited number of specially built drivers for cards that are known to be widely used (e.g. myicom). If you notice that there is a newer driver available than what the perfSONAR Toolkit provides you can do the following:
Download the source or RPM from the manufacturers web site, build on your perfSONAR Toolkit
If you are running a netinstall version of the perfSONAR Toolkit, run modprobe after installation to load the new version
If you are running a LiveCD, you will need to modify the local init.d script to force modprobe on each reboot to load the proper version</p>
<p><em>Q: Where can I find more resources regarding timekeeping for VMWare Virtual Machines?</em></p>
<p>A: VMWare has two resources worth reading:</p>
<ul class="simple">
<li>Timekeeping In Virtual Machines</li>
<li>Timekeeping best practices for Linux guests</li>
</ul>
<p><em>Q: What TCP congestion control algorithm is used by the perfSONAR Toolkit?</em></p>
<p>A: The perfSONAR toolkit uses the CentOS or Debian default TCP congestion control algorithm, which is htcp.</p>
<p><em>Q: Where are the relevant logs for perfSONAR services?</em></p>
<p>A: Please see <a class="reference internal" href="manage_logs.html"><em>Reading Log Files</em></a> for more information.</p>
<p><em>Q: Is it possible to change the default port for tool X?</em></p>
<p>A: The measurement servers use 2 kinds of ports:</p>
<ul class="simple">
<li>Contact ports, e.g. a well known location to contact the daemon to initiate a test</li>
<li>Test ports, e.g. negotiated ports to flow test or control traffic when a test is requested</li>
</ul>
<p>Test ports are easily configured to run on a specific set of ports, and can be configured to be opened in a site firewall. The daemon is often able to negotiate these at run time. The contact port is well known, and because of that should never be changed to a different value. Doing so severely impacts the ability of the tool to interoperate on a global scale.</p>
<p>As an example, the OWAMP server listens on the registered port 861 (see <a class="reference external" href="http://tools.ietf.org/search/rfc4656">http://tools.ietf.org/search/rfc4656</a> section 2). This is the standard port for the application, in the same way that port 80 is the standard port for an HTTP server. While one can run a web server on a port other than 80, it makes the web server less useful because it&#8217;s not a standard config. The same is true for OWAMP. The OWAMP protocol is standardized, and has a well-known port - port 861 - associated with it. Running the OWAMP daemon on a non-standard port introduces significant interoperability challenges between deployments.</p>
<p>If you&#8217;re going to run a measurement infrastructure inside your own organization, you are of course free to do whatever you want. If you want to integrate with the rest of the world, the measurement tools should be run on the standard port to ensure interoperability.</p>
<p><em>Q: Why doesn&#8217;t the perfSONAR toolkit include the most recent version of vendor X’s driver?</em></p>
<p>A: We only support the default CentOS device drivers on the toolkit. However, several groups have reported 10% performance improvements using the latest driver from Myricom. If you want to update your toolkit host to the latest version of the Myricom driver, follow the instructions here</p>
<p><em>Q: Can I configure yum to exclude kernel packages from it&#8217;s update procedure?</em></p>
<p>A: A detailed explanation of yum configuration can be found in the RHEL documents: <a class="reference external" href="https://access.redhat.com/site/solutions/10185">https://access.redhat.com/site/solutions/10185</a>. There are two ways to exclude kernel packages from a yum update, the first solution can be invoked on the command line:</p>
<p>yum update &#8211;exclude=kernel*</p>
<p>To make permanent changes, edit the /etc/yum.conf file and following entries to it:</p>
<p>[main]
cachedir=/var/cache/yum/$basearch/$releasever
keepcache=0
debuglevel=2
logfile=/var/log/yum.log
exclude=kernel* samba*                           &lt;====</p>
<p>NOTE: If there are multiple package to be excluded then separate them using a single space or comma.</p>
<p><em>Q: How can I configure yum to automatically update the system?</em></p>
<p>A: Note that as of version 3.4, this is enabled by default. See this more for more detail: <a class="reference internal" href="manage_update.html#manage-update-auto"><em>Automatic Updates</em></a></p>
<p><em>Q: When attempting to use BWCTL with an IPv6 address, the command fails: bwctl: Unable to connect to 2001:468:1:11::16:66:4823. What should I do?</em></p>
<p>A: Wrap the IPv6 address in square brackets and double quotes (to prevent the shell from trying to interpret the brackets). For example: bwctl -T iperf3 -t 10 -i 1-c &#8220;[2001:468:1:11::16:66]:4823&#8221;</p>
<p><em>Q: My host was impacted by Shellshock/Heartbleed/etc., what should I do?</em></p>
<p>A: Please check the vulnerability archive for the specific attack you interested in, information on mitigation for perfSONAR nodes will be posted there, or in the mailing list archives.</p>
<p><em>Q: I would like to install and patch perfsonar boxes behind a web proxy, is it possible to specify this on the grub command line?</em></p>
<p>A: Anaconda documentation indicates this grub parameter should do the trick:</p>
<p>proxy=[protocol://][username[:password]&#64;]host[:port]</p>
<p>Note that during a fresh network installation, Anaconda does install updates immediately (e.g. it wouldn&#8217;t use a version of an RPM from when the ISO was built), and doesn&#8217;t actually run any network services before the reboot. For those that are rebuilding after shellshock - using a proxy should not be necessary.</p>
<p><em>Q: How can I add custom rules to IPTables?</em></p>
<p>A: See <a class="reference internal" href="manage_security.html#manage-security-custom"><em>Adding Your Own Firewall Rules</em></a></p>
<p><em>Q: How can I force testing over IPv4 or IPv6 in the mesh configuration?</em></p>
<p>A: There is both a ipv4_only and ipv6_only option you can set in the test parameters of a mesh config. Setting them both at the same time gives an error.</p>
<p><em>Q: When trying a clean install with perfSONAR Toolkit, the system doesn&#8217;t recognize any disks/doesn&#8217;t see my RAID controller. Things work with other systems (CentOS 6, Scientific Linux 6). What should I do?</em></p>
<p>A: If you have started with a different OS, you can attempt to install the necessary packages manually.
First, install the EPEL repository. You can grab the RPM from <a class="reference external" href="http://linux.mirrors.es.net/fedora-epel/6/i386/repoview/epel-release.html">http://linux.mirrors.es.net/fedora-epel/6/i386/repoview/epel-release.html</a>.
After that, you’ll need to install the Internet2 repository. You can grab the RPM from <a class="reference external" href="http://software.internet2.edu/rpms/el6/x86_64/main/RPMS/Internet2-repo-0.5-3.noarch.rpm">http://software.internet2.edu/rpms/el6/x86_64/main/RPMS/Internet2-repo-0.5-3.noarch.rpm</a>
.
Lastly, you can install the Toolkit by running:
yum install perl-perfSONAR_PS-Toolkit perl-perfSONAR_PS-Toolkit-SystemEnvironment
Once it’s installed, reboot the machine.
Alternatively, if you are upgrading from a LiveCD, use &#8216;dban&#8217; to wipe out the data partition placed there from previous use.</p>
<p><em>Q: Which repository addresses will be used to get updates to the perfSONAR software?</em></p>
<p>A: By default, the Internet2 repo points at a mirror list hosted by software.internet2.edu. In this mirror list is linux.mirrors.es.net. In order to use the default configuration you will need to allow access to software.internet2.edu so you can grab the mirrorlist. After that, the packages can be downloaded from any of the sites listed which includes linux.mirrors.es.net, software.internet2.edu, and a few other places. You should be able to get away with just opening up access to software.internet2.edu (so it can get the mirror list) and linux.mirrors.es.net (so you can get the packages). Those should be the only places you need as linux.mirrors.es.net also has a mirror for all the base CentOS packages.
The initial version of 3.4 contained a pointer to another repo only hosted on datstax.com, but this was dropped for release 3.4.1 and later. If you do encounter this repo you can safely run a &#8216;yum remove datastax-repo&#8217; as the packages it provides have been copied to the Internet2 repo.</p>
<p><em>Q: I see that the latency/loss tests in 3.4 use bwping. Does this mean that we can run both throughput and latency/loss tests on the same interface without interference due to the way bwctl scheduling works?</em></p>
<p>A: Ping tests can be scheduled on the same host as throughput tests, but owamp tests can’t currently (they use powstream instead of bwping).</p>
<p><em>Q: Where can I find documentation on interacting with perfSONAR via a custom client?</em></p>
<p>A: There is a web page which outlines the REST API: <a class="reference external" href="http://software.es.net/esmond/perfsonar_client_rest.html">http://software.es.net/esmond/perfsonar_client_rest.html</a>, the perl API: <a class="reference external" href="http://software.es.net/esmond/perfsonar_client_perl.html">http://software.es.net/esmond/perfsonar_client_perl.html</a> and the python API: <a class="reference external" href="http://software.es.net/esmond/perfsonar_client_python.html">http://software.es.net/esmond/perfsonar_client_python.html</a>.</p>
<p><em>Q: When setting up a dual homed host, how can one get individual tests to use one interface or another?</em></p>
<p>A: In the GUI when configuring the regular tests, you configure the interface that the tests will be performed using.
The easiest way to force bwctld and owampd to listen only on their respective interfaces is to set the ‘srcnode’ variable in /etc/bwctld/bwctld.conf and /etc/owampd/owampd.conf, and then restart bwctld and owampd. Look at owampd.conf.default and bwctld.conf.default in those same directories for an example.
<a class="reference external" href="http://docs.perfsonar.net/manage_dual_xface.html">http://docs.perfsonar.net/manage_dual_xface.html</a></p>
<p><em>Q: Which licenses do perfSONAR products use?</em></p>
<p>A: perfSONAR components are licensed under the Apache 2.0 license.</p>
<p><em>Q: When attempting to publish data to esmond, a &#8220;301 MOVED PERMANENTLY&#8221; is returned. What should I do?</em></p>
<p>A: If using the examples from:
<a class="reference external" href="http://software.es.net/esmond/perfsonar_client_rest.html">http://software.es.net/esmond/perfsonar_client_rest.html</a>
<a class="reference external" href="http://software.es.net/esmond/perfsonar_client_perl.html">http://software.es.net/esmond/perfsonar_client_perl.html</a>
When querying the local esmond instance, the following could be returned:
HTTP/1.1 301 MOVED PERMANENTLY
Date: Sat, 18 Apr 2015 01:05:19 GMT
Server: Apache/2.2.15 (CentOS)
Location: <a class="reference external" href="http://localhost/esmond/perfsonar/archive/">http://localhost/esmond/perfsonar/archive/</a>
Content-Length: 0
Connection: close
Content-Type: text/html; charset=utf-8
Check the script and make sure the URL is:
<a class="reference external" href="http://localhost/esmond/perfsonar/archive/">http://localhost/esmond/perfsonar/archive/</a>
and not
<a class="reference external" href="http://localhost/esmond/perfsonar/archive">http://localhost/esmond/perfsonar/archive</a></p>
<p><em>Q: Is it possible to use non-intel SFP+ optics in the Intel X520-SR2 NIC?</em></p>
<p>A: The ixgbe driver has an option to allow alternative optics:
allow_unsupported_sfp=1
This can be tested using the fillow commands:
sudo modprobe -r ixgbe
sudo modprobe ixgbe allow_unsupported_sfp=0</p>
<p><em>Q: How can I clean up the data in my esmond instance?</em></p>
<p>A: Information on this can be found here: <a class="reference internal" href="multi_ma_backups.html#multi-ma-backups-delete"><em>Deleting Old Data</em></a>.</p>
<p><em>Q: How can I backup the data in my esmond instance?</em></p>
<p>A: Information on this can be found here: <a class="reference external" href="http://docs.datastax.com/en/cassandra/2.0/cassandra/operations/ops_backup_restore_c.html">http://docs.datastax.com/en/cassandra/2.0/cassandra/operations/ops_backup_restore_c.html</a></p>
<p>Additionally, to back up perfSONAR data from an MA see guidance on this page: <a class="reference internal" href="multi_ma_backups.html"><em>Managing Measurement Archive Data</em></a>.
Note that some steps may destroy data.</p>
<p>For PostgreSQL: <em>This will delete any existing data and replace it with the backup</em>
For Cassandra and nodetool, It also overwrites existing data (via <a class="reference external" href="https://specs.openstack.org/openstack/trove-specs/specs/liberty/cassandra-backup-restore.html">https://specs.openstack.org/openstack/trove-specs/specs/liberty/cassandra-backup-restore.html</a>):
A snapshot can be restored by moving all *.db files from a snapshot directory to the respective keyspace overwriting any existing files.</p>
<p><em>Q: How do I backup a perfSONAR instance or migrate the configuration and data to a new machine?</em></p>
<p>A: To back up perfSONAR configurations and logs:</p>
<div class="highlight-python"><div class="highlight"><pre>/opt/perfsonar_ps/ls_registration_daemon/etc/*
/opt/perfsonar_ps/mesh_config/etc/*
/opt/perfsonar_ps/regular_testing/etc/*
/opt/perfsonar_ps/toolkit/etc/*
/opt/perfsonar_ps/traceroute_ma/etc/*
/opt/perfsonar_ps/serviceTest/etc/*
/opt/perfsonar_ps/snmp_ma/etc/*
/opt/esmond/*
/etc/httpd/conf.d/apache-toolkit_web_gui.conf
/etc/owampd/*
/etc/bwctld/*
/etc/cassandra/*
/var/lib/pgsql/*
/var/lib/cassandra/*
/var/lib/perfsonar/*
/var/log/perfsonar/*
</pre></div>
</div>
<p>To back up perfSONAR data, see guidance on this page: <a class="reference external" href="http://docs.perfsonar.net/multi_ma_backups.html">http://docs.perfsonar.net/multi_ma_backups.html</a>.</p>
<p><em>Q: How can I tune a Dell server for a high throughput and low latency?</em></p>
<p>A: Dell offers a guide on tuning: <a class="reference external" href="http://i.dell.com/sites/content/shared-content/data-sheets/en/Documents/configuring-low-latency-environments-on-dell-poweredge-12g-servers.pdf">http://i.dell.com/sites/content/shared-content/data-sheets/en/Documents/configuring-low-latency-environments-on-dell-poweredge-12g-servers.pdf</a>.</p>
<p><em>Q: How do I disable global registration?</em></p>
<p>A: The following commands will stop, and disable, this service:
/sbin/service ls_registration_daemon stop
chkconfig ls_registration_daemon off</p>
<p><em>Q: I have a measurement archive machine with esmond running, and there is a separate disk partition mounted on the machine where I want to store all the incoming measurement data from measurement points. What is the proper way to change the default directory location for storing the measurement archive data?</em></p>
<p>A: Change the directory where cassandra and postgres store data. This is controlled through the respective tools configuration files and not esmond directly.
For cassandra, in /etc/cassandra/conf/cassandra.yaml change the commitlog_directory, data_file_directories and saved_caches_directory to the new locations you desire. Restart cassandra: /sbin/service cassandra restart
For postgres, in /var/lib/pgsql/data/postgresql.conf change the data_directory to the new location. Restart postgres: /etc/init.d postgresql restart. You will need to rebuild the esmond tables after this change is made. To do so, follow the instructions here: <a class="reference external" href="http://software.es.net/esmond/rpm_install.html#configuration">http://software.es.net/esmond/rpm_install.html#configuration</a>
An alternative way to do what you want is to stop both postgres and cassandra, move /var/lib/cassandra and /var/lib/pgsql to the new partition and then create symlinks to the new location in /var/lib/cassandra and /var/lib/pgsql. That saves the need to rebuild postgres and preserves any existing data.</p>
<p><em>Q: How can I nuke all of the data in esmond, and start from scratch?</em></p>
<p>A: Note, many of these commands should be done as root, and will destroy existing data and metadata collections. An additional step to load the esmond key into a regular testing file may be required (read output of tools to know for sure):
/etc/init.d/postgresql stop
rm -rf /var/lib/pgsql/data/*
/sbin/service postgresql initdb
/sbin/service postgresql start
wait about 20 seconds
sudo -u postgres psql -c &#8220;CREATE USER esmond WITH PASSWORD &#8216;7hc4m1&#8217;&#8221;
sudo -u postgres psql -c &#8220;CREATE DATABASE esmond&#8221;
sudo -u postgres psql -c &#8220;GRANT ALL ON DATABASE esmond to esmond&#8221;
cp -f /opt/perfsonar_ps/toolkit/etc/default_service_configs/pg_hba.conf /var/lib/pgsql/data/pg_hba.conf
/sbin/service postgresql restart
sed -i &#8220;s/sql_db_name = .*/sql_db_name = esmond/g&#8221; /opt/esmond/esmond.conf
sed -i &#8220;s/sql_db_user = .*/sql_db_user = esmond/g&#8221; /opt/esmond/esmond.conf
sed -i &#8220;s/sql_db_password = .*/sql_db_password = 7hc4m1/g&#8221; /opt/esmond/esmond.conf
/opt/perfsonar_ps/toolkit/scripts/system_environment/configure_esmond</p>
<p><em>Q: I am running a small node, and seeing a lot of IO. What is going on?</em></p>
<p>A: Some users report abnormalities on their small nodes related to I/O activity (e.g. iostat reports long w_await times - sometimes measured in multiple seconds). These coincide with intervals of testing, in particular related to OWAMP.
Deeper investigation found that there is too much I/O going on: syslogd and systemd-journald processing syslog messages from &#8220;owampd, bwctld, and powstream” in “/var/log/messages”, sometimes up to 30-40 syslog messages per second depending on the testing configuration of a host. Given that small nodes are based on flash memory, changes should be made to ensure a more balanced approach to logging:
Do journaling on memory by editing “/etc/systemd/journald.conf”.
Make option &#8220;Storage=volatile” instead of the default “Storage=auto”. Make sure to limit the maximum usage of memory for journaling. You can do this by fiddling with “RuntimeKeepFree” and “RuntimeMaxUse” options.
Don’t <em>restart</em> the journaling service (i.e., don’t do “systemctl restart systemd-journald”). Do an <em>OS reboot</em> instead.</p>
<p><em>Q: I want to operate a &#8220;Dynamic&#8221; Maddash Mesh with hosts from a lookup service. Where do I start?</em></p>
<p>A: There is information on this method of mesh configuration available at the following link:</p>
<ul class="simple">
<li><a class="reference internal" href="multi_mesh_autoconfig.html"><em>Automatic Test Configuration</em></a></li>
</ul>
<p>The server and agent each have needs regarding the definition of tests, information on each can be found via these links:</p>
<ul class="simple">
<li><a class="reference internal" href="multi_mesh_server_config.html"><em>Publishing a Central Configuration File</em></a></li>
<li><a class="reference internal" href="multi_mesh_agent_config.html"><em>Reading a Central Configuration File</em></a></li>
</ul>
<p><em>Q: How to get rid of &#8220;There isn&#8217;t a perfSONAR sudo user defined&#8221; message?</em></p>
<p><strong>TODO: Changes this to /etc/profile.d, check if its config(noreplace)</strong></p>
<p>A: Either add a non-root user to the pssudo group or remove the line /etc/perfsonar/toolkit/scripts/add_pssudo_user —auto from /root/.bashrc. Note that future updates could revert the /root/.bashrc file.</p>
<p><em>Q: How does version numbering work for the perfSONAR project?</em></p>
<p>A: See <a class="reference external" href="https://github.com/perfsonar/project/wiki/Versioning">https://github.com/perfsonar/project/wiki/Versioning</a> if you are interested in learning about our version numbering scheme.</p>
<p><em>Q: After upgrading to 3.5 my maddash instance won&#8217;t start (e.g. HTTP fails)?</em></p>
<p>A: If after running yum update you see this error:
[<a class="reference external" href="mailto:user&#37;&#52;&#48;host">user<span>&#64;</span>host</a> ~]$ sudo /etc/init.d/httpd start
Starting httpd: Syntax error on line 1 of /etc/httpd/conf.d/apache-esmond.conf:</p>
<div class="highlight-python"><div class="highlight"><pre>Invalid command &#39;WSGIScriptAlias&#39;, perhaps misspelled or defined by a module not included in the server configuration
                                                         [FAILED]
There could be a problem with the version of one of the WSGI libraries that was pulled in. You can verify it as such:
[user@host ~]$ yum list installed | grep -i wsgi
python27-mod_wsgi.x86_64             3.4-12.el6.centos.alt            @scl
Due to the specific version of python that maddash/perfSONAR requires, the workaround is to uninstall the version above, and use the version found in the perfSONAR repository:
[user@host ~]$  sudo yum erase &quot;python27-mod_wsgi*&quot;
[user@host ~]$  sudo yum --disablerepo=&quot;*&quot; --enablerepo=&quot;Internet2&quot; --enablerepo=&quot;base&quot; install esmond
Then restart cassandra, and start httpd
[user@host ~]$  sudo /sbin/service cassandra stop
Shutdown Cassandra: OK
[user@host ~]$  sudo /sbin/service cassandra start
Starting Cassandra: OK
[user@host ~]$  sudo /sbin/service httpd start
Starting httpd: [ OK ]
</pre></div>
</div>
<p><em>Q: What is PTP?</em></p>
<p>A: PTP is the Precision Time Protocol, also known as IEEE 1588, a more-accurate successor to the Network Time Protocol which as been used for many years to discipline the clocks in general-purpose computers. Under ideal conditions, PTP can discipline a clock to within a few microseconds of UTC. Compare this with NTP, which typically has accuracy of about a millisecond when used with clocks on the Internet and 100 microseconds or less when using a stratum-1 clock in a LAN environment.</p>
<p><em>Q: What is required to use PTP in my network?</em></p>
<p>A: Unlike NTP, which provides satisfactory operation using software clients and a pool of servers usually on the Internet, running PTP requires specialized equipment:</p>
<ul class="simple">
<li>Clocks. For production-grade service, PTP requires a minimum of two grandmaster clocks. These are dedicated hardware appliances that use the Global Positioning System to recover accurate time and a high-precision oscillator for holdover during periods when GPS is not available. At this writing, base model clocks cost about US$2,500 each.</li>
<li>Network Infrastructure. PTP requires that all network elements between the grandmaster and slaves be capable of functioning as a boundary clock. This is a feature typically found on high-end routers and switches designed for use in low-latency applications.</li>
<li>Network Interface Cards. Interfaces in the slave system require hardware support for the timestamping that makes PTP work accurately. While software-only PTP clients exist, they may suffer inaccuracies induced by the vagaries of running under a general-purpose operating system and provide inaccurate results when testing latency in a LAN environment.</li>
</ul>
<p><em>Q: Does perfSONAR support PTP?</em></p>
<p>A: Not at this time. The prohibitive cost of deploying PTP makes it unlikely to be used widely enough to merit adding support. The current perfSONAR code contains assumptions that the clock is disciplined by NTP and would need to be modified for other protocols.</p>
<p><em>Q: I am seeing a &#8220;Can&#8217;t locate object method &#8216;ssl_opts&#8217; via package &#8216;LWP::UserAgent&#8217;&#8221; error when trying to use a Central Measurement Archive. What should I do?</em></p>
<p>A: This is due to a pretty old version of perl-libwww-perl is included with CentOS 6. If you remove “ca_certificate_path” from the configuration file things will work.</p>
<p><em>Q: I have a central MA for my perfSONAR data, what happens if the central MA goes down for a while, or the network is unavailable between the beacons and the MA? Are the measurements lost, or are they buffered to be delivered later? Does this have any effect on the timing of subsequent measurements?</em></p>
<p>A: The beacons observe a &#8220;push&#8221; architecture (i.e. the perfsonar node which made a measurement connects to the central MA to store the results) to the central MA.
If the host MA goes down, the missed measurements are stored on local disk under /var/lib/regular_testing and the regular_testing daemon tries to register them when the MA comes back. If the MA is down too long though (where “too long” varies on the system and number of tests being run) the backlog of tests can get too big and regular-testing can’t catch-up. On a Toolkit installation, we actually clean out the backlog of tests for this reason as we have frequently seen hosts get in a state where the backlog of tests is too big.
See also the documentation for this service: <a class="reference external" href="http://docs.perfsonar.net/multi_overview.html">http://docs.perfsonar.net/multi_overview.html</a></p>
<p><em>Q: What if there are multiple MAs used for a central MA architecutre, but only one is down or unreachable, what will happen?</em></p>
<p>A: Each MA will be treated the same as if they were the only MA in the file. In other words, the one that is up will get the data and a backlog will be kept on disk for the one that is down. When the downed MA comes back up the daemon will try to register the old data points.</p>
<p><em>Q: If you have made manual changes to regular_testing.conf to point to a different MA (or multiple MAs), and you subsequently change test configurations through the GUI, does this leave your MA customizations alone?</em></p>
<p>A: Yes. The GUI leaves all measurement_archive blocks alone.</p>
<p><em>Q: How much memory is needed for a host running an MA?</em></p>
<p>A: Cassandra will try to use 4G of memory by default (if its available on the system). It is possible to tweak the memory settings if you want it to use less. Read more here: <a class="reference external" href="http://docs.datastax.com/en/cassandra/2.0/cassandra/operations/ops_tune_jvm_c.html">http://docs.datastax.com/en/cassandra/2.0/cassandra/operations/ops_tune_jvm_c.html</a>. Tuning this makes it possible to run an MA on a host with less memory.</p>
<p><em>Q: I am trying to run perfSONAR on low-cost hardware (e.g. raspberry pi, etc.). Where should I start?</em></p>
<p>A: There are numerous hardware platforms that have emerged that are an attractive option for use in network performance measurement. The perfSONAR collaboration does not recommend, nor support, the use of perfSONAR on low-end, ARM-based hardware such as the Raspberry PI. It has been shown that it is difficult to distinguish network issues, from host issues, on these devices. In particular, we do not recommend these devices for testing throughput with the BWCTL, or other related tools. Use of latency based tools (Ping, OWAMP) is possible provided that an accurate clock source is available.
For more information, see this web page: <a class="reference external" href="http://www.perfsonar.net/deploy/hardware-selection/low-cost-hardware/">http://www.perfsonar.net/deploy/hardware-selection/low-cost-hardware/</a></p>
<p><em>Q: Why do I get such weird results when I test from a 10G connected host to 1G connected host?</em></p>
<p>A: The network interface card on a host is designed to send at line rate as long as there is data being made available via the kernel. This means that a 1G card will send at either 1G, or 0G (it does not pace itself at a rate in between). In situations where a larger capacity machine is testing to a smaller capacity machine, it is inevitable that the 10Gbps stream of data will need to be buffered somewhere in the path: either one of the last hop switches or the device itself. If there is not enough buffering available, the data will be dropped and TCP will be forced to reduce sending rates.</p>
<p>The &#8216;choppy&#8217; behavior can be seen on this page: <a class="reference external" href="http://www.perfsonar.net/deploy/hardware-selection/hardware-advice/">http://www.perfsonar.net/deploy/hardware-selection/hardware-advice/</a>, and is challenging to mitigate unless there is a significant amount of buffer available. For these reasons, it is recommended that when designing testing scenarios, only &#8216;like&#8217; to &#8216;like&#8217; capacities be explored.</p>
<p><em>Q: My perfSONAR results show consistent line-rate performance, but a researcher at my site is reporting really poor performance, what gives?</em></p>
<p>A: perfSONAR is designed to give a &#8220;best case scenario&#8221; test result for end to end testing:
perfSONAR is typically installed on well-provisioned server-class hardware that contains adequate CPU, memory, and NIC support
By default, tuning are applied to the TCP stack: <a class="reference external" href="https://fasterdata.es.net/host-tuning/linux/">https://fasterdata.es.net/host-tuning/linux/</a>
BWCTL invokes &#8220;memory to memory&#8221; test tools, e.g. the host does not pull data off of, or write to, storage during testing
perfSONAR typically runs short single streamed TCP tests.
The user of a network may not have a machine that is as tuned as a perfSONAR node, could be using an application that is incorrect for the job of data movement, and may have a bottleneck due to storage. Consider all of these factors when working with them to identify performance issues. It is often the case that the &#8216;network&#8217; may be working fine, but the host and software infrastructure need additional attention.</p>
<p><em>Q: Is there a way to visualize GridFTP results in Maddash?</em></p>
<p>A: Please see documentation on the maddash web site.</p>
<p><em>Q: How can I configure my toolkit to allow a private IP?</em></p>
<p>A: The file resides at:
/usr/lib/perfsonar/web-ng/etc/web_admin.conf
The config option is allow_internal_addresses. Set it to 1.</p>
<p><em>Q: How do I change the default BWCTL tool?</em></p>
<p>A: The file resides at: /etc/perfsonar/regulartesting.conf</p>
<p><em>Q: Cassandra seems to be using 100% CPU on my system and I can&#8217;t figure out why.</em></p>
<p>A: Cassandra features a nodetool utility that can be used to see what is going on. For instance, if you notice that after you restart cassandra it spends lots of time &#8216;compacting&#8217;, you can view status as such:</p>
<div class="highlight-python"><div class="highlight"><pre>$ nodetool compactionstats
pending tasks: 1
         compaction type        keyspace           table       completed           total      unit  progress
              Compaction          esmondrate_aggregations       140157665      2632220068     bytes     5.32%
Active compaction remaining time :        n/a
</pre></div>
</div>
<p>If after repeated runnings the total progress does not move, cassandra may be having trouble compacting. There may be the following logs in the file:</p>
<div class="highlight-python"><div class="highlight"><pre>INFO [CompactionExecutor:8] 2016-04-02 12:32:18,205 CompactionController.java (line 192) Compacting large row esmond/rate_aggregations:ps:packet_loss_rate:b30f54e8df9549ceb8292278b782f05b:2015 (121215124 bytes) incrementally
INFO [CompactionExecutor:8] 2016-04-03 04:50:45,168 CompactionController.java (line 192) Compacting large row esmond/rate_aggregations:ps:time_error_estimates:b30f54e8df9549ceb8292278b782f05b:2015 (123923983 bytes) incrementally
INFO [CompactionExecutor:8] 2016-04-03 22:06:38,417 CompactionController.java (line 192) Compacting large row esmond/rate_aggregations:ps:packet_loss_rate:76b654c4279241f19898dcdb8cacdfb2:2015 (120871402 bytes) incrementally
</pre></div>
</div>
<p>It may be the case that an exceptionally large data row can&#8217;t be compacted. When the size of the row exceeded 64Mb, Cassandra should try to swap to disk, and that may fail.</p>
<p>It is possible to edit /etc/cassandra/conf/cassandra.yaml and change the &#8220;in_memory_compaction_limit_in_mb&#8221; value up from 64 to 256 and restart cassandra. Once the row or rows in question are compacted, you can change it back and restart again.</p>
<p><em>Q: How do I setup a perfSONAR node to have two interfaces on the same subnet?</em></p>
<p>A: This can be accomplished by setting the following items in sysctl:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">net</span><span class="o">.</span><span class="n">ipv4</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">default</span><span class="o">.</span><span class="n">arp_filter</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">net</span><span class="o">.</span><span class="n">ipv4</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">arp_filter</span> <span class="o">=</span> <span class="mi">2</span>
</pre></div>
</div>
<p>More information available here:
<a class="reference external" href="http://z-issue.com/wp/linux-rhel-6-centos-6-two-nics-in-the-same-subnet-but-secondary-doesnt-ping/">http://z-issue.com/wp/linux-rhel-6-centos-6-two-nics-in-the-same-subnet-but-secondary-doesnt-ping/</a></p>
<p><em>Q:Is there a way to re-image perfSONAR resources remotely?</em></p>
<p>A: If the intention is to use the perfSONAR ISO as the base, the installer just needs view the installation medium like a CD or USB would be mounted.
As for specifics of a mechanism to remotely install, consult the documentation of your server. For instance some services support &#8220;virtual media&#8221; if they contain a DRACs with the enterprise feature set enabled.
For a more general solution, and going on the assumption that a remote console access is available to a servers, consider a package called iPXE. iPXE can do is attach an ISO via iSCSI or HTTP, so all that is needed is to put up a server the remote machines can reach. The commands to do it are:</p>
<div class="highlight-python"><div class="highlight"><pre>set net0/ip 10.9.8.7
set net0/netmask 255.255.255.0
set net0/gateway 10.9.8.1
set dns 10.9.8.2
sanboot http://server.kinber.org/toolkit.iso
</pre></div>
</div>
<p>If there is DHCP available, the four set commands can be removed and a single dhcp command put in their place. Any HTTP server used to serve the ISO must support range requests. The standard Apache on most systems will.
Note that iPXE needs to be on a bootable medium, and it’s operationally better when separate from the disk in the machine. This means that remote locations will need to have something like a USB stick installed. Once in place, set the BIOS to ignore it and boot it explicitly when needed. Since it’s a regular USB device, it can be updated remotely while the main OS is running.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <nav id="channelNav" class="channelNav">
                
                <ul>
<li><a class="reference internal" href="#">perfSONAR FAQ</a></li>
</ul>

                <ul>
                  <li>
                  <a href="troubleshooting_overview.html">Previous topic</a>
                  <ul><li><a href="troubleshooting_overview.html" title="previous chapter">Troubleshooting perfSONAR 4.0</a></li></ul>
                  </li>
                </ul>
                  <ul>
                      <li>
                      <a href="client_tools.html">Next topic</a>
                      <ul><li><a href="client_tools.html" title="next chapter">perfSONAR Client Tools</a></li></ul>
                      </li>
                  </ul>
                
                
            </nav>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="client_tools.html" title="perfSONAR Client Tools"
             >next</a> |</li>
        <li class="right" >
          <a href="troubleshooting_overview.html" title="Troubleshooting perfSONAR 4.0"
             >previous</a> |</li>
        <li><a href="index.html">perfSONAR Toolkit 4.0rc3 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <footer id="fat">
        <div class="footerContents">
            <nav id="fatFooterNav" class="fatFooterNav">
                <ul id="menu-partners" class="menu depth-0">
                    <li id="footer-partner-text" class="partner-menu">
                        perfSONAR 
                        <br>
                        partners 
                        <br>
                        include: 
                    </li>
    
                <li id="footer-partner-esnet" class="partner-menu">
                    <a href="http://www.es.net/" title="Visit DOE's Energy Sciences Network"><img src="_static/ESnet-ps.png" alt="" style="border:none;"></a> </li>
                
                <li id="footer-partner-geant" class="partner-menu">
                    <a href="http://www.geant.org/" title="Visit GEANT"><img src="_static/geant-ps.png" alt="" style="border:none;"/></a> </li>
        
                <li id="footer-partner-iu" class="partner-menu">
                    <a href="http://www.iu.edu/" title="Visit Indiana University"><img src="_static/IU-ps.png" alt="" style="border:none;"></a> </li>

                <li id="footer-partner-i2" class="partner-menu">
                    <a href="http://www.internet2.edu/" title="Visit Internet2"><img src="_static/I2-ps.png" alt="" style="border:none;"></a> </li>
    
                </ul>

             
            </nav>
            <nav id="minFooterNav" class="minFooterNav">
                <span class="copyright">PERFormance Service Oriented Network monitoring ARchitecture </span>
            </nav>
          
        </div> <!-- /footerContents -->
    </footer>
    
    <div class="footer">
        &copy; Copyright 2016, perfSONAR Project.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>
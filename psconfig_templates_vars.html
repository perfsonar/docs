
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>pSConfig Template Variables &#8212; perfSONAR Toolkit 5.2.2 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/perfsonar.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Advanced pSConfig Templates" href="psconfig_templates_advanced.html" />
    <link rel="prev" title="PWA API" href="pwa_api.html" />
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-52RNZ729B1"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());
		gtag('config', 'G-52RNZ729B1');
	</script>
	 

  </head><body>
    <header>
        <div class="headerContents">
          <a href="index.html" border="0"><img src="_static/perfsonar-logo-black-full-100.png"></a>
          <div class="acctSearchContainer">
              <section id="searchBox" class="searchBox">
                  <!--Use of this code assumes agreement with the Google Custom Search Terms of Service. -->
                  <!--The terms of service are available at http://www.google.com/cse/docs/tos.html -->
                  <form action="search.html" id="cse-search-box" method="get">
                    <input type="text" name="q" size="25" class="searchInput" placeholder="Search"/>
                    <input type="hidden" name="check_keywords" value="yes" />
                    <input type="hidden" name="area" value="default" />
                  </form>
              </section>
         </div>
        </div>
    </header>
    <div style="display:block;clear:both;">
    
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="psconfig_templates_advanced.html" title="Advanced pSConfig Templates"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pwa_api.html" title="PWA API"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">perfSONAR Toolkit 5.2.2 documentation</a> &#187;</li> 
      </ul>
    </div>
    </div>
    
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="psconfig-template-variables">
<h1>pSConfig Template Variables<a class="headerlink" href="#psconfig-template-variables" title="Permalink to this headline">¶</a></h1>
<div class="section" id="template-variable-basics">
<span id="psconfig-templates-vars-intro"></span><h2>Template Variable Basics<a class="headerlink" href="#template-variable-basics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="syntax">
<h3>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h3>
<p>Template variables are strings included in the JSON of a template that access properties of task components. They take the following form where <code class="docutils literal notranslate"><span class="pre">VARIABLE</span></code> is the variable being used:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="n">VARIABLE</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p><strong>Expansion</strong> is the process by which a variable is converted from the form above to the actual value it represents. Once expansion completes a variable is referred to as <strong>expanded</strong>. The following template sections support the expansion of template variables:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">archives</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">contexts</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tests</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reference</span></code> object of <code class="docutils literal notranslate"><span class="pre">tasks</span></code></p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Sections such as <code class="docutils literal notranslate"><span class="pre">addresses</span></code>, <code class="docutils literal notranslate"><span class="pre">groups</span></code>, <code class="docutils literal notranslate"><span class="pre">hosts</span></code> and fields outside the <code class="docutils literal notranslate"><span class="pre">reference</span></code> section in <code class="docutils literal notranslate"><span class="pre">tasks</span></code> <strong>DO NOT</strong> support template variables and values will not be expanded in those sections if used.</p>
</div>
</div>
<div class="section" id="determining-json-type-of-expanded-variables">
<h3>Determining JSON Type of Expanded Variables<a class="headerlink" href="#determining-json-type-of-expanded-variables" title="Permalink to this headline">¶</a></h3>
<p>When a template variable is used, it must be enclosed within quotes so that a pre-expansion template is still valid JSON. Once expanded, whether the expanded variable is still a JSON string or some other JSON type, depends on two factors:</p>
<ol class="arabic simple">
<li><p>The variable used</p></li>
<li><p>Whether the variable is used <em>standalone</em> or <em>embedded</em> within a string</p></li>
</ol>
<p>A <strong>standalone</strong> use of the variable is when you use just the variable surrounded by quotes. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;example&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="si">% f</span><span class="s2">lip %}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this example, since the <a class="reference internal" href="#psconfig-templates-vars-flip"><span class="std std-ref">flip variable</span></a> is a boolean type and we have used it in standalone mode, the object will be expanded to the following (assuming flip evaluates to <code class="docutils literal notranslate"><span class="pre">true</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;example&quot;</span><span class="p">:</span> <span class="n">true</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Notice that the surrounding double quotes are removed so it is a JSON boolean instead of a string. If we were to use a different variable, like <a class="reference internal" href="#psconfig-templates-vars-scheduled-by-address"><span class="std std-ref">scheduled_by_address</span></a> that always evaluates to a string, the double quotes will remain intact. For example, consider the following template:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;example&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="si">% s</span><span class="s2">cheduled_by_address %}&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If we expand that variable we get the following (assuming 10.0.0.1 is the address to which it evaluates):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;example&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.1&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Notice that since the variable is a string, the quotes are preserved.</p>
<p>pSConfig agents can also expand variables <strong>embedded</strong> within an existing string. For example if we want to build a URL with a dynamic host portion that uses <a class="reference internal" href="#psconfig-templates-vars-scheduled-by-address"><span class="std std-ref">scheduled_by_address</span></a> we can do the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;example&quot;</span><span class="p">:</span> <span class="s2">&quot;https://{</span><span class="si">% s</span><span class="s2">cheduled_by_address %}/example/url&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This would expand to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;example&quot;</span><span class="p">:</span> <span class="s2">&quot;https://10.0.0.1/example/url&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="placement-in-objects">
<h3>Placement in Objects<a class="headerlink" href="#placement-in-objects" title="Permalink to this headline">¶</a></h3>
<p>For those objects that support template variables, they can be nested as deeply within the object as needed. For example, all the uses of template variables below are completely valid:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;example&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="si">% s</span><span class="s2">cheduled_by_address %}&quot;</span><span class="p">,</span>
    <span class="s2">&quot;nest1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;example&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="si">% s</span><span class="s2">cheduled_by_address %} is nested one level&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nest2&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="n">example</span><span class="s2">&quot;: &quot;</span><span class="p">{</span><span class="o">%</span> <span class="n">scheduled_by_address</span> <span class="o">%</span><span class="p">}</span> <span class="ow">is</span> <span class="n">nested</span> <span class="n">two</span> <span class="n">levels</span><span class="s2">&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Assuming <a class="reference internal" href="#psconfig-templates-vars-scheduled-by-address"><span class="std std-ref">scheduled_by_address</span></a> still evaluates to 10.0.0.1, the expanded object would look as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;example&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;nest1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;example&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.1 is nested one level&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nest2&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="n">example</span><span class="s2">&quot;: &quot;</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.1</span> <span class="ow">is</span> <span class="n">nested</span> <span class="n">two</span> <span class="n">levels</span><span class="s2">&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="address-variable">
<span id="psconfig-templates-vars-address"></span><h2><code class="docutils literal notranslate"><span class="pre">address</span></code> Variable<a class="headerlink" href="#address-variable" title="Permalink to this headline">¶</a></h2>
<div class="section" id="description">
<span id="psconfig-templates-vars-address-description"></span><h3>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h3>
<p>This variable accesses the <code class="docutils literal notranslate"><span class="pre">address</span></code> property of an <em>address</em> object in the  list generated by a group for an individual task.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a class="reference internal" href="psconfig_templates_intro.html"><span class="doc">Introduction to pSConfig Templates</span></a> for a discussion on how groups work and how they generate address lists.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">address</span></code> template variable takes the following form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="n">address</span><span class="p">[</span><span class="n">INDEX</span><span class="p">]</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">INDEX</span></code> between square brackets indicates which address object in the generated list to access starting at 0. Since groups of type <em>mesh</em> and <em>disjoint</em> always return pairs of two addresses, the <em>INDEX</em> can be value 0 or 1. For groups of type <em>list</em> it must be 0 since that type only generates one address. This variable always returns a string and will take the form of an IP address or hostname.</p>
</div>
<div class="section" id="examples">
<span id="psconfig-templates-vars-address-examples"></span><h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">address</span></code> template variable is commonly used for test specifications that have <code class="docutils literal notranslate"><span class="pre">source</span></code> and/or <code class="docutils literal notranslate"><span class="pre">dest</span></code> parameters. Below is an example of a throughput test using this variable to set the <code class="docutils literal notranslate"><span class="pre">source</span></code> to the first address in the pair and the <code class="docutils literal notranslate"><span class="pre">dest</span></code> to the second address. Assuming that the first address in the input pair is <em>10.0.0.1</em> and the second is <em>10.0.0.2</em> the template and expansion look as follows:</p>
<ul>
<li><p><strong>Template</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;throughput_test&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;throughput&quot;</span><span class="p">,</span>
    <span class="s2">&quot;spec&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="si">% a</span><span class="s2">ddress[0] %}&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dest&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="si">% a</span><span class="s2">ddress[1] %}&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p><strong>Post-Expansion</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;throughput_test&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;throughput&quot;</span><span class="p">,</span>
    <span class="s2">&quot;spec&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dest&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.2&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
<p>Likewise, this variable is useful for <em>archive</em> objects such as those of type <em>http</em> where the URL is to an archive running on one of the endpoints. For example, if paired with the test specification above, this would always store the result on the host that is the <code class="docutils literal notranslate"><span class="pre">source</span></code> of the test. The template and expanded values are shown below:</p>
<ul>
<li><p><strong>Template</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;source_archive&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;archiver&quot;</span><span class="p">:</span> <span class="s2">&quot;http&quot;</span><span class="p">,</span>
     <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://{</span><span class="si">% a</span><span class="s2">ddress[0] %}/logstash&quot;</span>
     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p><strong>Post-Expansion</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;source_archive&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;archiver&quot;</span><span class="p">:</span> <span class="s2">&quot;http&quot;</span><span class="p">,</span>
     <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://10.0.0.1/logstash&quot;</span>
     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="flip-variable">
<span id="psconfig-templates-vars-flip"></span><h2><code class="docutils literal notranslate"><span class="pre">flip</span></code> Variable<a class="headerlink" href="#flip-variable" title="Permalink to this headline">¶</a></h2>
<div class="section" id="psconfig-templates-vars-flip-description">
<span id="id1"></span><h3>Description<a class="headerlink" href="#psconfig-templates-vars-flip-description" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">flip</span></code> variable expands a boolean value that is <code class="docutils literal notranslate"><span class="pre">true</span></code> if the task will be scheduled by an agent other than the one representing either the first address in the list or the host indicated by the <code class="docutils literal notranslate"><span class="pre">scheduled_by</span></code> parameter of the <em>task</em> object if specified. What this usually means is that if the first address in a pair has <a class="reference internal" href="psconfig_templates_advanced.html#psconfig-templates-advanced-addresses-noagent"><span class="std std-ref">no-agent</span></a> enabled then the second address will have to schedule it, thus setting flip to true. Otherwise flip will be <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">flip</span></code> template variable takes the following form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="n">flip</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>The return type of this is a JSON boolean meaning if used as a standalone variable the surrounding double quotes will be removed.</p>
</div>
<div class="section" id="psconfig-templates-vars-flip-examples">
<span id="id2"></span><h3>Examples<a class="headerlink" href="#psconfig-templates-vars-flip-examples" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">flip</span></code> variable is commonly used with the aptly-named <code class="docutils literal notranslate"><span class="pre">flip</span></code> option of <code class="docutils literal notranslate"><span class="pre">latency</span></code> and <code class="docutils literal notranslate"><span class="pre">latencybg</span></code> test specifications. In fact, it is probably a good idea to set this for all tests of this type. What it does is allow these tests to work even if the the address set to the source has <a class="reference internal" href="psconfig_templates_advanced.html#psconfig-templates-advanced-addresses-noagent"><span class="std std-ref">no-agent</span></a> enabled. Assuming that the first address in the input pair is <em>10.0.0.1</em> , the second is <em>10.0.0.2</em> and  the address object of <em>10.0.0.1</em> has <a class="reference internal" href="psconfig_templates_advanced.html#psconfig-templates-advanced-addresses-noagent"><span class="std std-ref">no-agent</span></a> enabled, the template and expansion look as follows:</p>
<ul>
<li><p><strong>Template</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;latencybg_test&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;latencybg&quot;</span><span class="p">,</span>
    <span class="s2">&quot;spec&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="si">% a</span><span class="s2">ddress[0] %}&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dest&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="si">% a</span><span class="s2">ddress[1] %}&quot;</span><span class="p">,</span>
        <span class="s2">&quot;flip&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="si">% f</span><span class="s2">lip %}&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p><strong>Post-Expansion</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;latencybg_test&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;latencybg&quot;</span><span class="p">,</span>
    <span class="s2">&quot;spec&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dest&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.2&quot;</span><span class="p">,</span>
        <span class="s2">&quot;flip&quot;</span><span class="p">:</span> <span class="n">true</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="jq-variable">
<span id="psconfig-templates-vars-jq"></span><h2><code class="docutils literal notranslate"><span class="pre">jq</span></code> Variable<a class="headerlink" href="#jq-variable" title="Permalink to this headline">¶</a></h2>
<div class="section" id="psconfig-templates-vars-jq-description">
<span id="id3"></span><h3>Description<a class="headerlink" href="#psconfig-templates-vars-jq-description" title="Permalink to this headline">¶</a></h3>
<p>This variable  accepts a <a class="reference external" href="https://stedolan.github.io/jq/">jq</a> script that it performs against the JSON of a task and its components. This is by far the most flexible and powerful of the template variables. In fact, almost all the other template variables could be implemented using the <code class="docutils literal notranslate"><span class="pre">jq</span></code> template variable instead.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">jq</span></code> template variable takes the following form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="n">jq</span> <span class="n">SCRIPT</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>The <em>SCRIPT</em> is the jq to be executed. The JSON object on which the jq operates is a special form of the template itself, including only those elements relating to the individual task being generated. Specifically, the JSON being queried has the following sections:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">addresses</span></code> which is an array of the <em>address</em> object for this particular task. This means a variable like <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">jq</span> <span class="pre">.addresses[0].address</span> <span class="pre">%}</span></code> is the exact equivalent of the <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">address[0]</span> <span class="pre">%}</span></code> template variable (see <a class="reference internal" href="#psconfig-templates-vars-address"><span class="std std-ref">address Variable</span></a>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">archives</span></code> is an array of the <em>archive</em> objects to be used for this task. A query such as <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">jq</span> <span class="pre">.archives[0].archiver</span> <span class="pre">%}</span></code> returns the type of the first archiver in the list. The order is not guaranteed, so plan scripts accordingly if using more than one archiver for a task.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">contexts</span></code> is a two-dimensional array of the <em>context</em> objects to be used for this task. The index at the first level of the array corresponds with the index of the <em>address</em> object that is associated with the <em>context</em> objects in the list at the second level. A query such as <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">jq</span> <span class="pre">.contexts[0]</span> <span class="pre">%}</span></code> returns an array of all the <em>context</em> objects associated with the first <em>address</em> object. The order within the second level of the context list is not guaranteed, so plan scripts accordingly if using more than one context for an address. If an address has no contexts, then the array will be empty.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hosts</span></code> is an array of the <em>host</em> objects to be used for this task. The index of a host maps to the address to which that host belongs. If an address does not belong to a host, an empty object will be at that position. A script such as <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">jq</span> <span class="pre">.host[0].tags</span> <span class="pre">%}</span></code> returns the tags of the host associated with the first address.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">task</span></code> is the <em>task</em> object exactly as defined in the template.  A script such as <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">jq</span> <span class="pre">.task.tools</span> <span class="pre">%}</span></code> returns the <code class="docutils literal notranslate"><span class="pre">tools</span></code> array of the task.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">test</span></code> is the <em>test</em> object exactly as defined in the template.  A script such as <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">jq</span> <span class="pre">.test.type</span> <span class="pre">%}</span></code> returns the <code class="docutils literal notranslate"><span class="pre">type</span></code> of the task.</p></li>
</ul>
<p>The JSON type returned by <code class="docutils literal notranslate"><span class="pre">jq</span></code> template variables depends on your query. It is important to keep this in mind when using these variables because the cost of the extra flexibility means unexpected things can happen if one is not careful.</p>
</div>
<div class="section" id="psconfig-templates-vars-jq-examples">
<span id="id4"></span><h3>Examples<a class="headerlink" href="#psconfig-templates-vars-jq-examples" title="Permalink to this headline">¶</a></h3>
<p>Let’s take a look at an example where we have the following template using the <code class="docutils literal notranslate"><span class="pre">jq</span></code> template variable in the <code class="docutils literal notranslate"><span class="pre">reference</span></code> section of a <em>task</em> object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;thr1&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr1.perfsonar.net&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_meta&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;ifspeed&quot;</span><span class="p">:</span> <span class="mi">10</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;thr2&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr2.perfsonar.net&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_meta&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;ifspeed&quot;</span><span class="p">:</span> <span class="mi">1</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;groups&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;throughput_group&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;mesh&quot;</span><span class="p">,</span>
            <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
                 <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;thr1&quot;</span><span class="p">},</span>
                 <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;thr2&quot;</span><span class="p">}</span>
             <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;tests&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;throughput_test&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;throughput&quot;</span><span class="p">,</span>
            <span class="s2">&quot;spec&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="si">% a</span><span class="s2">ddress[0] %}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;dest&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="si">% a</span><span class="s2">ddress[1] %}&quot;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;tasks&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;throughput_task&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;throughput_group&quot;</span><span class="p">,</span>
            <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;throughput_test&quot;</span><span class="p">,</span>
            <span class="s2">&quot;reference&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;source_ifspeed&quot;</span><span class="p">:</span> <span class="s2">&quot;{% jq .addresses[0]._meta.ifspeed %}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;dest_ifspeed&quot;</span><span class="p">:</span> <span class="s2">&quot;{% jq .addresses[1]._meta.ifspeed %}&quot;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the example, each address object has a custom <code class="docutils literal notranslate"><span class="pre">_meta</span></code> property intended to indicate the speed of the network interface that the address object represents. Those fields will be included in a <code class="docutils literal notranslate"><span class="pre">reference</span></code> section of the task meaning it will be included in an informational section of the same name in the corresponding pScheduler task. Someone debugging pScheduler will be able to see these fields and may find it of use. Let’s take a closer look at how these will be expanded so we better understand their meaning.</p>
<p>First, we have a group of type <em>mesh</em> containing two members. This will generate the following address pairs:</p>
<ul class="simple">
<li><p>thr1.perfsonar.net, thr2.perfsonar.net</p></li>
<li><p>thr2.perfsonar.net, thr1.perfsonar.net</p></li>
</ul>
<p>For the first address pair, the JSON generated against which we can run our jq script is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;addresses&quot;</span><span class="p">:[</span>
      <span class="p">{</span>
         <span class="s2">&quot;address&quot;</span><span class="p">:</span><span class="s2">&quot;thr1.perfsonar.net&quot;</span><span class="p">,</span>
         <span class="s2">&quot;_meta&quot;</span><span class="p">:{</span>
            <span class="s2">&quot;ifspeed&quot;</span><span class="p">:</span><span class="mi">10</span>
         <span class="p">}</span>
      <span class="p">},</span>
      <span class="p">{</span>
         <span class="s2">&quot;address&quot;</span><span class="p">:</span><span class="s2">&quot;thr2.perfsonar.net&quot;</span><span class="p">,</span>
         <span class="s2">&quot;_meta&quot;</span><span class="p">:{</span>
            <span class="s2">&quot;ifspeed&quot;</span><span class="p">:</span><span class="mi">1</span>
         <span class="p">}</span>
      <span class="p">}</span>
   <span class="p">],</span>
   <span class="s2">&quot;archives&quot;</span><span class="p">:</span> <span class="p">[],</span>
   <span class="s2">&quot;contexts&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">[],</span> <span class="p">[]</span> <span class="p">],</span>
   <span class="s2">&quot;hosts&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{},</span> <span class="p">{}</span> <span class="p">],</span>
   <span class="s2">&quot;test&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;throughput&quot;</span><span class="p">,</span>
      <span class="s2">&quot;spec&quot;</span><span class="p">:{</span>
         <span class="s2">&quot;source&quot;</span><span class="p">:</span><span class="s2">&quot;{</span><span class="si">% a</span><span class="s2">ddress[0] %}&quot;</span><span class="p">,</span>
         <span class="s2">&quot;dest&quot;</span><span class="p">:</span><span class="s2">&quot;{</span><span class="si">% a</span><span class="s2">ddress[1] %}&quot;</span>
      <span class="p">}</span>
   <span class="p">},</span>
   <span class="s2">&quot;task&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;throughput_group&quot;</span><span class="p">,</span>
      <span class="s2">&quot;test&quot;</span><span class="p">:</span><span class="s2">&quot;throughput_test&quot;</span><span class="p">,</span>
      <span class="s2">&quot;reference&quot;</span><span class="p">:{</span>
         <span class="s2">&quot;source_ifspeed&quot;</span><span class="p">:</span><span class="s2">&quot;{% jq .addresses[0]._meta.ifspeed %}&quot;</span><span class="p">,</span>
         <span class="s2">&quot;dest_ifspeed&quot;</span><span class="p">:</span><span class="s2">&quot;{% jq .addresses[1]._meta.ifspeed %}&quot;</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Our variables <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">jq</span> <span class="pre">.addresses[0]._meta.ifspeed</span> <span class="pre">%}</span></code> and <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">jq</span> <span class="pre">.addresses[1]._meta.ifspeed</span> <span class="pre">%}</span></code> are standalone queries selecting a JSON integer from each of the address object in the list. That means the quotes will get dropped in the result. This yields the following expanded task:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;throughput_group&quot;</span><span class="p">,</span>
    <span class="s2">&quot;test&quot;</span><span class="p">:</span><span class="s2">&quot;throughput_test&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reference&quot;</span><span class="p">:{</span>
        <span class="s2">&quot;source_ifspeed&quot;</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
        <span class="s2">&quot;dest_ifspeed&quot;</span><span class="p">:</span><span class="mi">1</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>For the second address pair, we get the following JSON against which we can run our jq script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
   <span class="s2">&quot;addresses&quot;</span><span class="p">:[</span>
      <span class="p">{</span>
         <span class="s2">&quot;address&quot;</span><span class="p">:</span><span class="s2">&quot;thr2.perfsonar.net&quot;</span><span class="p">,</span>
         <span class="s2">&quot;_meta&quot;</span><span class="p">:{</span>
            <span class="s2">&quot;ifspeed&quot;</span><span class="p">:</span><span class="mi">1</span>
         <span class="p">}</span>
      <span class="p">},</span>
      <span class="p">{</span>
         <span class="s2">&quot;address&quot;</span><span class="p">:</span><span class="s2">&quot;thr1.perfsonar.net&quot;</span><span class="p">,</span>
         <span class="s2">&quot;_meta&quot;</span><span class="p">:{</span>
            <span class="s2">&quot;ifspeed&quot;</span><span class="p">:</span><span class="mi">10</span>
         <span class="p">}</span>
      <span class="p">}</span>
   <span class="p">],</span>
   <span class="s2">&quot;archives&quot;</span><span class="p">:</span> <span class="p">[],</span>
   <span class="s2">&quot;contexts&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">[],</span> <span class="p">[]</span> <span class="p">],</span>
   <span class="s2">&quot;hosts&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="p">{},</span> <span class="p">{}</span> <span class="p">],</span>
   <span class="s2">&quot;test&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;throughput&quot;</span><span class="p">,</span>
      <span class="s2">&quot;spec&quot;</span><span class="p">:{</span>
         <span class="s2">&quot;source&quot;</span><span class="p">:</span><span class="s2">&quot;{</span><span class="si">% a</span><span class="s2">ddress[0] %}&quot;</span><span class="p">,</span>
         <span class="s2">&quot;dest&quot;</span><span class="p">:</span><span class="s2">&quot;{</span><span class="si">% a</span><span class="s2">ddress[1] %}&quot;</span>
      <span class="p">}</span>
   <span class="p">},</span>
   <span class="s2">&quot;task&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;throughput_group&quot;</span><span class="p">,</span>
      <span class="s2">&quot;test&quot;</span><span class="p">:</span><span class="s2">&quot;throughput_test&quot;</span><span class="p">,</span>
      <span class="s2">&quot;reference&quot;</span><span class="p">:{</span>
         <span class="s2">&quot;source_ifspeed&quot;</span><span class="p">:</span><span class="s2">&quot;{% jq .addresses[0]._meta.ifspeed %}&quot;</span><span class="p">,</span>
         <span class="s2">&quot;dest_ifspeed&quot;</span><span class="p">:</span><span class="s2">&quot;{% jq ,addresses[1]._meta.ifspeed %}&quot;</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This results in the following expanded task:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;throughput_group&quot;</span><span class="p">,</span>
    <span class="s2">&quot;test&quot;</span><span class="p">:</span><span class="s2">&quot;throughput_test&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reference&quot;</span><span class="p">:{</span>
        <span class="s2">&quot;source_ifspeed&quot;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;dest_ifspeed&quot;</span><span class="p">:</span><span class="mi">10</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more information on jq, see the <a class="reference external" href="https://stedolan.github.io/jq/">official jq documentation</a> or this <a class="reference external" href="https://youtu.be/FrT6R75M3BE">video tutorial</a>.</p>
</div>
</div>
</div>
<div class="section" id="lead-bind-address-variable">
<span id="psconfig-templates-vars-lead-bind-address"></span><h2><code class="docutils literal notranslate"><span class="pre">lead_bind_address</span></code> Variable<a class="headerlink" href="#lead-bind-address-variable" title="Permalink to this headline">¶</a></h2>
<div class="section" id="psconfig-templates-vars-lead-bind-address-description">
<span id="id5"></span><h3>Description<a class="headerlink" href="#psconfig-templates-vars-lead-bind-address-description" title="Permalink to this headline">¶</a></h3>
<p>This variable accesses the <code class="docutils literal notranslate"><span class="pre">lead-bind-address</span></code> property of an <em>address</em> object in the  list generated by a group for an individual task. It will additionally fallback to the value of the <code class="docutils literal notranslate"><span class="pre">address</span></code> property if <code class="docutils literal notranslate"><span class="pre">lead-bind-address</span></code> is not set.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a class="reference internal" href="psconfig_templates_intro.html"><span class="doc">Introduction to pSConfig Templates</span></a> for a discussion on how groups work and how they generate address lists.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a class="reference internal" href="psconfig_templates_advanced.html#psconfig-templates-advanced-addresses-lead-bind-address"><span class="std std-ref">Controlling pScheduler Server Binding</span></a> for a discussion of the <code class="docutils literal notranslate"><span class="pre">lead-bind-address</span></code> property’s meaning</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">lead_bind_address</span></code> template variable takes the following form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="n">lead_bind_address</span><span class="p">[</span><span class="n">INDEX</span><span class="p">]</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">INDEX</span></code> between square brackets indicates which address object in the generated list to access starting at 0. Since groups of type <em>mesh</em> and <em>disjoint</em> always return pairs of two addresses, the <em>INDEX</em> can be value 0 or 1. For groups of type <em>list</em> it must be 0 since that type only generates one address. This variable always returns a string and will take the form of an IP address or hostname.</p>
</div>
<div class="section" id="psconfig-templates-vars-lead-bind-address-examples">
<span id="id6"></span><h3>Examples<a class="headerlink" href="#psconfig-templates-vars-lead-bind-address-examples" title="Permalink to this headline">¶</a></h3>
<p>This property is primarily available for completeness and informational purposes. The pScheduler agent reads the <em>address</em> object’s <code class="docutils literal notranslate"><span class="pre">lead-bind-address</span></code> property automatically, so it is not required to use this variable in order to properly set a pScheduler server’s binding options. The example below shows <code class="docutils literal notranslate"><span class="pre">lead_bind_address</span></code> being used for informational purposes in a task:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;throughput_group&quot;</span><span class="p">,</span>
    <span class="s2">&quot;test&quot;</span><span class="p">:</span><span class="s2">&quot;throughput_test&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reference&quot;</span><span class="p">:{</span>
        <span class="s2">&quot;source_lead_bind_address&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="si">% le</span><span class="s2">ad_bind_address[0] %}&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Assuming the <code class="docutils literal notranslate"><span class="pre">lead-bind-address</span></code> property is set to 10.0.0.1 OR that it is not set and the <code class="docutils literal notranslate"><span class="pre">address</span></code> property is 10.0.0.1 we get the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;group&quot;</span><span class="p">:</span><span class="s2">&quot;throughput_group&quot;</span><span class="p">,</span>
    <span class="s2">&quot;test&quot;</span><span class="p">:</span><span class="s2">&quot;throughput_test&quot;</span><span class="p">,</span>
    <span class="s2">&quot;reference&quot;</span><span class="p">:{</span>
        <span class="s2">&quot;source_lead_bind_address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.1&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="localhost-variable">
<span id="psconfig-templates-vars-localhost"></span><h2><code class="docutils literal notranslate"><span class="pre">localhost</span></code> Variable<a class="headerlink" href="#localhost-variable" title="Permalink to this headline">¶</a></h2>
<div class="section" id="psconfig-templates-vars-localhost-description">
<span id="id7"></span><h3>Description<a class="headerlink" href="#psconfig-templates-vars-localhost-description" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">localhost</span></code> template variable returns a string value of “localhost” unless the <a class="reference internal" href="#psconfig-templates-vars-flip"><span class="std std-ref">flip</span></a> variable is true, then it returns the value of <a class="reference internal" href="#psconfig-templates-vars-scheduled-by-address"><span class="std std-ref">scheduled_by_address</span></a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">localhost</span></code> template variable takes the following form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="n">localhost</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>This variable may be useful in instances where <a class="reference internal" href="#psconfig-templates-vars-scheduled-by-address"><span class="std std-ref">scheduled_by_address</span></a> is desired, but the local system identifies itself using a private IP address different from that in <a class="reference internal" href="#psconfig-templates-vars-scheduled-by-address"><span class="std std-ref">scheduled_by_address</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you do not have the private IP limitation, then <a class="reference internal" href="#psconfig-templates-vars-scheduled-by-address"><span class="std std-ref">scheduled_by_address</span></a> is generally preferred as its clearer as to where results are stored once expanded.</p>
</div>
</div>
<div class="section" id="psconfig-templates-vars-localhost-examples">
<span id="id8"></span><h3>Examples<a class="headerlink" href="#psconfig-templates-vars-localhost-examples" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">localhost</span></code> template variable can be useful when building URLs for archives. The example below embeds the variable in the <code class="docutils literal notranslate"><span class="pre">url</span></code> field. If the host expected to schedule the test does not have <a class="reference internal" href="psconfig_templates_advanced.html#psconfig-templates-advanced-addresses-noagent"><span class="std std-ref">no-agent</span></a> enabled then it will expand to “localhost” as shown below:</p>
<ul>
<li><p><strong>Template</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;local_archive&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;archiver&quot;</span><span class="p">:</span> <span class="s2">&quot;http&quot;</span><span class="p">,</span>
     <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://{</span><span class="si">% lo</span><span class="s2">calhost %}/logstash&quot;</span>
     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p><strong>Post-Expansion</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;local_archive&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;archiver&quot;</span><span class="p">:</span> <span class="s2">&quot;http&quot;</span><span class="p">,</span>
     <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://localhost/logstash&quot;</span>
     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
<p>If that same example is for a task where the host expected to schedule the task has <a class="reference internal" href="psconfig_templates_advanced.html#psconfig-templates-advanced-addresses-noagent"><span class="std std-ref">no-agent</span></a> enabled, thus <a class="reference internal" href="#psconfig-templates-vars-flip"><span class="std std-ref">flip</span></a> is true, then it will return the following if the address of the <a class="reference internal" href="psconfig_templates_advanced.html#psconfig-templates-advanced-addresses-noagent"><span class="std std-ref">no-agent</span></a> host is 10.0.0.1:</p>
<ul>
<li><p><strong>Post-Expansion</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;local_archive&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;archiver&quot;</span><span class="p">:</span> <span class="s2">&quot;http&quot;</span><span class="p">,</span>
     <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://10.0.0.1/logstash&quot;</span>
     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="pscheduler-address-variable">
<span id="psconfig-templates-vars-pscheduler-address"></span><h2><code class="docutils literal notranslate"><span class="pre">pscheduler_address</span></code> Variable<a class="headerlink" href="#pscheduler-address-variable" title="Permalink to this headline">¶</a></h2>
<div class="section" id="psconfig-templates-vars-pscheduler-address-description">
<span id="id9"></span><h3>Description<a class="headerlink" href="#psconfig-templates-vars-pscheduler-address-description" title="Permalink to this headline">¶</a></h3>
<p>This variable accesses the <code class="docutils literal notranslate"><span class="pre">pscheduler-address</span></code> property of an <em>address</em> object in the list generated by a group for an individual task. It will additionally fallback to the value of the <code class="docutils literal notranslate"><span class="pre">address</span></code> property if <code class="docutils literal notranslate"><span class="pre">pscheduler-address</span></code> is not set.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a class="reference internal" href="psconfig_templates_intro.html"><span class="doc">Introduction to pSConfig Templates</span></a> for a discussion on how groups work and how they generate address lists.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a class="reference internal" href="psconfig_templates_advanced.html#psconfig-templates-advanced-addresses-pscheduler-address"><span class="std std-ref">Using Non-Standard pScheduler Ports and Addresses</span></a> for a discussion of the <code class="docutils literal notranslate"><span class="pre">pscheduler-address</span></code> property’s meaning</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pscheduler_address</span></code> template variable takes the following form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="n">pscheduler_address</span><span class="p">[</span><span class="n">INDEX</span><span class="p">]</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">INDEX</span></code> between square brackets indicates which address object in the generated list to access starting at 0. Since groups of type <em>mesh</em> and <em>disjoint</em> always return pairs of two addresses, the <em>INDEX</em> can be value 0 or 1. For groups of type <em>list</em> it must be 0 since that type only generates one address. This variable always returns a string and will take the form of an IP address, hostname with an optional port.</p>
</div>
<div class="section" id="psconfig-templates-vars-pscheduler-address-examples">
<span id="id10"></span><h3>Examples<a class="headerlink" href="#psconfig-templates-vars-pscheduler-address-examples" title="Permalink to this headline">¶</a></h3>
<p>Most of the standard perfSONAR pScheduler test plug-ins support a <code class="docutils literal notranslate"><span class="pre">source-node</span></code> and/or <code class="docutils literal notranslate"><span class="pre">dest-node</span></code> field in their specification. These are for defining a pScheduler server on a port other than 443 or at a different address from the <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">dest</span></code> fields. These are exactly the types of fields for which <code class="docutils literal notranslate"><span class="pre">pscheduler_address</span></code> is intended. Let’s assume we have a task using the following pair of address definitions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;addresses&quot;</span><span class="p">:[</span>
    <span class="p">{</span>
        <span class="s2">&quot;address&quot;</span><span class="p">:</span><span class="s2">&quot;thr1.perfsonar.net&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pscheduler-address&quot;</span><span class="p">:</span> <span class="s2">&quot;[fd89:b4d9:341a:8465::1]:8080&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="s2">&quot;address&quot;</span><span class="p">:</span><span class="s2">&quot;thr2.perfsonar.net&quot;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Below is <em>test</em> object below and its subsequent expansion using the <em>address</em> objects above:</p>
<ul>
<li><p><strong>Template</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="p">{</span>
   <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;throughput&quot;</span><span class="p">,</span>
   <span class="s2">&quot;spec&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;source&quot;</span><span class="p">:</span><span class="s2">&quot;{</span><span class="si">% a</span><span class="s2">ddress[0] %}&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dest&quot;</span><span class="p">:</span><span class="s2">&quot;{</span><span class="si">% a</span><span class="s2">ddress[1] %}&quot;</span><span class="p">,</span>
      <span class="s2">&quot;source-node&quot;</span><span class="p">:</span><span class="s2">&quot;{% pscheduler_address[0] %}&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dest-node&quot;</span><span class="p">:</span><span class="s2">&quot;{% pscheduler_address[1] %}&quot;</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p><strong>Post-Expansion</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="p">{</span>
   <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;throughput&quot;</span><span class="p">,</span>
   <span class="s2">&quot;spec&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;source&quot;</span><span class="p">:</span><span class="s2">&quot;thr1.perfsonar.net&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dest&quot;</span><span class="p">:</span><span class="s2">&quot;thr2.perfsonar.net&quot;</span><span class="p">,</span>
      <span class="s2">&quot;source-node&quot;</span><span class="p">:</span><span class="s2">&quot;[fd89:b4d9:341a:8465::1]:8080&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dest-node&quot;</span><span class="p">:</span><span class="s2">&quot;thr2.perfsonar.net&quot;</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
<p>Notice how <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">pscheduler_address[0]</span> <span class="pre">%}</span></code> expands to the <code class="docutils literal notranslate"><span class="pre">pscheduler-address</span></code> property of the first address, but for <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">pscheduler_address[1]</span> <span class="pre">%}</span></code> it falls back to the value of <code class="docutils literal notranslate"><span class="pre">address</span></code> since <code class="docutils literal notranslate"><span class="pre">pscheduler-address</span></code> is not set for the second address.</p>
</div>
</div>
<div class="section" id="scheduled-by-address-variable">
<span id="psconfig-templates-vars-scheduled-by-address"></span><h2><code class="docutils literal notranslate"><span class="pre">scheduled_by_address</span></code> Variable<a class="headerlink" href="#scheduled-by-address-variable" title="Permalink to this headline">¶</a></h2>
<div class="section" id="psconfig-templates-vars-scheduled-by-address-description">
<span id="id11"></span><h3>Description<a class="headerlink" href="#psconfig-templates-vars-scheduled-by-address-description" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">scheduled_by_address</span></code> variable expands to the <code class="docutils literal notranslate"><span class="pre">address</span></code> property of the <em>address</em> object responsible for creating this task. Responsibility is determined according to the following rules:</p>
<ol class="arabic simple">
<li><p>If <a class="reference internal" href="psconfig_templates_advanced.html#psconfig-templates-advanced-tasks-scheduled-by"><span class="std std-ref">scheduled-by</span></a> is set in the <code class="docutils literal notranslate"><span class="pre">task</span></code>, then the generated <code class="docutils literal notranslate"><span class="pre">address</span></code> object at the index specified by that property is used unless it has <a class="reference internal" href="psconfig_templates_advanced.html#psconfig-templates-advanced-addresses-noagent"><span class="std std-ref">no-agent</span></a> enabled</p></li>
<li><p>Otherwise, the first address in the generated list where <a class="reference internal" href="psconfig_templates_advanced.html#psconfig-templates-advanced-addresses-noagent"><span class="std std-ref">no-agent</span></a> is disabled will be used.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There will never be a task where all addresses have <a class="reference internal" href="psconfig_templates_advanced.html#psconfig-templates-advanced-addresses-noagent"><span class="std std-ref">no-agent</span></a> enabled. pSConfig skips those tests since by definition they cannot be created.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">scheduled_by_address</span></code> template variable takes the following form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%</span> <span class="n">scheduled_by_address</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<p>This variable always returns a string and will take the form of an IP address or hostname.</p>
</div>
<div class="section" id="psconfig-templates-vars-scheduled-by-address-examples">
<span id="id12"></span><h3>Examples<a class="headerlink" href="#psconfig-templates-vars-scheduled-by-address-examples" title="Permalink to this headline">¶</a></h3>
<p>This is often used in both the <code class="docutils literal notranslate"><span class="pre">url</span></code> and observer or measurment agent fields for archives (i.e. a field indicating what host performed the measurement). In the <code class="docutils literal notranslate"><span class="pre">_url</span></code> it tells it to register the results to the host requesting the task. In the <code class="docutils literal notranslate"><span class="pre">x-ps-observer</span></code> header it explicitly defines the host that requested the measurement, which is a special field the perfSONAR Logstash pipeline that writes to OpenSearch understands. Assuming the variable expands to 10.0.0.1, below is an example template and its expansion:</p>
<ul>
<li><p><strong>Template</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;sched_by_archive&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;archiver&quot;</span><span class="p">:</span> <span class="s2">&quot;http&quot;</span><span class="p">,</span>
     <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://{</span><span class="si">% s</span><span class="s2">cheduled_by_address %}/logstash&quot;</span>
     <span class="p">},</span>
     <span class="s2">&quot;_headers&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;x-ps-observer&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="si">% s</span><span class="s2">cheduled_by_address %}&quot;</span>
     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
<li><p><strong>Post-Expansion</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;sched_by_archive&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;archiver&quot;</span><span class="p">:</span> <span class="s2">&quot;http&quot;</span><span class="p">,</span>
     <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;_url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://10.0.0.1/logstash&quot;</span>
     <span class="p">},</span>
     <span class="s2">&quot;_headers&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;x-ps-observer&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.1&quot;</span>
     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <nav id="channelNav" class="channelNav">
                
                <ul>
<li><a class="reference internal" href="#">pSConfig Template Variables</a><ul>
<li><a class="reference internal" href="#template-variable-basics">Template Variable Basics</a><ul>
<li><a class="reference internal" href="#syntax">Syntax</a></li>
<li><a class="reference internal" href="#determining-json-type-of-expanded-variables">Determining JSON Type of Expanded Variables</a></li>
<li><a class="reference internal" href="#placement-in-objects">Placement in Objects</a></li>
</ul>
</li>
<li><a class="reference internal" href="#address-variable"><code class="docutils literal notranslate"><span class="pre">address</span></code> Variable</a><ul>
<li><a class="reference internal" href="#description">Description</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#flip-variable"><code class="docutils literal notranslate"><span class="pre">flip</span></code> Variable</a><ul>
<li><a class="reference internal" href="#psconfig-templates-vars-flip-description">Description</a></li>
<li><a class="reference internal" href="#psconfig-templates-vars-flip-examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jq-variable"><code class="docutils literal notranslate"><span class="pre">jq</span></code> Variable</a><ul>
<li><a class="reference internal" href="#psconfig-templates-vars-jq-description">Description</a></li>
<li><a class="reference internal" href="#psconfig-templates-vars-jq-examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#lead-bind-address-variable"><code class="docutils literal notranslate"><span class="pre">lead_bind_address</span></code> Variable</a><ul>
<li><a class="reference internal" href="#psconfig-templates-vars-lead-bind-address-description">Description</a></li>
<li><a class="reference internal" href="#psconfig-templates-vars-lead-bind-address-examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#localhost-variable"><code class="docutils literal notranslate"><span class="pre">localhost</span></code> Variable</a><ul>
<li><a class="reference internal" href="#psconfig-templates-vars-localhost-description">Description</a></li>
<li><a class="reference internal" href="#psconfig-templates-vars-localhost-examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pscheduler-address-variable"><code class="docutils literal notranslate"><span class="pre">pscheduler_address</span></code> Variable</a><ul>
<li><a class="reference internal" href="#psconfig-templates-vars-pscheduler-address-description">Description</a></li>
<li><a class="reference internal" href="#psconfig-templates-vars-pscheduler-address-examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#scheduled-by-address-variable"><code class="docutils literal notranslate"><span class="pre">scheduled_by_address</span></code> Variable</a><ul>
<li><a class="reference internal" href="#psconfig-templates-vars-scheduled-by-address-description">Description</a></li>
<li><a class="reference internal" href="#psconfig-templates-vars-scheduled-by-address-examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
</ul>

                <ul>
                  <li>
                  <a href="pwa_api.html">Previous topic</a>
                  <ul><li><a href="pwa_api.html" title="previous chapter">PWA API</a></li></ul>
                  </li>
                </ul>
                  <ul>
                      <li>
                      <a href="psconfig_templates_advanced.html">Next topic</a>
                      <ul><li><a href="psconfig_templates_advanced.html" title="next chapter">Advanced pSConfig Templates</a></li></ul>
                      </li>
                  </ul>
                
                
            </nav>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="psconfig_templates_advanced.html" title="Advanced pSConfig Templates"
             >next</a> |</li>
        <li class="right" >
          <a href="pwa_api.html" title="PWA API"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">perfSONAR Toolkit 5.2.2 documentation</a> &#187;</li> 
      </ul>
    </div>
    <footer id="fat">
        <div class="footerContents">
            <nav id="fatFooterNav" class="fatFooterNav">
                <ul id="menu-partners" class="menu depth-0">
                    <li id="footer-partner-text" class="partner-menu">
                        perfSONAR 
                        <br>
                        partners 
                        <br>
                        include: 
                    </li>
    
                <li id="footer-partner-esnet" class="partner-menu">
                    <a href="http://www.es.net/" title="Visit DOE's Energy Sciences Network"><img src="_static/ESnet-ps.png" alt="" style="border:none;"></a> </li>
                
                <li id="footer-partner-geant" class="partner-menu">
                    <a href="http://www.geant.org/" title="Visit GEANT"><img src="_static/geant-ps.png" alt="" style="border:none;"/></a> </li>
        
                <li id="footer-partner-iu" class="partner-menu">
                    <a href="http://www.iu.edu/" title="Visit Indiana University"><img src="_static/IU-ps.png" alt="" style="border:none;"></a> </li>

                <li id="footer-partner-i2" class="partner-menu">
                    <a href="http://www.internet2.edu/" title="Visit Internet2"><img src="_static/I2-ps.png" alt="" style="border:none;"></a> </li>
					
				<li id="footer-partner-rnp" class="partner-menu">
                    <a href="https://www.rnp.br/en" title="Visit RNP"><img src="_static/rnp.png" alt="" style="border:none;"></a> </li>
                
                <li id="footer-partner-um" class="partner-menu">
                    <a href="http://www.umich.edu/" title="Visit University of Michigan"><img src="_static/UM-ps.png" alt="" style="border:none;"></a> </li>

                </ul>

            </nav>
            <nav id="minFooterNav" class="minFooterNav">
                <span class="copyright">PERFormance Service Oriented Network monitoring ARchitecture </span>
            </nav>
          
        </div> <!-- /footerContents -->
    </footer>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2025, perfSONAR Project.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.4.
    </div>
  </body>
</html>
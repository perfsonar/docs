
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Advanced pSConfig Templates &#8212; perfSONAR Toolkit 4.2.1 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/perfsonar.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MeshConfig to pSConfig Migration Guide" href="psconfig_meshconfig_migrate.html" />
    <link rel="prev" title="pSConfig Template Variables" href="psconfig_templates_vars.html" /> 
  </head><body>
    <header>
        <div class="headerContents">
          <a href="index.html" border="0"><img src="_static/perfSONAR-header.gif"></a>
          <div class="acctSearchContainer">
              <section id="searchBox" class="searchBox">
                  <!--Use of this code assumes agreement with the Google Custom Search Terms of Service. -->
                  <!--The terms of service are available at http://www.google.com/cse/docs/tos.html -->
                  <form action="search.html" id="cse-search-box" method="get">
                    <input type="text" name="q" size="25" class="searchInput" placeholder="Search"/>
                    <input type="hidden" name="check_keywords" value="yes" />
                    <input type="hidden" name="area" value="default" />
                  </form>
              </section>
         </div>
        </div>
    </header>
    <div style="display:block;clear:both;">
    
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="psconfig_meshconfig_migrate.html" title="MeshConfig to pSConfig Migration Guide"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="psconfig_templates_vars.html" title="pSConfig Template Variables"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">perfSONAR Toolkit 4.2.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    </div>
    
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="advanced-psconfig-templates">
<h1>Advanced pSConfig Templates<a class="headerlink" href="#advanced-psconfig-templates" title="Permalink to this headline">¶</a></h1>
<div class="section" id="advanced-addresses-options">
<span id="psconfig-templates-advanced-addresses"></span><h2>Advanced <code class="docutils literal notranslate"><span class="pre">addresses</span></code> Options<a class="headerlink" href="#advanced-addresses-options" title="Permalink to this headline">¶</a></h2>
<div class="section" id="testing-to-addresses-without-an-agent-reading-your-template">
<span id="psconfig-templates-advanced-addresses-noagent"></span><h3>Testing to Addresses without an Agent Reading Your Template<a class="headerlink" href="#testing-to-addresses-without-an-agent-reading-your-template" title="Permalink to this headline">¶</a></h3>
<p>If a particular <em>address</em> object is not controlled by a <a class="reference internal" href="psconfig_pscheduler_agent.html"><span class="doc">pscheduler-agent</span></a> that reads your template, then you should enable the <code class="docutils literal notranslate"><span class="pre">no-agent</span></code> property. An example is below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr1.perfsonar.net&quot;</span><span class="p">,</span>
    <span class="s2">&quot;no-agent&quot;</span><span class="p">:</span> <span class="n">true</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Keep in mind this property specifically refers to the <a class="reference internal" href="psconfig_pscheduler_agent.html"><span class="doc">pscheduler-agent</span></a>, not pScheduler itself. Whether or not pScheduler is required on both ends of a test is dependent on the test type and specification. For example, a multi-participant <em>throughput</em> test always requires pScheduler on both ends, even if one end does not have an agent reading the template. The same is true for most reverse tests. In some cases you can get around the reverse test issues if it is of a type such as <em>latencybg</em> that has an option that supports the <a class="reference internal" href="psconfig_templates_vars.html#psconfig-templates-vars-flip"><span class="std std-ref">flip template variable</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In general, when building groups it is recommended you use type <em>disjoint</em> and keep all the hosts with <code class="docutils literal notranslate"><span class="pre">no-agent</span></code> enabled in either the <code class="docutils literal notranslate"><span class="pre">a-addresses</span></code> or <code class="docutils literal notranslate"><span class="pre">b-addresses</span></code>. While not strictly required, not only will an address pair where all the <em>address</em> objects have <code class="docutils literal notranslate"><span class="pre">no-agent</span></code> enabled be skipped, but mixing <em>address</em> objects with <code class="docutils literal notranslate"><span class="pre">no-agent</span></code> enabled and disabled in a <em>mesh</em> or the same side of a <em>disjoint</em> group can further complicate issues if you do not have detailed understanding of how a test works.</p>
</div>
</div>
<div class="section" id="disabling-an-address">
<span id="psconfig-templates-advanced-addresses-disabled"></span><h3>Disabling an Address<a class="headerlink" href="#disabling-an-address" title="Permalink to this headline">¶</a></h3>
<p>If you want to temporarily suspend usage of an <em>address</em> object, you can set the <code class="docutils literal notranslate"><span class="pre">disabled</span></code> property:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr1.perfsonar.net&quot;</span><span class="p">,</span>
    <span class="s2">&quot;disabled&quot;</span><span class="p">:</span> <span class="n">true</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If a disabled address is included in any <em>group</em> objects, the group will skip any generated pairs involving that address. You can think of this property as a way to “comment-out” all references to an <em>address</em> object since JSON does not natively support comments. It is most useful when you don’t want to entirely delete an <em>address</em> but need to remove it from testing for some amount of time.</p>
</div>
<div class="section" id="using-non-standard-pscheduler-ports-and-addresses">
<span id="psconfig-templates-advanced-addresses-pscheduler-address"></span><h3>Using Non-Standard pScheduler Ports and Addresses<a class="headerlink" href="#using-non-standard-pscheduler-ports-and-addresses" title="Permalink to this headline">¶</a></h3>
<p>If you want to run a pScheduler server associated with a particular <em>address</em> object on a different port and/or an address different than the one indicated by the <code class="docutils literal notranslate"><span class="pre">address</span></code> property, there are two things you must do:</p>
<ol class="arabic simple">
<li>Set the <code class="docutils literal notranslate"><span class="pre">pscheduler-address</span></code> property of your <em>address</em> object</li>
<li>Include the <a class="reference internal" href="psconfig_templates_vars.html#psconfig-templates-vars-pscheduler-address"><span class="std std-ref">pscheduler_address template variable</span></a> in your test specification</li>
</ol>
<p>The <code class="docutils literal notranslate"><span class="pre">pscheduler-address</span></code> property is an IP or hostname with an optional port specification. Examples below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;thr1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr1.perfsonar.net&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pscheduler-address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr1-mgt.perfsonar.net&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;thr2&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr2.perfsonar.net&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pscheduler-address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr2.perfsonar.net:8080&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;thr3&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;fd89:b4d9:341a:8465::1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pscheduler-address&quot;</span><span class="p">:</span> <span class="s2">&quot;[fd89:b4d9:341a:8465::1]:9090&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Generally, many test specifications have a <code class="docutils literal notranslate"><span class="pre">source-node</span></code> and/or <code class="docutils literal notranslate"><span class="pre">dest-node</span></code> property where you can use this value. Since it is dependent on the test type (of which pSConfig has no knowledge), explicitly setting these fields using the <a class="reference internal" href="psconfig_templates_vars.html#psconfig-templates-vars-pscheduler-address"><span class="std std-ref">pscheduler_address template variable</span></a> is required. The template variable has the convenient feature of falling back to the value of the <code class="docutils literal notranslate"><span class="pre">address</span></code> property if <code class="docutils literal notranslate"><span class="pre">pscheduler-address</span></code> is not set. This means that it is not required to set <code class="docutils literal notranslate"><span class="pre">pscheduler-address</span></code> for all <em>address</em> objects. An example test specification is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="p">{</span>
   <span class="s2">&quot;type&quot;</span><span class="p">:</span><span class="s2">&quot;throughput&quot;</span><span class="p">,</span>
   <span class="s2">&quot;spec&quot;</span><span class="p">:{</span>
      <span class="s2">&quot;source&quot;</span><span class="p">:</span><span class="s2">&quot;{% address[0] %}&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dest&quot;</span><span class="p">:</span><span class="s2">&quot;{% address[1] %}&quot;</span><span class="p">,</span>
      <span class="s2">&quot;source-node&quot;</span><span class="p">:</span><span class="s2">&quot;{% pscheduler_address[0] %}&quot;</span><span class="p">,</span>
      <span class="s2">&quot;dest-node&quot;</span><span class="p">:</span><span class="s2">&quot;{% pscheduler_address[1] %}&quot;</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If a test specification supports <code class="docutils literal notranslate"><span class="pre">source-node</span></code>, <code class="docutils literal notranslate"><span class="pre">dest-node</span></code> or an equivalent option it is recommended you always set it and use the <a class="reference internal" href="psconfig_templates_vars.html#psconfig-templates-vars-pscheduler-address"><span class="std std-ref">pscheduler_address template variable</span></a> as the value. Given the ability to fallback, there is no harm in doing so and future-proofs your test definitions if an <em>address</em> object needs to set <code class="docutils literal notranslate"><span class="pre">pscheduler-address</span></code> in the future.</p>
</div>
</div>
<div class="section" id="controlling-pscheduler-server-binding">
<span id="psconfig-templates-advanced-addresses-lead-bind-address"></span><h3>Controlling pScheduler Server Binding<a class="headerlink" href="#controlling-pscheduler-server-binding" title="Permalink to this headline">¶</a></h3>
<p>For pScheduler servers running on a host with an advanced routing configuration, you may need to tell pScheduler to bind to a particular address when sending control traffic to another pScheduler server. pSConfig allows you to set this value with the <code class="docutils literal notranslate"><span class="pre">lead-bind-address</span></code> property of an <em>address</em> object. This property must be an IP or hostname. An example is below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr1.perfsonar.net&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lead-bind-address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr1-mgt.perfsonar.net&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>There are no further steps required to use this property. The <a class="reference internal" href="psconfig_pscheduler_agent.html"><span class="doc">pscheduler-agent</span></a> will automatically detect this value and pass it to pScheduler.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Often you only want to set this value when you are testing to a particular address. See <a class="reference internal" href="#psconfig-templates-advanced-addresses-remote-addresses"><span class="std std-ref">Dynamic Address Properties with remote-addresses</span></a> for more information on this use case.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">There is also a <a class="reference internal" href="psconfig_templates_vars.html#psconfig-templates-vars-lead-bind-address"><span class="std std-ref">lead_bind_address template variable</span></a> but it is NOT required you use this anywhere for the <code class="docutils literal notranslate"><span class="pre">lead-bind-address</span></code> to be passed to pScheduler. The <code class="docutils literal notranslate"><span class="pre">lead-bind-address</span></code> is not part of the test specification but instead is a separate pScheduler field that the <a class="reference internal" href="psconfig_pscheduler_agent.html"><span class="doc">pscheduler-agent</span></a> knows how to interpret.</p>
</div>
</div>
<div class="section" id="dynamic-address-properties-with-remote-addresses">
<span id="psconfig-templates-advanced-addresses-remote-addresses"></span><h3>Dynamic Address Properties with <code class="docutils literal notranslate"><span class="pre">remote-addresses</span></code><a class="headerlink" href="#dynamic-address-properties-with-remote-addresses" title="Permalink to this headline">¶</a></h3>
<p>As described in <a class="reference internal" href="psconfig_templates_intro.html"><span class="doc">Introduction to pSConfig Templates</span></a>, <em>groups</em> combine addresses based on the type that (in the case of <em>mesh</em> and <em>disjoint</em> group types) leads to a pairing of addresses. In some cases we may want the properties of an address object to change based on the other address with which it has been paired. Examples include:</p>
<ul class="simple">
<li><strong>Environments where hosts communicate on private address space.</strong> In particular if they communicate on an IPv4 /30 subnet where no other addresses are configured. This is common in software defined networks and certain VPN environments. In this case we may want to change the <code class="docutils literal notranslate"><span class="pre">address</span></code> property based on the remote address with which we are testing.</li>
<li><strong>Environments where individual host pairs have special binding requirements due to routing restrictions.</strong> In this case we can change the <a class="reference internal" href="#psconfig-templates-advanced-addresses-lead-bind-address"><span class="std std-ref">lead-bind-address</span></a> or <a class="reference internal" href="#psconfig-templates-advanced-addresses-pscheduler-address"><span class="std std-ref">pscheduler-address</span></a> properties based on the pairing.</li>
</ul>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">remote-addresses</span></code> property of an <em>address</em> object to build a map of properties to be used when paired with a given address object. Let’s look at the example network below:</p>
<div class="figure align-center" id="id3">
<img alt="_images/psconfig_templates_advanced_remote-network.png" src="_images/psconfig_templates_advanced_remote-network.png" />
<p class="caption"><span class="caption-text"><em>A network of four hosts where host1 uses private addresses to communicate with each</em></span></p>
</div>
<p>In the diagram, <em>host1</em> communicates with the other three hosts using a different private address with each. Below we define a <em>disjoint</em> group where <em>host1</em> tests to the other three and defines a <code class="docutils literal notranslate"><span class="pre">remote-addresses</span></code> definition in each <em>address</em> object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;host1&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;host1.perfsonar.net&quot;</span><span class="p">,</span>
         <span class="s2">&quot;remote-addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
             <span class="s2">&quot;host2&quot;</span><span class="p">:</span> <span class="p">{</span>
                 <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.1.1.1&quot;</span>
             <span class="p">},</span>
             <span class="s2">&quot;host3&quot;</span><span class="p">:</span> <span class="p">{</span>
                 <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.1&quot;</span>
             <span class="p">},</span>
             <span class="s2">&quot;host4&quot;</span><span class="p">:</span> <span class="p">{</span>
                 <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.2.2.1&quot;</span>
             <span class="p">}</span>
         <span class="p">}</span>
     <span class="p">},</span>
     <span class="s2">&quot;host2&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;host2.perfsonar.net&quot;</span><span class="p">,</span>
         <span class="s2">&quot;remote-addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
             <span class="s2">&quot;host1&quot;</span><span class="p">:</span> <span class="p">{</span>
                 <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.1.1.2&quot;</span>
             <span class="p">}</span>
         <span class="p">}</span>
     <span class="p">},</span>
     <span class="s2">&quot;host3&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;host3.perfsonar.net&quot;</span><span class="p">,</span>
         <span class="s2">&quot;remote-addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
             <span class="s2">&quot;host1&quot;</span><span class="p">:</span> <span class="p">{</span>
                 <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.2&quot;</span>
             <span class="p">}</span>
         <span class="p">}</span>
     <span class="p">},</span>
     <span class="s2">&quot;host4&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;host4.perfsonar.net&quot;</span><span class="p">,</span>
         <span class="s2">&quot;remote-addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
             <span class="s2">&quot;host1&quot;</span><span class="p">:</span> <span class="p">{</span>
                 <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.2.2.2&quot;</span>
             <span class="p">}</span>
         <span class="p">}</span>
     <span class="p">}</span>
 <span class="p">},</span>

 <span class="s2">&quot;groups&quot;</span><span class="p">:</span> <span class="p">{</span>
     <span class="s2">&quot;example-group&quot;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;disjoint&quot;</span><span class="p">,</span>
         <span class="s2">&quot;a-addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
             <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;host1&quot;</span> <span class="p">}</span>
         <span class="p">],</span>
         <span class="s2">&quot;b-addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
             <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;host2&quot;</span> <span class="p">},</span>
             <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;host3&quot;</span> <span class="p">},</span>
             <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;host4&quot;</span> <span class="p">}</span>
         <span class="p">]</span>
     <span class="p">}</span>
 <span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">remote-addresses</span></code> is a JSON object where the properties are the names of other <em>address</em> objects. The value is a new <em>address</em> object where you can redefine the properties of an address. In the example, we simply define <code class="docutils literal notranslate"><span class="pre">address</span></code> but we could also define <code class="docutils literal notranslate"><span class="pre">pscheduler-address</span></code>, <code class="docutils literal notranslate"><span class="pre">lead-bind-address</span></code>, <code class="docutils literal notranslate"><span class="pre">contexts</span></code>, <code class="docutils literal notranslate"><span class="pre">_meta</span></code> or most of the other <em>address</em> properties. That being said, this new address object has a few special features worth noting:</p>
<ul class="simple">
<li>An <code class="docutils literal notranslate"><span class="pre">address</span></code> property OR a <code class="docutils literal notranslate"><span class="pre">labels</span></code> property are required. This means that unlike the parent <em>address</em> object, an <code class="docutils literal notranslate"><span class="pre">address</span></code> property is not strictly required. See <a class="reference internal" href="#psconfig-templates-advanced-addresses-labels"><span class="std std-ref">Labeling Address Properties</span></a> for a discussion on labels.</li>
<li>If <code class="docutils literal notranslate"><span class="pre">disabled</span></code> or <code class="docutils literal notranslate"><span class="pre">no-agent</span></code> are set to <code class="docutils literal notranslate"><span class="pre">true</span></code> in the parent <em>address</em> object, then the address objects in <code class="docutils literal notranslate"><span class="pre">remote-addresses</span></code> will inherit these values and they cannot be overriden. If they are <code class="docutils literal notranslate"><span class="pre">false</span></code> or unspecified in the parent, a <code class="docutils literal notranslate"><span class="pre">remote-addresses</span></code> entry can set them to <code class="docutils literal notranslate"><span class="pre">true</span></code> to enable them for just that remote pairing.</li>
<li>You can not define the <code class="docutils literal notranslate"><span class="pre">host</span></code> property in a <code class="docutils literal notranslate"><span class="pre">remote-addresses</span></code> object. This object is considered to belong to the same host as the parent.</li>
<li>Unless otherwise noted above, the objects in <code class="docutils literal notranslate"><span class="pre">remote-addresses</span></code> do not inherit values from the parent. For example, if you have <code class="docutils literal notranslate"><span class="pre">pscheduler-address</span></code> defined in parent and you want an object in <code class="docutils literal notranslate"><span class="pre">remote-addresses</span></code> to use the same <code class="docutils literal notranslate"><span class="pre">pscheduler-address</span></code>, then you need to define it again it in the new object.</li>
</ul>
<p>When addresses are paired together by a group, agents will first look in the <code class="docutils literal notranslate"><span class="pre">remote-addresses</span></code> object for the name of the other address in the pair. If it finds one, it will use that address object instead of the default. If it does not find one, it will instead use the top-level address object and ignore <code class="docutils literal notranslate"><span class="pre">remote-addresses</span></code>. Looking back at our example, the table below details the pairings generated and the values of the <a class="reference internal" href="psconfig_templates_vars.html#psconfig-templates-vars-address"><span class="std std-ref">address template variable</span></a>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="36%" />
<col width="32%" />
<col width="32%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Address Pair Names</th>
<th class="head">{% address[0] %}</th>
<th class="head">{% address[1] %}</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>host1, host2</td>
<td>10.1.1.1</td>
<td>10.1.1.2</td>
</tr>
<tr class="row-odd"><td>host1, host3</td>
<td>10.0.0.1</td>
<td>10.0.0.2</td>
</tr>
<tr class="row-even"><td>host1, host4</td>
<td>10.2.2.1</td>
<td>10.2.2.2</td>
</tr>
<tr class="row-odd"><td>host2, host1</td>
<td>10.1.1.2</td>
<td>10.1.1.1</td>
</tr>
<tr class="row-even"><td>host3, host1</td>
<td>10.0.0.2</td>
<td>10.0.0.1</td>
</tr>
<tr class="row-odd"><td>host4, host1</td>
<td>10.2.2.2</td>
<td>10.2.2.1</td>
</tr>
</tbody>
</table>
<p>This introduces the basics of <code class="docutils literal notranslate"><span class="pre">remote-addresses</span></code>, but there are still more cases to consider such as:</p>
<ul class="simple">
<li>What if we want an address pair to use different properties dependent on not just the other member in the pair but also the group it is in?</li>
<li>What if we want a group to only include pairs that have entries in <code class="docutils literal notranslate"><span class="pre">remote-addresses</span></code> and automatically skip other pairs?</li>
</ul>
<p>For these cases we need another construct called <code class="docutils literal notranslate"><span class="pre">labels</span></code> introduced in the <a class="reference internal" href="#psconfig-templates-advanced-addresses-labels"><span class="std std-ref">next section</span></a>.</p>
</div>
<div class="section" id="labeling-address-properties">
<span id="psconfig-templates-advanced-addresses-labels"></span><h3>Labeling Address Properties<a class="headerlink" href="#labeling-address-properties" title="Permalink to this headline">¶</a></h3>
<p>When building templates, there are advanced use cases where we want an <em>address</em> object to express a certain set of properties depending on how it is being used. Often times we can do this by creating separate <em>address</em> objects and including the one with the properties we want in the corresponding group. Unfortunately that’s not always as clear or still sometimes doesn’t capture the goal (particularly if <a class="reference internal" href="#psconfig-templates-advanced-addresses-remote-addresses"><span class="std std-ref">remote-addresses</span></a> are involved).  Furthermore, we sometimes want our task topology to be <em>sparse</em>, meaning each member in the group only tests to a few others and ignores the rest. This can be accomplished with structures such as the <em>group</em> <a class="reference internal" href="#psconfig-templates-advanced-groups-excludes"><span class="std std-ref">excludes</span></a> property, but those can also get difficult to maintain overtime. To assist with these cases, <em>address</em> objects have the <code class="docutils literal notranslate"><span class="pre">labels</span></code> property.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">labels</span></code> property of an <em>address</em> object gives an additional criteria on which we can choose the properties expressed by an <em>address</em>. Let’s take a look at an example where we have a set of <em>address</em> objects representing a server with the following characteristics:</p>
<blockquote>
<div><ul class="simple">
<li>All the servers have 1Gbps interfaces</li>
<li>Only some have 10Gbps interfaces</li>
<li>One of the servers has two 10Gbps interfaces</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Using separate address objects is probably the cleanest way to build a template to meet this goal. The example that follows is a useful learning tool for demonstrating how <code class="docutils literal notranslate"><span class="pre">labels</span></code> work in pSConfig even if it is not the most efficient solution.</p>
</div>
<p>We could do the following where the 1Gbps interfaces is represented by the top-level <code class="docutils literal notranslate"><span class="pre">address</span></code> property and the 10Gbps interfaces are in labels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;thr1&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr1.perfsonar.net&quot;</span><span class="p">,</span>
            <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;10gbps&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr1-10g.perfsonar.net&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;thr2&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr2.perfsonar.net&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;thr3&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr3.perfsonar.net&quot;</span><span class="p">,</span>
            <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;10gbps&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr3-10g.perfsonar.net&quot;</span>
                <span class="p">},</span>
                <span class="s2">&quot;10gbps-secondary&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr3-10g-2.perfsonar.net&quot;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;groups&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;10gbps_group&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;mesh&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default-address-label&quot;</span><span class="p">:</span> <span class="s2">&quot;10gbps&quot;</span><span class="p">,</span>
            <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
                 <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;thr1&quot;</span><span class="p">},</span>
                 <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;thr2&quot;</span><span class="p">},</span>
                 <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;thr3&quot;</span><span class="p">},</span>
                 <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;thr3&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;10gbps-secondary&quot;</span><span class="p">}</span>
             <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>First let’s breakdown the JSON above:</p>
<ul class="simple">
<li>The addresses <code class="docutils literal notranslate"><span class="pre">thr1</span></code> and <code class="docutils literal notranslate"><span class="pre">thr3</span></code> both have a label named <code class="docutils literal notranslate"><span class="pre">10gbps</span></code> defined.</li>
<li><code class="docutils literal notranslate"><span class="pre">thr2</span></code> has no labels defined.</li>
<li><code class="docutils literal notranslate"><span class="pre">thr3</span></code> has a second label defined named <code class="docutils literal notranslate"><span class="pre">10gbps-secondary</span></code>.</li>
<li>The group defines a <code class="docutils literal notranslate"><span class="pre">default-address-label</span></code> of <code class="docutils literal notranslate"><span class="pre">10gbps</span></code>. This includes any address referenced that has a label of <code class="docutils literal notranslate"><span class="pre">10gbps</span></code>. Any address without this label and that doesn’t specify an alternative label will be ignored as if it were not in the list at all. In other words, <code class="docutils literal notranslate"><span class="pre">thr2</span></code> will be skipped.</li>
<li>The final address selector in the group specifies a label of <code class="docutils literal notranslate"><span class="pre">10gbps-secondary</span></code> in addition to a name. This overrides the <code class="docutils literal notranslate"><span class="pre">default-address-label</span></code> and chooses the address specified by the name and label combination.</li>
</ul>
<p>The table below illustrates the generated address pairings and the values of the <a class="reference internal" href="psconfig_templates_vars.html#psconfig-templates-vars-address"><span class="std std-ref">address template variable</span></a>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">{% address[0] %}</th>
<th class="head">{% address[1] %}</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>thr1-10g.perfsonar.net</td>
<td>thr3-10g.perfsonar.net</td>
</tr>
<tr class="row-odd"><td>thr1-10g.perfsonar.net</td>
<td>thr3-10g-2.perfsonar.net</td>
</tr>
<tr class="row-even"><td>thr3-10g.perfsonar.net</td>
<td>thr1-10g.perfsonar.net</td>
</tr>
<tr class="row-odd"><td>thr3-10g-2.perfsonar.net</td>
<td>thr1-10g.perfsonar.net</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you are wondering why thr3-10g.perfsonar.net and thr3-10g-2.perfsonar.net are not a generated pair, see the discusion on <code class="docutils literal notranslate"><span class="pre">excludes-self</span></code> in <a class="reference internal" href="#psconfig-templates-advanced-groups-excludes"><span class="std std-ref">Excluding Address Pairs</span></a></p>
</div>
<p>Where labels are generally more practical is when combined with the <code class="docutils literal notranslate"><span class="pre">remote-addresses</span></code> property. Consider the diagram below:</p>
<div class="figure align-center" id="id4">
<img alt="_images/psconfig_templates_advanced_labels-network.png" src="_images/psconfig_templates_advanced_labels-network.png" />
<p class="caption"><span class="caption-text"><em>A network of four hosts where hosts communicate on private subnets and only between certain host pairs</em></span></p>
</div>
<p>A breakdown of the task topology in the diagram is as follows:</p>
<ul class="simple">
<li><em>host1</em> only tests to <em>host3</em></li>
<li><em>host2</em> tests to <em>host3</em> and <em>host4</em> - in fact it has two sets of addresses it can use to test with <em>host4</em></li>
</ul>
<p>If we want to define this task topology using a single <em>group</em> object, we can’t simply use <code class="docutils literal notranslate"><span class="pre">remote-addresses</span></code>. The reason for this is that we want a sparse task topology where a number of the pairs are ignored. We could potentially get around that with an <a class="reference internal" href="#psconfig-templates-advanced-groups-excludes"><span class="std std-ref">excludes</span></a> property in a <em>group</em> but not only is that more verbose than we need, but it doesn’t help us with the fact that <em>host2</em> and <em>host4</em> test to each other twice. The answer to solving all these issues is to define <code class="docutils literal notranslate"><span class="pre">remote-addresses</span></code> that contain <code class="docutils literal notranslate"><span class="pre">labels</span></code>. An example <code class="docutils literal notranslate"><span class="pre">addresses</span></code> and <code class="docutils literal notranslate"><span class="pre">groups</span></code> section of the required template is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;host1&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;host1.perfsonar.net&quot;</span><span class="p">,</span>
            <span class="s2">&quot;remote-addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;host3&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;private&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.1&quot;</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;host2&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;host2.perfsonar.net&quot;</span><span class="p">,</span>
            <span class="s2">&quot;remote-addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;host3&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;private&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.1.1.1&quot;</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="s2">&quot;host4&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;private&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.2.2.1&quot;</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;private-secondary&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.3.1&quot;</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;host3&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;host3.perfsonar.net&quot;</span><span class="p">,</span>
            <span class="s2">&quot;remote-addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;host1&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;private&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.0.0.2&quot;</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="s2">&quot;host2&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;private&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.1.1.2&quot;</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;host4&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;host4.perfsonar.net&quot;</span><span class="p">,</span>
            <span class="s2">&quot;remote-addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;host2&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;private&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.2.2.2&quot;</span>
                        <span class="p">},</span>
                        <span class="s2">&quot;private-secondary&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;10.3.3.2&quot;</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>

    <span class="s2">&quot;groups&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;labels_example&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;mesh&quot;</span><span class="p">,</span>
            <span class="s2">&quot;default-address-label&quot;</span><span class="p">:</span> <span class="s2">&quot;private&quot;</span><span class="p">,</span>
            <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;host1&quot;</span> <span class="p">},</span>
                <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;host2&quot;</span> <span class="p">},</span>
                <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;host2&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;private-secondary&quot;</span> <span class="p">},</span>
                <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;host3&quot;</span> <span class="p">},</span>
                <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;host4&quot;</span> <span class="p">},</span>
                <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;host4&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="s2">&quot;private-secondary&quot;</span>  <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The table below illustrates the generated address pairings and the values of the <a class="reference internal" href="psconfig_templates_vars.html#psconfig-templates-vars-address"><span class="std std-ref">address template variable</span></a>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="25%" />
<col width="24%" />
<col width="24%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Address Pair Names</th>
<th class="head">Label</th>
<th class="head">{% address[0] %}</th>
<th class="head">{% address[1] %}</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>host1, host3</td>
<td>private</td>
<td>10.0.0.1</td>
<td>10.0.0.2</td>
</tr>
<tr class="row-odd"><td>host2, host3</td>
<td>private</td>
<td>10.1.1.1</td>
<td>10.1.1.2</td>
</tr>
<tr class="row-even"><td>host2, host4</td>
<td>private</td>
<td>10.2.2.1</td>
<td>10.2.2.2</td>
</tr>
<tr class="row-odd"><td>host2, host4</td>
<td>private-secondary</td>
<td>10.3.3.1</td>
<td>10.3.3.2</td>
</tr>
<tr class="row-even"><td>host3, host1</td>
<td>private</td>
<td>10.0.0.2</td>
<td>10.0.0.1</td>
</tr>
<tr class="row-odd"><td>host3, host2</td>
<td>private</td>
<td>10.1.1.2</td>
<td>10.1.1.1</td>
</tr>
<tr class="row-even"><td>host4, host2</td>
<td>private</td>
<td>10.2.2.2</td>
<td>10.2.2.1</td>
</tr>
<tr class="row-odd"><td>host4, host2</td>
<td>private-secondary</td>
<td>10.3.3.2</td>
<td>10.3.3.1</td>
</tr>
</tbody>
</table>
<p>Note that it automatically skips combinations where there is no remote-address entry or no label matching either the <code class="docutils literal notranslate"><span class="pre">label</span></code> in the address selector if specified or the <code class="docutils literal notranslate"><span class="pre">default-address-label</span></code> if not specified.</p>
<p>The usage of <code class="docutils literal notranslate"><span class="pre">labels</span></code> by themselves or within <code class="docutils literal notranslate"><span class="pre">remote-addresses</span></code> allow for a number of possibilities with regards to dynamically changing properties of addresses. The section showed a few of those and hopefully has provided a foundation for adapting to other use cases.</p>
</div>
</div>
<div class="section" id="sharing-address-properties-with-hosts">
<span id="psconfig-templates-advanced-hosts"></span><h2>Sharing Address Properties with <code class="docutils literal notranslate"><span class="pre">hosts</span></code><a class="headerlink" href="#sharing-address-properties-with-hosts" title="Permalink to this headline">¶</a></h2>
<div class="section" id="introduction-to-hosts">
<span id="psconfig-templates-advanced-hosts-intro"></span><h3>Introduction to <code class="docutils literal notranslate"><span class="pre">hosts</span></code><a class="headerlink" href="#introduction-to-hosts" title="Permalink to this headline">¶</a></h3>
<p>Often times, multiple <em>address</em> objects have a shared set of properties. For example, if you have two <em>address</em> objects representing network interfaces on the same physical system, and that system is not running an agent, then you want to set the <a class="reference internal" href="#psconfig-templates-advanced-addresses-noagent"><span class="std std-ref">no-agent</span></a> property. You could define it twice (once in each <em>address</em> object) or you could define a <em>host</em> object.</p>
<p>In pSConfig, a <strong>host</strong> is an object containing properties shared between one or more addresses. A <em>host</em> object is defined in the <code class="docutils literal notranslate"><span class="pre">hosts</span></code> section of a template. For our <code class="docutils literal notranslate"><span class="pre">no-agent</span></code> use case, an example <em>host</em> object could be represented in the <code class="docutils literal notranslate"><span class="pre">hosts</span></code> section as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;hosts&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;thrlat2&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;no-agent&quot;</span><span class="p">:</span> <span class="n">true</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>An <em>address</em> object can indicate it belongs to a particular <em>host</em> object using the <code class="docutils literal notranslate"><span class="pre">host</span></code> property. Below is an example <code class="docutils literal notranslate"><span class="pre">addresses</span></code> section using the <em>host</em> above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;thr2&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr2.perfsonar.net&quot;</span><span class="p">,</span>
        <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;thrlat2&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;lat2&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;lat2.perfsonar.net&quot;</span><span class="p">,</span>
        <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;thrlat2&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Each address can only belong to one <em>host</em> object. Also a <em>host</em> object has no required properties (i.e. an empty object <code class="docutils literal notranslate"><span class="pre">{}</span></code> is a valid <em>host</em>). You can see the following sections for some uses of <em>host</em> objects and their properties:</p>
<ul class="simple">
<li>For information on setting a archives to be used anytime an <em>address</em> object belonging to a <em>host</em> is the <a class="reference internal" href="psconfig_templates_vars.html#psconfig-templates-vars-scheduled-by-address"><span class="std std-ref">scheduled_by_address</span></a> see <a class="reference internal" href="#psconfig-templates-advanced-hosts-archives"><span class="std std-ref">Setting Host Archives</span></a></li>
<li>For information on disabling all the addresses belonging to a host, see <a class="reference internal" href="#psconfig-templates-advanced-hosts-disabled"><span class="std std-ref">Disabling a Host</span></a></li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See the <a class="reference external" href="https://raw.githubusercontent.com/perfsonar/psconfig/master/doc/psconfig-schema.json">pSConfig Template JSON Schema</a> for a full list of options supported by the <em>host</em> object.</p>
</div>
</div>
<div class="section" id="setting-host-archives">
<span id="psconfig-templates-advanced-hosts-archives"></span><h3>Setting Host Archives<a class="headerlink" href="#setting-host-archives" title="Permalink to this headline">¶</a></h3>
<p>A <em>host</em> object supports setting one or more archives to be used anytime an address belonging to that <em>host</em> is is the <a class="reference internal" href="psconfig_templates_vars.html#psconfig-templates-vars-scheduled-by-address"><span class="std std-ref">scheduled_by_address</span></a> of an individual task. It does this through the <code class="docutils literal notranslate"><span class="pre">archives</span></code> property which accepts a list of <em>archive</em> object names.</p>
<p>For example, you can set a an archive that publishes results to an esmond instance running on <code class="docutils literal notranslate"><span class="pre">thrlat2-archive.perfsonar.net</span></code> anytime either <code class="docutils literal notranslate"><span class="pre">thr2.perfsonar.net</span></code> or <code class="docutils literal notranslate"><span class="pre">lat2.perfsonar.net</span></code> is responsible for scheduling a task:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;archives&quot;</span><span class="p">:</span> <span class="p">{</span>
       <span class="s2">&quot;local_archive&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;archiver&quot;</span><span class="p">:</span> <span class="s2">&quot;esmond&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://thrlat2-archive.perfsonar.net/esmond/perfsonar/archive&quot;</span><span class="p">,</span>
                <span class="s2">&quot;measurement-agent&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="si">% s</span><span class="s2">cheduled_by_address %}&quot;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>

    <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;thr2&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr2.perfsonar.net&quot;</span><span class="p">,</span>
            <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;thrlat2&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;lat2&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;lat2.perfsonar.net&quot;</span><span class="p">,</span>
            <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;thrlat2&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>

    <span class="s2">&quot;hosts&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;thrlat2&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;archives&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;local_archive&quot;</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Archives defined in this way will only be used when the <em>address</em> objects belonging to a host are the <a class="reference internal" href="psconfig_templates_vars.html#psconfig-templates-vars-scheduled-by-address"><span class="std std-ref">scheduled_by_address</span></a>. This means that the archive will not be used for a host pair where they are not involved or where another address is responsible for scheduling.</p>
<p>Also, if the <em>task</em> <code class="docutils literal notranslate"><span class="pre">archives</span></code> property is defined and the <em>host</em> <code class="docutils literal notranslate"><span class="pre">archives</span></code> property applies, then the two lists will be merged. If a task <code class="docutils literal notranslate"><span class="pre">archives</span></code> property and a host <code class="docutils literal notranslate"><span class="pre">archives</span></code> property both point at the same <em>archive</em> object, that object will only be used once (i.e. results will not get published twice to the same archive).</p>
</div>
<div class="section" id="disabling-a-host">
<span id="psconfig-templates-advanced-hosts-disabled"></span><h3>Disabling a Host<a class="headerlink" href="#disabling-a-host" title="Permalink to this headline">¶</a></h3>
<p>If you want to temporarily suspend all tasks involving all addresses associated with a host, then you can use the <em>host</em> <code class="docutils literal notranslate"><span class="pre">disabled</span></code> property. This functions exactly the same as if you were to individually set the <a class="reference internal" href="#psconfig-templates-advanced-addresses-disabled"><span class="std std-ref">address disabled property</span></a> for each <em>address</em> belonging to a host. An example is below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;hosts&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;thrlat2&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;disabled&quot;</span><span class="p">:</span> <span class="n">true</span>
        <span class="p">}</span>
    <span class="p">},</span>

    <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;thr2&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr2.perfsonar.net&quot;</span><span class="p">,</span>
            <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;thrlat2&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;lat2&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;lat2.perfsonar.net&quot;</span><span class="p">,</span>
            <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;thrlat2&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="including-external-files">
<span id="psconfig-templates-advanced-includes"></span><h2>Including External Files<a class="headerlink" href="#including-external-files" title="Permalink to this headline">¶</a></h2>
<p>pSConfig templates support including external files through the use of the <code class="docutils literal notranslate"><span class="pre">includes</span></code> property. The <code class="docutils literal notranslate"><span class="pre">includes</span></code> property goes at the top-level of the template and is an array of URLs to <em>include files</em>. It is important to keep the following in mind when using <code class="docutils literal notranslate"><span class="pre">includes</span></code> in your template:</p>
<ul class="simple">
<li>Include files are processed in the order they are specified in the <code class="docutils literal notranslate"><span class="pre">includes</span></code> property</li>
<li>An include file MUST be reachable by the agent(s) reading the template. For remote agents this means the URL must be available via http or https. If your template is one that will only be read by an agent on the local file system, then it is possible to use URLs pointing at local files by either specifying the full file path or using the <code class="docutils literal notranslate"><span class="pre">file://</span></code> prefix in the URL.</li>
<li>A template with an <code class="docutils literal notranslate"><span class="pre">includes</span></code> section MUST validate against the <a class="reference external" href="https://raw.githubusercontent.com/perfsonar/psconfig/master/doc/psconfig-schema.json">pSConfig Template JSON Schema</a> both prior to including the file and after including the file. If, for example, all your <code class="docutils literal notranslate"><span class="pre">addresses</span></code> live in an include file, you still need to provide an empty object <code class="docutils literal notranslate"><span class="pre">{}</span></code> in the base template.</li>
<li>An include file does NOT need to validate against the <a class="reference external" href="https://raw.githubusercontent.com/perfsonar/psconfig/master/doc/psconfig-schema.json">pSConfig Template JSON Schema</a>. Instead it can be a partial template containing one or more of the following sections: <cite>addresses</cite>, <cite>address-classes</cite>, <cite>archives</cite>, <cite>contexts</cite>, <cite>groups</cite>, <cite>hosts</cite>, <cite>schedules</cite>, <cite>tasks</cite>, and/or <cite>tests</cite>.</li>
<li>The sections from the include file will be merged into the corresponding section of the base template. If during a merge an object (e.g. an individual <em>address</em> object) has the same name as an object already in the template, the object from the include file will be ignored.</li>
</ul>
<p>To better illustrate the points above, let’s look at an example using includes to recreate the JSON template from the <a class="reference internal" href="psconfig_templates_intro.html#psconfig-templates-intro-example"><span class="std std-ref">template introduction</span></a> that can be downloaded <a class="reference download internal" download="" href="_downloads/ba59307fbb00b493a45e7c5eb4e8c64e/psconfig_templates_intro-network.json"><code class="xref download docutils literal notranslate"><span class="pre">here</span></code></a>. Let’s define two template files, one that defines the latency <code class="docutils literal notranslate"><span class="pre">addresses</span></code> and <code class="docutils literal notranslate"><span class="pre">groups</span></code> and another that defines the throughput <code class="docutils literal notranslate"><span class="pre">addresses</span></code> and <code class="docutils literal notranslate"><span class="pre">groups</span></code>.</p>
<p>The latency include file is below (we’ll assume it lives at <code class="docutils literal notranslate"><span class="pre">https://example.perfsonar.net/psconfig/includes/latency.json</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lat1&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;lat1.perfsonar.net&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;thrlat1&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thrlat1.perfsonar.net&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;lat2&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;lat2.perfsonar.net&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;groups&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;latency_group&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;mesh&quot;</span><span class="p">,</span>
            <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
                 <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;lat1&quot;</span><span class="p">},</span>
                 <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;thrlat1&quot;</span><span class="p">},</span>
                 <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;lat2&quot;</span><span class="p">}</span>
             <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The throughput include file is below (we’ll assume it lives at <code class="docutils literal notranslate"><span class="pre">https://example.perfsonar.net/psconfig/includes/throughput.json</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;thr1&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr1.perfsonar.net&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;thrlat1&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thrlat1.perfsonar.net&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;thr2&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr2.perfsonar.net&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;groups&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;throughput_group&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;mesh&quot;</span><span class="p">,</span>
            <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
                 <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;thr1&quot;</span><span class="p">},</span>
                 <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;thrlat1&quot;</span><span class="p">},</span>
                 <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;thr2&quot;</span><span class="p">}</span>
             <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Finally we build our base template that includes the files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;includes&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;https://example.perfsonar.net/psconfig/includes/latency.json&quot;</span><span class="p">,</span>
        <span class="s2">&quot;https://example.perfsonar.net/psconfig/includes/throughput.json&quot;</span>
    <span class="p">],</span>
    <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="s2">&quot;groups&quot;</span><span class="p">:</span> <span class="p">{},</span>
    <span class="s2">&quot;tests&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;latency_test&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;latencybg&quot;</span><span class="p">,</span>
            <span class="s2">&quot;spec&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;{% address[0] %}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;dest&quot;</span><span class="p">:</span> <span class="s2">&quot;{% address[1] %}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;packet-interval&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="s2">&quot;packet-count&quot;</span><span class="p">:</span> <span class="mi">600</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;throughput_test&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;throughput&quot;</span><span class="p">,</span>
            <span class="s2">&quot;spec&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;{% address[0] %}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;dest&quot;</span><span class="p">:</span> <span class="s2">&quot;{% address[1] %}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="s2">&quot;PT30S&quot;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;archives&quot;</span><span class="p">:</span> <span class="p">{</span>
       <span class="s2">&quot;esmond_archive&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;archiver&quot;</span><span class="p">:</span> <span class="s2">&quot;esmond&quot;</span><span class="p">,</span>
            <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="s2">&quot;https://esmond.archive.perfsonar.net/esmond/perfsonar/archive&quot;</span><span class="p">,</span>
                <span class="s2">&quot;measurement-agent&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="si">% s</span><span class="s2">cheduled_by_address %}&quot;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;schedules&quot;</span><span class="p">:</span> <span class="p">{</span>
       <span class="s2">&quot;every_4_hours&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;repeat&quot;</span><span class="p">:</span> <span class="s2">&quot;PT4H&quot;</span><span class="p">,</span>
            <span class="s2">&quot;slip&quot;</span><span class="p">:</span> <span class="s2">&quot;PT4H&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sliprand&quot;</span><span class="p">:</span> <span class="n">true</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;tasks&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;latency_task&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;latency_group&quot;</span><span class="p">,</span>
            <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;latency_test&quot;</span><span class="p">,</span>
            <span class="s2">&quot;archives&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;esmond_archive&quot;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="s2">&quot;throughput_task&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;throughput_group&quot;</span><span class="p">,</span>
            <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;throughput_test&quot;</span><span class="p">,</span>
            <span class="s2">&quot;archives&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;esmond_archive&quot;</span><span class="p">],</span>
            <span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="s2">&quot;every_4_hours&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>It is worth noting the following about the template above:</p>
<ul class="simple">
<li>The <code class="docutils literal notranslate"><span class="pre">includes</span></code> section points at two URLs accessible by remote agents using https</li>
<li>The include files both contain only a <code class="docutils literal notranslate"><span class="pre">groups</span></code> and <code class="docutils literal notranslate"><span class="pre">addresses</span></code> section since there is no requirement they be a complete template</li>
<li>The base template MUST validate prior to merging the include files, so there are empty <code class="docutils literal notranslate"><span class="pre">addresses</span></code> and <code class="docutils literal notranslate"><span class="pre">groups</span></code> since those are required by the schema.</li>
<li>Both include files contain an <em>address</em> object named <code class="docutils literal notranslate"><span class="pre">thrlat1</span></code>. The address will only be included once. Since the latency include file is listed first in our <code class="docutils literal notranslate"><span class="pre">includes</span></code> section, that definition will be used.</li>
</ul>
</div>
<div class="section" id="using-contexts">
<span id="psconfig-templates-advanced-contexts"></span><h2>Using <code class="docutils literal notranslate"><span class="pre">contexts</span></code><a class="headerlink" href="#using-contexts" title="Permalink to this headline">¶</a></h2>
<p>pSConfig allows for the use of a pScheduler supported construct called a context. Contexts are named as such because they allow certain user-specified changes to the execution context prior to execution of that tool running a test. Just like tests, tools and archives, contexts are defined by plug-ins of which pSConfig does not have detailed knowledge. As such, any context your pScheduler server can support, pSConfig can also support.</p>
<p>pSConfig allows you to define <em>context</em> objects in the <code class="docutils literal notranslate"><span class="pre">contexts</span></code> section of a template. These <em>context</em> objects are named and can be referenced by an <em>address</em> object. When a pScheduler agent is building a task, it will check the list of addresses generated by a group for context definitions. If it finds any, then it will pass them to pScheduler. The schema of a <em>context</em> in pSConfig matches that of pScheduler (with additional support for an optional <code class="docutils literal notranslate"><span class="pre">_meta</span></code> field). Each <em>context</em> has a <code class="docutils literal notranslate"><span class="pre">context</span></code> property indicating the type and a <code class="docutils literal notranslate"><span class="pre">data</span></code> property with type-specific options. An example of a <code class="docutils literal notranslate"><span class="pre">linuxnns</span></code> context and how to associate its address objects is shown in the example below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;contexts&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;linuxnns_ou812&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;context&quot;</span><span class="p">:</span> <span class="s2">&quot;linuxnns&quot;</span><span class="p">,</span>
        <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;ou812&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">},</span>

<span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;thr1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr1.perfsonar.net&quot;</span><span class="p">,</span>
        <span class="s2">&quot;contexts&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;linuxnns_ou812&quot;</span> <span class="p">]</span>
    <span class="p">},</span>
    <span class="s2">&quot;thr2&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr2.perfsonar.net&quot;</span><span class="p">,</span>
        <span class="s2">&quot;contexts&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;linuxnns_ou812&quot;</span> <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the current form of pSConfig’s context usage, you need to be careful when using contexts not to unintentionally create invalid pScheduler tasks. In particular, since pSConfig does not know which tests are single participant tests vs. multi-participant in pScheduler terms, then it blindly creates context definitions for any <em>address</em> involved in a task. This can cause invalid pScheduler task specifications, particularly in single-participant tests. It also assumes the context of the first address in a pair is the first participant, that of the second is the second participant and so forth. If this is not how you arranged your test it can cause unexpected results.</p>
<p>You need to be very selective where you use contexts and may consider using a construct such as <a class="reference internal" href="#psconfig-templates-advanced-addresses-labels"><span class="std std-ref">address labels</span></a> to allow explicit selection of a version of an <em>address</em> object with or without contexts. An example that defines the default version of an address with no <code class="docutils literal notranslate"><span class="pre">contexts</span></code> and a label that does have <code class="docutils literal notranslate"><span class="pre">contexts</span></code> is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;thr1&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr1.perfsonar.net&quot;</span><span class="p">,</span>
        <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;with_context&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr1.perfsonar.net&quot;</span><span class="p">,</span>
                <span class="s2">&quot;contexts&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;linuxnns_ou812&quot;</span> <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;thr2&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr2.perfsonar.net&quot;</span><span class="p">,</span>
        <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;with_context&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thr2.perfsonar.net&quot;</span><span class="p">,</span>
                <span class="s2">&quot;contexts&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="s2">&quot;linuxnns_ou812&quot;</span> <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="advanced-groups-options">
<span id="psconfig-templates-advanced-groups"></span><h2>Advanced <code class="docutils literal notranslate"><span class="pre">groups</span></code> Options<a class="headerlink" href="#advanced-groups-options" title="Permalink to this headline">¶</a></h2>
<div class="section" id="excluding-address-pairs">
<span id="psconfig-templates-advanced-groups-excludes"></span><h3>Excluding Address Pairs<a class="headerlink" href="#excluding-address-pairs" title="Permalink to this headline">¶</a></h3>
<p>As described in the <a class="reference internal" href="psconfig_templates_intro.html#psconfig-templates-intro-concepts-groups"><span class="std std-ref">introduction to groups</span></a>,
both <em>mesh</em> and <em>disjoint</em> group types have a base set of address pairs they generate when building tasks. Both group types also allow you to modify this base set of address pairs using an optional <code class="docutils literal notranslate"><span class="pre">excludes</span></code> property. This property allows you to remove any address pair from the final list, giving you significant flexibility in defining your task topology.</p>
<p>And example of the <code class="docutils literal notranslate"><span class="pre">excludes</span></code> property in a group is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;latency_group&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;mesh&quot;</span><span class="p">,</span>
    <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
         <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;lat1&quot;</span><span class="p">},</span>
         <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;thrlat1&quot;</span><span class="p">},</span>
         <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;lat2&quot;</span><span class="p">}</span>
     <span class="p">],</span>
     <span class="s2">&quot;excludes&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;local-address&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;lat2&quot;</span> <span class="p">},</span>
            <span class="s2">&quot;target-addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;lat1&quot;</span><span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the example, a pair will be excluded where the address named <code class="docutils literal notranslate"><span class="pre">lat2</span></code> is the first address in the pair (as indicated by the <code class="docutils literal notranslate"><span class="pre">local-address</span></code> property) and <code class="docutils literal notranslate"><span class="pre">lat1</span></code> is the second address in the pair (as indicated by the <code class="docutils literal notranslate"><span class="pre">target-addresses</span></code> property). Notice that both properties accept <em>address selector</em> objects. The order of the addresses matter, so in the example above the pair where <code class="docutils literal notranslate"><span class="pre">lat1</span></code> is the first address and <code class="docutils literal notranslate"><span class="pre">lat2</span></code> is the second address will stil be included in the final task list. In other words, for each object in <code class="docutils literal notranslate"><span class="pre">excludes</span></code>, the <code class="docutils literal notranslate"><span class="pre">local-address</span></code> will always be compared against the first address in the pair and if it matches, the <code class="docutils literal notranslate"><span class="pre">target-addresses</span></code> will be compared sequentially against the second address until one matches or the end of list is reached. If a match is not found then the test will be included.</p>
<p>Both <em>mesh</em> and <em>disjoint</em> support another exclusion property called <code class="docutils literal notranslate"><span class="pre">excludes-self</span></code> for use when a <em>group</em> includes two addresses from the same <a class="reference internal" href="#psconfig-templates-advanced-hosts"><span class="std std-ref">host</span></a> OR from different <a class="reference internal" href="#psconfig-templates-advanced-addresses-labels"><span class="std std-ref">labels</span></a> in the same <em>address</em> object. The <code class="docutils literal notranslate"><span class="pre">excludes-self</span></code> property is an enumerated string supporting the following values:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">host</span></code> excludes any address pair where both addresses are from the same <em>host</em> object and/or from different labels in the same <em>address</em> object. <strong>This is the default behavior.</strong></li>
<li><code class="docutils literal notranslate"><span class="pre">address</span></code> excludes any address pair where both addresses are from different labels in the same <em>address</em> object, but will include pairs where the addresses belong to the same <em>host</em>.</li>
<li><code class="docutils literal notranslate"><span class="pre">disabled</span></code> includes all address pairs.</li>
</ul>
<p>An example showing the default behavior is below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;latency_group&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;mesh&quot;</span><span class="p">,</span>
    <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
         <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;lat1&quot;</span><span class="p">},</span>
         <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;thrlat1&quot;</span><span class="p">},</span>
         <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;lat2&quot;</span><span class="p">}</span>
     <span class="p">],</span>
     <span class="s2">&quot;excludes-self&quot;</span><span class="p">:</span> <span class="s2">&quot;host&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="unidirectional-disjoint-groups">
<span id="psconfig-templates-advanced-groups-unidirectional"></span><h3>Unidirectional Disjoint Groups<a class="headerlink" href="#unidirectional-disjoint-groups" title="Permalink to this headline">¶</a></h3>
<p>The <em>disjoint</em> group type generates a list of address pairs where each <em>address</em> in <code class="docutils literal notranslate"><span class="pre">a-addresses</span></code> is paired with each address in <code class="docutils literal notranslate"><span class="pre">b-addresses</span></code>. By default, for each combination this list will include both the following:</p>
<ol class="arabic simple">
<li>The pair where the object from <code class="docutils literal notranslate"><span class="pre">a-addresses</span></code> is listed first and the object from <code class="docutils literal notranslate"><span class="pre">b-addresses</span></code> is second</li>
<li>The pair where the object from <code class="docutils literal notranslate"><span class="pre">b-addresses</span></code> is listed first and the object from <code class="docutils literal notranslate"><span class="pre">a-addresses</span></code> is second.</li>
</ol>
<p>If we only want the combination of addresses where the <code class="docutils literal notranslate"><span class="pre">a-addresses</span></code> object is first and the <code class="docutils literal notranslate"><span class="pre">b-addresses</span></code> is second (item #1 above) then we can use the boolean <code class="docutils literal notranslate"><span class="pre">unidirectional</span></code> property to indicate that fact.</p>
<p>An example of <code class="docutils literal notranslate"><span class="pre">unidirectional</span></code> is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;example-group&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;disjoint&quot;</span><span class="p">,</span>
    <span class="s2">&quot;unidirectional&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;a-addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;host1&quot;</span> <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;b-addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;host2&quot;</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;host3&quot;</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;host4&quot;</span> <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The generated address pairs are as follows:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">host1</span></code>, <code class="docutils literal notranslate"><span class="pre">host2</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">host1</span></code>, <code class="docutils literal notranslate"><span class="pre">host3</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">host1</span></code>, <code class="docutils literal notranslate"><span class="pre">host4</span></code></li>
</ul>
<p>Note that all pairs where <code class="docutils literal notranslate"><span class="pre">host1</span></code> would be the second address are excluded.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">unidirectional</span></code> property is actually just a short-form of an <a class="reference internal" href="#psconfig-templates-advanced-groups-excludes"><span class="std std-ref">excludes</span></a> property containing an object for each address in <code class="docutils literal notranslate"><span class="pre">b-addresses</span></code> where the <code class="docutils literal notranslate"><span class="pre">local-address</span></code> is the <code class="docutils literal notranslate"><span class="pre">b-addressess</span></code> entry and the <code class="docutils literal notranslate"><span class="pre">target-addresses</span></code> is the full list of <code class="docutils literal notranslate"><span class="pre">a-addresses</span></code>.</p>
</div>
</div>
<div class="section" id="disabling-an-address-selector">
<span id="psconfig-templates-advanced-groups-disabled"></span><h3>Disabling an Address Selector<a class="headerlink" href="#disabling-an-address-selector" title="Permalink to this headline">¶</a></h3>
<p>For all group types, if you would like to temporarily suspend use of a particular <em>address selector</em> object from that group without explicitly deleting it, you can use the <code class="docutils literal notranslate"><span class="pre">disabled</span></code> property.</p>
<p>An example of the <code class="docutils literal notranslate"><span class="pre">disabled</span></code> property in an <em>address selector</em> is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;example-group&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;disjoint&quot;</span><span class="p">,</span>
    <span class="s2">&quot;a-addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;host1&quot;</span> <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;b-addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;host2&quot;</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;host3&quot;</span><span class="p">,</span> <span class="s2">&quot;disabled&quot;</span><span class="p">:</span> <span class="n">true</span> <span class="p">},</span>
        <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;host4&quot;</span> <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The generated address pairs are as follows:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">host1</span></code>, <code class="docutils literal notranslate"><span class="pre">host2</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">host1</span></code>, <code class="docutils literal notranslate"><span class="pre">host4</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">host2</span></code>, <code class="docutils literal notranslate"><span class="pre">host1</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">host4</span></code>, <code class="docutils literal notranslate"><span class="pre">host1</span></code></li>
</ul>
<p>You can think of this property as a way to “comment-out” an <em>address selector</em> object since JSON does not natively support comments. It is most useful when you don’t want to entirely delete an <em>address selector</em> but need to remove it from a group’s testing for some amount of time.</p>
</div>
</div>
<div class="section" id="advanced-tasks-options">
<h2>Advanced <code class="docutils literal notranslate"><span class="pre">tasks</span></code> Options<a class="headerlink" href="#advanced-tasks-options" title="Permalink to this headline">¶</a></h2>
<div class="section" id="setting-tools-for-a-task">
<span id="psconfig-templates-advanced-tasks-tools"></span><h3>Setting Tools For a Task<a class="headerlink" href="#setting-tools-for-a-task" title="Permalink to this headline">¶</a></h3>
<p>If you would like to specify a preference for a <a class="reference internal" href="pscheduler_intro.html#term-tool"><span class="xref std std-term">tool</span></a> to be used for a particular task, <em>task</em> objects support the <code class="docutils literal notranslate"><span class="pre">tools</span></code> property.</p>
<p>An example of a <code class="docutils literal notranslate"><span class="pre">tools</span></code> property is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;tasks&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;throughput_task&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;tools&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;iperf3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nuttcp&quot;</span>
        <span class="p">],</span>
        <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;throughput_group&quot;</span><span class="p">,</span>
        <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;throughput_test&quot;</span><span class="p">,</span>
        <span class="s2">&quot;archives&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;esmond_archive&quot;</span><span class="p">],</span>
        <span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="s2">&quot;every_4_hours&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The example above states to ask pScheduler to use the <code class="docutils literal notranslate"><span class="pre">iperf3</span></code> tool if possible. If not possible, then check if the <code class="docutils literal notranslate"><span class="pre">nuttcp</span></code> tool is available. If neither is available, then the task will fail to be created. If <code class="docutils literal notranslate"><span class="pre">tools</span></code> is not specified then the tool selection will be determined by the default behavior of the pScheduler server.</p>
</div>
<div class="section" id="setting-task-priority">
<span id="psconfig-templates-advanced-tasks-priority"></span><h3>Setting Task Priority<a class="headerlink" href="#setting-task-priority" title="Permalink to this headline">¶</a></h3>
<p>If you would like to set the priority with which a task will be scheduled by pScheduler with respect to other tasks, then the pSConfig <em>task</em> object supports a <code class="docutils literal notranslate"><span class="pre">priority</span></code> field.</p>
<p>An example of the <code class="docutils literal notranslate"><span class="pre">priority</span></code> field is shown in the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;tasks&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;throughput_task&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;priority&quot;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
        <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;throughput_group&quot;</span><span class="p">,</span>
        <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;throughput_test&quot;</span><span class="p">,</span>
        <span class="s2">&quot;archives&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;esmond_archive&quot;</span><span class="p">],</span>
        <span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="s2">&quot;every_4_hours&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This will pass the priority directly to pScheduler. If not set, then no explicit priority will be given to pScheduler and the pScheduler server will follow it’s default behavior for determining priority.</p>
</div>
<div class="section" id="setting-the-pscheduler-reference-field">
<span id="psconfig-templates-advanced-tasks-reference"></span><h3>Setting the pScheduler <code class="docutils literal notranslate"><span class="pre">reference</span></code> field<a class="headerlink" href="#setting-the-pscheduler-reference-field" title="Permalink to this headline">¶</a></h3>
<p>In pScheduler, tasks support a <code class="docutils literal notranslate"><span class="pre">reference</span></code> field that can be used to store extra information with a task. pScheduler nor its plugins make any use of the field, but it is there for clients querying the pScheduler schedule. It takes the form of an opaque JSON object that’s structure is undefined.</p>
<p>pSConfig allows you to define a reference object to be passed to pScheduler as shown in the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;tasks&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;throughput_task&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;throughput_group&quot;</span><span class="p">,</span>
        <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;throughput_test&quot;</span><span class="p">,</span>
        <span class="s2">&quot;archives&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;esmond_archive&quot;</span><span class="p">],</span>
        <span class="s2">&quot;schedule&quot;</span><span class="p">:</span> <span class="s2">&quot;every_4_hours&quot;</span><span class="p">,</span>
        <span class="s2">&quot;reference&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;production-measurement&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
            <span class="s2">&quot;source_ifspeed&quot;</span><span class="p">:</span> <span class="s2">&quot;{% jq addresses[0]._meta.ifspeed %}&quot;</span><span class="p">,</span>
            <span class="s2">&quot;dest_ifspeed&quot;</span><span class="p">:</span> <span class="s2">&quot;{% jq addresses[1]._meta.ifspeed %}&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the above example we define three custom properties. Properties can use <a class="reference internal" href="psconfig_templates_vars.html"><span class="doc">template variables</span></a> and take whatever form you need as long as:</p>
<ul class="simple">
<li>The resulting <code class="docutils literal notranslate"><span class="pre">reference</span></code> object is valid JSON. This means that properties do not need to by primitive values, they can also be arrays or nested objects.</li>
<li>You don’t include a property named <code class="docutils literal notranslate"><span class="pre">psconfig</span></code> in the top-level of your <code class="docutils literal notranslate"><span class="pre">reference</span></code> object. This is reserved for use by pSConfig agents and your definition will be overwritten.</li>
</ul>
<p>Let’s take a closer look at our example:</p>
<ul class="simple">
<li>The <code class="docutils literal notranslate"><span class="pre">production-measurement</span></code> property is a fixed boolean value of <code class="docutils literal notranslate"><span class="pre">true</span></code>. Presumably a client could interpret this to indicate the measurement is production grade and problems with the results should be handled accordingly.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">source_ifspeed</span></code> and <code class="docutils literal notranslate"><span class="pre">dest_ifspeed</span></code> demonstrate the use of <a class="reference internal" href="psconfig_templates_vars.html#psconfig-templates-vars-jq"><span class="std std-ref">jq template variables</span></a> to grab a <code class="docutils literal notranslate"><span class="pre">_meta</span></code> property from the <em>address</em> objects involved in the tasks</li>
</ul>
<p>That’s all there is to it. The information above should allow you to tailor the <code class="docutils literal notranslate"><span class="pre">reference</span></code> object to your needs.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">reference</span></code> object is different from the <code class="docutils literal notranslate"><span class="pre">_meta</span></code> object in that the <code class="docutils literal notranslate"><span class="pre">_meta</span></code> object is NOT passed to pScheduler. If you want information from a <code class="docutils literal notranslate"><span class="pre">_meta</span></code> object in the <code class="docutils literal notranslate"><span class="pre">reference</span></code> object than you may use <a class="reference internal" href="psconfig_templates_vars.html#psconfig-templates-vars-jq"><span class="std std-ref">jq template variables</span></a>.</p>
</div>
</div>
<div class="section" id="controlling-the-agent-that-schedules-a-task">
<span id="psconfig-templates-advanced-tasks-scheduled-by"></span><h3>Controlling the Agent That Schedules a Task<a class="headerlink" href="#controlling-the-agent-that-schedules-a-task" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="psconfig_pscheduler_agent.html"><span class="doc">pSConfig pScheduler agent</span></a> running on a particular host will determine which tasks it is responsible for scheduling by looking at the generated <em>address</em> objects from a task’s <em>group</em>. By default, the first address in the generated list where <a class="reference internal" href="#psconfig-templates-advanced-addresses-noagent"><span class="std std-ref">no-agent</span></a> is NOT enabled will be used. If you would like to change the behavior, then you can use the pSConfig <em>task</em> object’s <code class="docutils literal notranslate"><span class="pre">scheduled-by</span></code> field.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">scheduled-by</span></code> field is an integer representing the index (starting at 0) of the <em>address</em> object in a generated list to try first. By default, the value is <code class="docutils literal notranslate"><span class="pre">0</span></code>. The following rules are used when interpreting <code class="docutils literal notranslate"><span class="pre">scheduled-by</span></code> and determining responsibility for scheduling a task:</p>
<ul class="simple">
<li>If the address indicated by <code class="docutils literal notranslate"><span class="pre">scheduled-by</span></code> does NOT have <code class="docutils literal notranslate"><span class="pre">no-agent</span></code> enabled, then it is used and no further processing is required.</li>
<li>If the address has <code class="docutils literal notranslate"><span class="pre">no-agent</span></code> enabled, then it will look for the first member of the list after the <code class="docutils literal notranslate"><span class="pre">scheduled-by</span></code> value that does NOT have <code class="docutils literal notranslate"><span class="pre">no-agent</span></code> enabled. It will wrap around to the start of the list if it does not find one before it reaches the end.</li>
<li>If all members are <code class="docutils literal notranslate"><span class="pre">no-agent</span></code>, then the test will be skipped.</li>
</ul>
<p>Let’s look at the following example with two tasks only differing in their <code class="docutils literal notranslate"><span class="pre">scheduled-by</span></code> property:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;lat1&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;lat1.perfsonar.net&quot;</span>
        <span class="p">},</span>
       <span class="s2">&quot;thrlat1&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;thrlat1.perfsonar.net&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;lat2&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;address&quot;</span><span class="p">:</span> <span class="s2">&quot;lat2.perfsonar.net&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;groups&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;latency_group&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;mesh&quot;</span><span class="p">,</span>
            <span class="s2">&quot;addresses&quot;</span><span class="p">:</span> <span class="p">[</span>
                 <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;lat1&quot;</span><span class="p">},</span>
                 <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;thrlat1&quot;</span><span class="p">},</span>
                 <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;lat2&quot;</span><span class="p">}</span>
             <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;tests&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;latency_test&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;latencybg&quot;</span><span class="p">,</span>
            <span class="s2">&quot;spec&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;{% address[0] %}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;dest&quot;</span><span class="p">:</span> <span class="s2">&quot;{% address[1] %}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;flip&quot;</span><span class="p">:</span> <span class="s2">&quot;{</span><span class="si">% f</span><span class="s2">lip %}&quot;</span><span class="p">,</span>
                <span class="s2">&quot;packet-interval&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="s2">&quot;packet-count&quot;</span><span class="p">:</span> <span class="mi">600</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="s2">&quot;tasks&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;latency_task_sched_by_source&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;latency_group&quot;</span><span class="p">,</span>
            <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;latency_test&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;latency_task_sched_by_dest&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;scheduled-by&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;latency_group&quot;</span><span class="p">,</span>
            <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;latency_test&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the above examples, the first task <code class="docutils literal notranslate"><span class="pre">latency_task_sched_by_source</span></code> uses the default behavior which is the equivalent of <code class="docutils literal notranslate"><span class="pre">scheduled-by</span></code> being set to <code class="docutils literal notranslate"><span class="pre">0</span></code>. Given the <em>test</em> object construction and the fact that all addresses run an agent, then the agent associated with the <code class="docutils literal notranslate"><span class="pre">source</span></code> will always be the one requesting the task. In the second example <code class="docutils literal notranslate"><span class="pre">latency_task_sched_by_dest</span></code>, the <code class="docutils literal notranslate"><span class="pre">scheduled-by</span></code> property is explicitly set to <code class="docutils literal notranslate"><span class="pre">1</span></code> but otherwise the same as the first <em>task</em>. This mean the same task will be scheduled but the agent associated with the <code class="docutils literal notranslate"><span class="pre">dest</span></code> will be the one requesting the task’s creation. This creates a duplicate task with the only difference being the agent that requested it.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you are familiar with the <em>force_birdirectional</em> field available in legacy perfSONAR tools, using <code class="docutils literal notranslate"><span class="pre">scheduled-by</span></code> and defining two tasks above is the way to accomplish the same goal as that option. Generally doing so is not recommended unless you have a very specific reason as it can lead to over-testing with little benefit.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This value is closely linked to the <a class="reference internal" href="psconfig_templates_vars.html#psconfig-templates-vars-scheduled-by-address"><span class="std std-ref">scheduled_by_address template variable</span></a>. See the template variable <a class="reference internal" href="psconfig_templates_vars.html#psconfig-templates-vars-scheduled-by-address"><span class="std std-ref">documentation</span></a> for more details.</p>
</div>
</div>
<div class="section" id="disabling-a-task">
<span id="psconfig-templates-advanced-tasks-disabled"></span><h3>Disabling a Task<a class="headerlink" href="#disabling-a-task" title="Permalink to this headline">¶</a></h3>
<p>If you want to temporarily suspend usage of a <em>task</em> object by agents, then you can set the <code class="docutils literal notranslate"><span class="pre">disabled</span></code> property as shown in the example below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;latency_task&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;disabled&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
    <span class="s2">&quot;group&quot;</span><span class="p">:</span> <span class="s2">&quot;latency_group&quot;</span><span class="p">,</span>
    <span class="s2">&quot;test&quot;</span><span class="p">:</span> <span class="s2">&quot;latency_test&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You can think of this property as a way to “comment-out” a <em>task</em> object since JSON does not natively support comments. It is most useful when you don’t want to entirely delete a <em>task</em> but need to remove it from testing for some amount of time.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <nav id="channelNav" class="channelNav">
                
                <ul>
<li><a class="reference internal" href="#">Advanced pSConfig Templates</a><ul>
<li><a class="reference internal" href="#advanced-addresses-options">Advanced <code class="docutils literal notranslate"><span class="pre">addresses</span></code> Options</a><ul>
<li><a class="reference internal" href="#testing-to-addresses-without-an-agent-reading-your-template">Testing to Addresses without an Agent Reading Your Template</a></li>
<li><a class="reference internal" href="#disabling-an-address">Disabling an Address</a></li>
<li><a class="reference internal" href="#using-non-standard-pscheduler-ports-and-addresses">Using Non-Standard pScheduler Ports and Addresses</a></li>
<li><a class="reference internal" href="#controlling-pscheduler-server-binding">Controlling pScheduler Server Binding</a></li>
<li><a class="reference internal" href="#dynamic-address-properties-with-remote-addresses">Dynamic Address Properties with <code class="docutils literal notranslate"><span class="pre">remote-addresses</span></code></a></li>
<li><a class="reference internal" href="#labeling-address-properties">Labeling Address Properties</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sharing-address-properties-with-hosts">Sharing Address Properties with <code class="docutils literal notranslate"><span class="pre">hosts</span></code></a><ul>
<li><a class="reference internal" href="#introduction-to-hosts">Introduction to <code class="docutils literal notranslate"><span class="pre">hosts</span></code></a></li>
<li><a class="reference internal" href="#setting-host-archives">Setting Host Archives</a></li>
<li><a class="reference internal" href="#disabling-a-host">Disabling a Host</a></li>
</ul>
</li>
<li><a class="reference internal" href="#including-external-files">Including External Files</a></li>
<li><a class="reference internal" href="#using-contexts">Using <code class="docutils literal notranslate"><span class="pre">contexts</span></code></a></li>
<li><a class="reference internal" href="#advanced-groups-options">Advanced <code class="docutils literal notranslate"><span class="pre">groups</span></code> Options</a><ul>
<li><a class="reference internal" href="#excluding-address-pairs">Excluding Address Pairs</a></li>
<li><a class="reference internal" href="#unidirectional-disjoint-groups">Unidirectional Disjoint Groups</a></li>
<li><a class="reference internal" href="#disabling-an-address-selector">Disabling an Address Selector</a></li>
</ul>
</li>
<li><a class="reference internal" href="#advanced-tasks-options">Advanced <code class="docutils literal notranslate"><span class="pre">tasks</span></code> Options</a><ul>
<li><a class="reference internal" href="#setting-tools-for-a-task">Setting Tools For a Task</a></li>
<li><a class="reference internal" href="#setting-task-priority">Setting Task Priority</a></li>
<li><a class="reference internal" href="#setting-the-pscheduler-reference-field">Setting the pScheduler <code class="docutils literal notranslate"><span class="pre">reference</span></code> field</a></li>
<li><a class="reference internal" href="#controlling-the-agent-that-schedules-a-task">Controlling the Agent That Schedules a Task</a></li>
<li><a class="reference internal" href="#disabling-a-task">Disabling a Task</a></li>
</ul>
</li>
</ul>
</li>
</ul>

                <ul>
                  <li>
                  <a href="psconfig_templates_vars.html">Previous topic</a>
                  <ul><li><a href="psconfig_templates_vars.html" title="previous chapter">pSConfig Template Variables</a></li></ul>
                  </li>
                </ul>
                  <ul>
                      <li>
                      <a href="psconfig_meshconfig_migrate.html">Next topic</a>
                      <ul><li><a href="psconfig_meshconfig_migrate.html" title="next chapter">MeshConfig to pSConfig Migration Guide</a></li></ul>
                      </li>
                  </ul>
                
                
            </nav>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="psconfig_meshconfig_migrate.html" title="MeshConfig to pSConfig Migration Guide"
             >next</a> |</li>
        <li class="right" >
          <a href="psconfig_templates_vars.html" title="pSConfig Template Variables"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">perfSONAR Toolkit 4.2.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <footer id="fat">
        <div class="footerContents">
            <nav id="fatFooterNav" class="fatFooterNav">
                <ul id="menu-partners" class="menu depth-0">
                    <li id="footer-partner-text" class="partner-menu">
                        perfSONAR 
                        <br>
                        partners 
                        <br>
                        include: 
                    </li>
    
                <li id="footer-partner-esnet" class="partner-menu">
                    <a href="http://www.es.net/" title="Visit DOE's Energy Sciences Network"><img src="_static/ESnet-ps.png" alt="" style="border:none;"></a> </li>
                
                <li id="footer-partner-geant" class="partner-menu">
                    <a href="http://www.geant.org/" title="Visit GEANT"><img src="_static/geant-ps.png" alt="" style="border:none;"/></a> </li>
        
                <li id="footer-partner-iu" class="partner-menu">
                    <a href="http://www.iu.edu/" title="Visit Indiana University"><img src="_static/IU-ps.png" alt="" style="border:none;"></a> </li>

                <li id="footer-partner-i2" class="partner-menu">
                    <a href="http://www.internet2.edu/" title="Visit Internet2"><img src="_static/I2-ps.png" alt="" style="border:none;"></a> </li>
                
                <li id="footer-partner-um" class="partner-menu">
                    <a href="http://www.umich.edu/" title="Visit University of Michigan"><img src="_static/UM-ps.png" alt="" style="border:none;"></a> </li>

                </ul>

            </nav>
            <nav id="minFooterNav" class="minFooterNav">
                <span class="copyright">PERFormance Service Oriented Network monitoring ARchitecture </span>
            </nav>
          
        </div> <!-- /footerContents -->
    </footer>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, perfSONAR Project.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.1.
    </div>
  </body>
</html>
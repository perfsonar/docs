<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Publishing a pSConfig Template &mdash; perfSONAR Toolkit 4.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/perfsonar.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '4.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="perfSONAR Toolkit 4.1 documentation" href="index.html" />
    <link rel="next" title="Running the pSConfig pScheduler Agent" href="psconfig_pscheduler_agent.html" />
    <link rel="prev" title="Introduction to pSConfig Templates" href="psconfig_templates_intro.html" /> 
  </head>
  <body>
    <header>
        <div class="headerContents">
          <a href="index.html" border="0"><img src="_static/perfSONAR-header.gif"></a>
          <div class="acctSearchContainer">
              <section id="searchBox" class="searchBox">
                  <!--Use of this code assumes agreement with the Google Custom Search Terms of Service. -->
                  <!--The terms of service are available at http://www.google.com/cse/docs/tos.html -->
                  <form action="search.html" id="cse-search-box" method="get">
                    <input type="text" name="q" size="25" class="searchInput" placeholder="Search"/>
                    <input type="hidden" name="check_keywords" value="yes" />
                    <input type="hidden" name="area" value="default" />
                  </form>
              </section>
         </div>
        </div>
    </header>
    <div style="display:block;clear:both;">
    
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="psconfig_pscheduler_agent.html" title="Running the pSConfig pScheduler Agent"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="psconfig_templates_intro.html" title="Introduction to pSConfig Templates"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">perfSONAR Toolkit 4.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    </div>
    
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="publishing-a-psconfig-template">
<h1>Publishing a pSConfig Template<a class="headerlink" href="#publishing-a-psconfig-template" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>After you have <a class="reference internal" href="psconfig_templates_intro.html"><em>created a template</em></a> you will need to publish your template so that it can be downloaded by agents. You have a number of options for doing so including choosing one of the following:</p>
<ul class="simple">
<li><strong>Option 1: Using the pSConfig publisher command-line tools.</strong> This is a set of simple command line tools provided by pSConfig that validate the JSON and save a version of it in a standard location under an Apache web server. More details on this method can be found below in the section <a class="reference internal" href="#psconfig-publish-cli"><em>pSConfig Publisher Command-Line Tools</em></a>.</li>
<li><strong>Option 2: Use pSConfig WebAdmin.</strong> This tool has its own method for publishing templates, see that tool&#8217;s <a class="reference internal" href="pwa.html"><em>documentation</em></a> for more details.</li>
<li><strong>Option 3: Manually copy the template file to a web server.</strong> If you don&#8217;t want to use the above tools you may also manually copy the file to a web server on your own. The exact steps for doing this will depend on your web server&#8217;s setup, but at the end of the day pSConfig templates can be published just like any other file.</li>
<li><strong>Option 4: Put the template on the local filesystem of the agent.</strong> You may either point at it directly or use an agent&#8217;s template include directory. See the <a class="reference internal" href="psconfig_pscheduler_agent.html"><em>Running the pSConfig pScheduler Agent</em></a> and <a class="reference internal" href="psconfig_maddash_agent.html"><em>Running the pSConfig MaDDash Agent</em></a> documents for information on how to do so for individual agents.</li>
</ul>
<p>This document with only cover <em>option 1</em>. If you already have a template, are not using the <a class="reference internal" href="pwa.html"><em>WebAdmin</em></a> and aren&#8217;t sure which of the options to use, then the pSConfig publisher command-line tools are the recommended choice.</p>
</div>
<div class="section" id="psconfig-publisher-command-line-tools">
<span id="psconfig-publish-cli"></span><h2>pSConfig Publisher Command-Line Tools<a class="headerlink" href="#psconfig-publisher-command-line-tools" title="Permalink to this headline">¶</a></h2>
<div class="section" id="installing">
<h3>Installing<a class="headerlink" href="#installing" title="Permalink to this headline">¶</a></h3>
<p>The pSConfig publisher command-line tools can be installed separately or part of a perfSONAR bundle. The tools are included by default in the following bundles:</p>
<ul class="simple">
<li><em>perfsonar-toolkit</em></li>
<li><em>perfsonar-centralmanagement</em></li>
</ul>
<p>If you are running one of these bundles then you already have the tools installed. If not you can install the <em>perfsonar-psconfig-publisher</em> package using your operating system&#8217;s package manager as follows:</p>
<blockquote>
<div><p><em>CentOS</em>:</p>
<div class="highlight-python"><div class="highlight"><pre>yum install perfsonar-psconfig-publisher
</pre></div>
</div>
<p><em>Debian/Ubuntu</em>:</p>
<div class="highlight-python"><div class="highlight"><pre>apt-get install perfsonar-psconfig-publisher
</pre></div>
</div>
</div></blockquote>
<p>This will install the basic psconfig command-line interface and libraries required to use them. It will also install Apache and setup a directory <em>/usr/lib/perfsonar/web-psconfig</em> where template files will be stored. Files under this directory can be accessed via the web at URL <em>https://HOSTNAME/psconfig/TEMPLATE.json</em> where <em>HOSTNAME</em> is the name of your host and <em>TEMPLATE.json</em> is the template file.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Indexes are not enabled on that directory so attempting to visit <a class="reference external" href="https://HOSTNAME/psconfig">https://HOSTNAME/psconfig</a> will return a <em>403 Forbidden</em> error. This is expected and done for security purposes. Once you copy your templates you will not get any such errors when accessing the template file directly.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You may also use <a class="reference external" href="http://">http://</a> in your URL but <a class="reference external" href="https://">https://</a> is recommended. All of the documentation and the command output use https in the displayed URLs.</p>
</div>
</div>
<div class="section" id="publishing-a-file-with-psconfig-publish">
<h3>Publishing a File with <tt class="docutils literal"><span class="pre">psconfig</span> <span class="pre">publish</span></tt><a class="headerlink" href="#publishing-a-file-with-psconfig-publish" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You need to run this command as a <strong>sudo</strong> user since the web directory used by this tool is owned by the <em>perfsonar</em> user and group</p>
</div>
<p>The <tt class="docutils literal"><span class="pre">psconfig</span> <span class="pre">publish</span></tt> command accepts a parameter with the location of a pSConfig template file either on the local filesystem or at an http(s) URL. As an example:</p>
<div class="highlight-python"><div class="highlight"><pre>psconfig publish example.json
</pre></div>
</div>
<p>The command performs the following actions:</p>
<ol class="arabic simple">
<li>If required, automatically detects and translates the given file from legacy MeshConfig format to the new pSConfig format. See <a class="reference internal" href="psconfig_meshconfig_migrate.html"><em>MeshConfig to pSConfig Migration Guide</em></a> for details on what this means.</li>
<li>Validates the input file syntax against the pSConfig template schema. You may skip this step by providing the <tt class="docutils literal"><span class="pre">--skip-validate</span></tt> option.</li>
<li>Adds a <tt class="docutils literal"><span class="pre">psconfig-publisher</span></tt> field to the template <tt class="docutils literal"><span class="pre">_meta</span></tt> object indicating this file was published by the CLI and he time at which this command ran. You may skip this step by providing the <tt class="docutils literal"><span class="pre">--skip-meta</span></tt> option.</li>
<li>Saves the file to <em>/usr/lib/perfsonar/web-psconfig</em> with the same name as the provided file. The output of the file will remove extraneous whitespace in an attempt to be more compact for downloading agents. If you would like the file in a more human-readable format you can specify the <tt class="docutils literal"><span class="pre">--pretty</span></tt> option.</li>
<li>It will output to standard output the location of the saved file as well as the URL and command that can be used to add it to an agent. If you would like to suppress this output you can use the <tt class="docutils literal"><span class="pre">--quiet</span></tt> option.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">None of the changes made to the file are strictly required. The addition of metadata and formatting of the JSON are simply done for convenience. The overall structure of the JSON is unchanged from the original input.</p>
</div>
<p>An example of successful output is:</p>
<div class="highlight-python"><div class="highlight"><pre>Success! File saved to /usr/lib/perfsonar/web-psconfig/example.json

Published file can be accessed at https://HOSTNAME/psconfig/example.json

Execute the following on a host running an agent to use this file:

    psconfig remote add &quot;https://HOSTNAME/psconfig/example.json&quot;
</pre></div>
</div>
<p>If there are any errors reading, validating or saving the file, then they will instead be printed to the screen.</p>
<p>If you need to update a published file, simply run <tt class="docutils literal"><span class="pre">psconfig</span> <span class="pre">publish</span></tt> against the same file and it will overwrite the existing file.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Note that <tt class="docutils literal"><span class="pre">psconfig</span> <span class="pre">publish</span></tt> does not maintain a file history, so once you overwrite a file it is permanently gone.</p>
</div>
<p>If you have any further questions about the supported options you may run the following:</p>
<div class="highlight-python"><div class="highlight"><pre>psconfig publish --help
</pre></div>
</div>
</div>
<div class="section" id="viewing-published-files-with-psconfig-published">
<h3>Viewing Published Files with <tt class="docutils literal"><span class="pre">psconfig</span> <span class="pre">published</span></tt><a class="headerlink" href="#viewing-published-files-with-psconfig-published" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You need to run this command as a <strong>sudo</strong> user since the web directory used by this tool is owned by the <em>perfsonar</em> user and group</p>
</div>
<p>The <tt class="docutils literal"><span class="pre">psconfig</span> <span class="pre">published</span></tt> command lists the location and URL of all the files that are currently published. It supports no additional options. An example command is:</p>
<div class="highlight-python"><div class="highlight"><pre>psconfig published
</pre></div>
</div>
<p>An example of the output is as follows:</p>
<div class="highlight-python"><div class="highlight"><pre>[example.json]
    Local File: /usr/lib/perfsonar/web-psconfig/example.json
    Web URL: https://HOSTNAME/psconfig/example.json
</pre></div>
</div>
<p>If no files are published output will be as follows:</p>
<div class="highlight-python"><div class="highlight"><pre>No files currently published
</pre></div>
</div>
</div>
<div class="section" id="removing-published-files">
<h3>Removing Published Files<a class="headerlink" href="#removing-published-files" title="Permalink to this headline">¶</a></h3>
<p>There is no special tool for unpublishing files. You may do so by removing the file directly from the published directory. If you need help determining the location you may use the <tt class="docutils literal"><span class="pre">psconfig</span> <span class="pre">published</span></tt> command. An example of how to delete a file is as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">rm</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">perfsonar</span><span class="o">/</span><span class="n">web</span><span class="o">-</span><span class="n">psconfig</span><span class="o">/</span><span class="n">example</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <nav id="channelNav" class="channelNav">
                
                <ul>
<li><a class="reference internal" href="#">Publishing a pSConfig Template</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#psconfig-publisher-command-line-tools">pSConfig Publisher Command-Line Tools</a><ul>
<li><a class="reference internal" href="#installing">Installing</a></li>
<li><a class="reference internal" href="#publishing-a-file-with-psconfig-publish">Publishing a File with <tt class="docutils literal"><span class="pre">psconfig</span> <span class="pre">publish</span></tt></a></li>
<li><a class="reference internal" href="#viewing-published-files-with-psconfig-published">Viewing Published Files with <tt class="docutils literal"><span class="pre">psconfig</span> <span class="pre">published</span></tt></a></li>
<li><a class="reference internal" href="#removing-published-files">Removing Published Files</a></li>
</ul>
</li>
</ul>
</li>
</ul>

                <ul>
                  <li>
                  <a href="psconfig_templates_intro.html">Previous topic</a>
                  <ul><li><a href="psconfig_templates_intro.html" title="previous chapter">Introduction to pSConfig Templates</a></li></ul>
                  </li>
                </ul>
                  <ul>
                      <li>
                      <a href="psconfig_pscheduler_agent.html">Next topic</a>
                      <ul><li><a href="psconfig_pscheduler_agent.html" title="next chapter">Running the pSConfig pScheduler Agent</a></li></ul>
                      </li>
                  </ul>
                
                
            </nav>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="psconfig_pscheduler_agent.html" title="Running the pSConfig pScheduler Agent"
             >next</a> |</li>
        <li class="right" >
          <a href="psconfig_templates_intro.html" title="Introduction to pSConfig Templates"
             >previous</a> |</li>
        <li><a href="index.html">perfSONAR Toolkit 4.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <footer id="fat">
        <div class="footerContents">
            <nav id="fatFooterNav" class="fatFooterNav">
                <ul id="menu-partners" class="menu depth-0">
                    <li id="footer-partner-text" class="partner-menu">
                        perfSONAR 
                        <br>
                        partners 
                        <br>
                        include: 
                    </li>
    
                <li id="footer-partner-esnet" class="partner-menu">
                    <a href="http://www.es.net/" title="Visit DOE's Energy Sciences Network"><img src="_static/ESnet-ps.png" alt="" style="border:none;"></a> </li>
                
                <li id="footer-partner-geant" class="partner-menu">
                    <a href="http://www.geant.org/" title="Visit GEANT"><img src="_static/geant-ps.png" alt="" style="border:none;"/></a> </li>
        
                <li id="footer-partner-iu" class="partner-menu">
                    <a href="http://www.iu.edu/" title="Visit Indiana University"><img src="_static/IU-ps.png" alt="" style="border:none;"></a> </li>

                <li id="footer-partner-i2" class="partner-menu">
                    <a href="http://www.internet2.edu/" title="Visit Internet2"><img src="_static/I2-ps.png" alt="" style="border:none;"></a> </li>
                
                <li id="footer-partner-um" class="partner-menu">
                    <a href="http://www.umich.edu/" title="Visit University of Michigan"><img src="_static/UM-ps.png" alt="" style="border:none;"></a> </li>

                </ul>

            </nav>
            <nav id="minFooterNav" class="minFooterNav">
                <span class="copyright">PERFormance Service Oriented Network monitoring ARchitecture </span>
            </nav>
          
        </div> <!-- /footerContents -->
    </footer>
    
    <div class="footer">
        &copy; Copyright 2018, perfSONAR Project.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>
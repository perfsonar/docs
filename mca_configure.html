<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Configuration &mdash; perfSONAR Toolkit 4.0.2 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/perfsonar.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '4.0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="perfSONAR Toolkit 4.0.2 documentation" href="index.html" />
    <link rel="up" title="MeshConfig Administrative GUI" href="mca.html" />
    <link rel="next" title="User Guide" href="mca_userguide.html" />
    <link rel="prev" title="Installation" href="mca_install.html" /> 
  </head>
  <body role="document">
    <header>
        <div class="headerContents">
          <a href="index.html" border="0"><img src="_static/perfSONAR-header.gif"></a>
          <div class="acctSearchContainer">
              <section id="searchBox" class="searchBox">
                  <!--Use of this code assumes agreement with the Google Custom Search Terms of Service. -->
                  <!--The terms of service are available at http://www.google.com/cse/docs/tos.html -->
                  <form action="search.html" id="cse-search-box" method="get">
                    <input type="text" name="q" size="25" class="searchInput" placeholder="Search"/>
                    <input type="hidden" name="check_keywords" value="yes" />
                    <input type="hidden" name="area" value="default" />
                  </form>
              </section>
         </div>
        </div>
    </header>
    <div style="display:block;clear:both;">
    
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="mca_userguide.html" title="User Guide"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mca_install.html" title="Installation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">perfSONAR Toolkit 4.0.2 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="mca.html" accesskey="U">MeshConfig Administrative GUI</a> &raquo;</li> 
      </ul>
    </div>
    </div>
    
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="configuration">
<h1>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h1>
<p>Most of the configuration files for MCA can be found in <strong>/opt/mca/mca/api/config</strong> directory. At minimum, you need to configure the datasources for your instance before you can start using MCA.</p>
<div class="section" id="data-sources">
<h2>Data Sources<a class="headerlink" href="#data-sources" title="Permalink to this headline">¶</a></h2>
<p><strong>datasource.js</strong> lists all sLS and global lookup service that host information is pulled from.</p>
<div class="section" id="global-sls">
<h3>Global SLS<a class="headerlink" href="#global-sls" title="Permalink to this headline">¶</a></h3>
<p>A sample datasource entry for Global SLS</p>
<div class="highlight-python"><div class="highlight"><pre>&quot;osg&quot;: {
    label: &#39;OSG&#39;,
    type: &#39;global-sls&#39;,
    activehosts_url: &#39;http://ps1.es.net:8096/lookup/activehosts.json&#39;,
    query: &#39;?type=service&amp;group-communities=OSG&#39;,
},
</pre></div>
</div>
<ul class="simple">
<li>&#8220;osg&#8221; is used as internal key to identify this datasource. Pick one that&#8217;s unique.</li>
<li>label: is used to show the datasource name in the web UI</li>
<li>type: needs to be &#8220;global-sls&#8221; for Global SLS datasource.</li>
<li>activehosts_url: should always point to <a class="reference external" href="http://ps1.es.net:8096/lookup/activehosts.json">http://ps1.es.net:8096/lookup/activehosts.json</a> unless you know a different global registry.</li>
<li>query: This query is passed to all sLS instances that are member of the global registry. For more detail on sLS query, please refer to <a class="reference external" href="https://github.com/esnet/simple-lookup-service/wiki/APISpec#query">sLS API Spec</a></li>
</ul>
<p>So, the above sample datasource entry instructs mca-cache service to pull all service records (used to construct &#8220;hosts&#8221; for MCA) from the global lookup service (ps1.es.net) with community registered to &#8220;OSG&#8221;. If you don&#8217;t want any hosts from OSG, simply remove this section, or update the label and group-communities to something other than OSG.</p>
<p>As you may find in the default datasource.js, you can list as many datasources as you want. Make sure to use a unique key, and label.</p>
</div>
<div class="section" id="sls">
<h3>sLS<a class="headerlink" href="#sls" title="Permalink to this headline">¶</a></h3>
<p>If you have your private sLS instance, entering something like following</p>
<div class="highlight-python"><div class="highlight"><pre>&quot;wlcg&quot;: {
    label: &#39;WLCG&#39;,
    type: &#39;sls&#39;,
    url: &#39;https://soichi7.ppa.iu.edu/sls/lookup/records/?type=service&amp;group-communities=WLCG&#39;,
    //exclude: [], //TODO - allow user to remove certain service from appearing in the UI
    cache: 1000*60*5, //refresh every 5 minutes (default 30 minutes)
},
</pre></div>
</div>
<ul class="simple">
<li>&#8220;wlcg&#8221; is used as internal key to identify this datasource. Pick one that&#8217;s unique</li>
<li>label: is used to show the datasource name in the web UI</li>
<li>type: needs to be &#8216;sls&#8217;</li>
<li>url: URL for your private sLS instance. For type off queries, please refer to <a class="reference external" href="https://github.com/esnet/simple-lookup-service/wiki/APISpec#query">sLS API Spec</a></li>
<li>cache: refrequency of polling from this sLS in msec.</li>
</ul>
<p>When you update this file, all meshconfig services will automatically restarts. Please monitor logs by &#8220;sudo -u mca pm2 logs&#8221;</p>
</div>
</div>
<div class="section" id="database">
<h2>Database<a class="headerlink" href="#database" title="Permalink to this headline">¶</a></h2>
<p><strong>db.js</strong> is normally auto-generated by the setup script (please see <a class="reference internal" href="mca_install.html"><em>Installation</em></a>), but you can update this to point to an appropriate DB endpoint.</p>
<p>For example, to use mysql instead of postgres, update this to something like</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">module</span><span class="o">.</span><span class="n">exports</span> <span class="o">=</span> <span class="s">&#39;mysql://localhost:3306/database&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>Or.. for SQLite</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">module</span><span class="o">.</span><span class="n">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">dialect</span><span class="p">:</span> <span class="s">&#39;sqlite&#39;</span><span class="p">,</span>
    <span class="n">storage</span><span class="p">:</span> <span class="s">&quot;/usr/local/tmp/meshconfig.sqlite&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>MeshConfig Admin uses <a class="reference external" href="http://docs.sequelizejs.com/en/1.7.0/docs/usage/">Sequelize</a> which supports MySQL, MariaDB, SQLite, and PostgreSQL.</p>
<p>When you update this file, all meshconfig services will automatically restarts. Please monitor logs by &#8220;sudo -u mca pm2 logs&#8221;</p>
</div>
<div class="section" id="test-spec-default-parameters">
<h2>Test Spec Default parameters<a class="headerlink" href="#test-spec-default-parameters" title="Permalink to this headline">¶</a></h2>
<p><strong>meshconfig.js</strong> contains default values for various test specification. Update this to your liking (please send us comments if we should be using a different default).</p>
<p>When you update this file, all meshconfig services will automatically restarts. Please monitor logs by &#8220;sudo -u mca pm2 logs&#8221;</p>
</div>
<div class="section" id="logging">
<h2>Logging<a class="headerlink" href="#logging" title="Permalink to this headline">¶</a></h2>
<p><strong>logger.js</strong> contains logging related configuration. MCA uses Winston for logging. Please see <a class="reference external" href="https://github.com/winstonjs/winston">Winston</a> for more detail.</p>
</div>
<div class="section" id="others">
<h2>Others<a class="headerlink" href="#others" title="Permalink to this headline">¶</a></h2>
<p><strong>index.js</strong> contains all other configuration such as ports and host names to bind MCA server and MCA publisher. It also contain information such as the location of JWT public key to verify token issued by SCA authentication service.</p>
</div>
<div class="section" id="authentication-service-sca-auth">
<h2>Authentication Service (sca-auth)<a class="headerlink" href="#authentication-service-sca-auth" title="Permalink to this headline">¶</a></h2>
<p>MCA uses authentication microservices developed by SCA (Scalable Computing Archive) group at IU. You can enable / disable various authentication methods provided by sca-auth by modifying /opt/mca/auth/api/config/ .</p>
<p>Certain features in MCA are restricted to only super-admin. In order to become a super-admin, you will need to run following as root via the command line.</p>
<div class="highlight-python"><div class="highlight"><pre>cd /opt/mca/auth/bin
./auth.js modscope --username hayashis --add &#39;{&quot;mca&quot;: [&quot;admin&quot;]}&#39;
</pre></div>
</div>
<p>You need to sign out &amp; login again in order for this change to take effect.</p>
<p>Please refer to <a class="reference external" href="https://github.com/soichih/sca-auth">sca-auth gitrepo</a> for more information.</p>
</div>
<div class="section" id="profile-service-sca-profile">
<h2>Profile Service (sca-profile)<a class="headerlink" href="#profile-service-sca-profile" title="Permalink to this headline">¶</a></h2>
<p>MCA uses profile microservices developed by SCA (Scalable Computing Archive) group at IU. Please refer to <a class="reference external" href="https://github.com/soichih/sca-profile">sca-profile gitrepo</a> for more information.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <nav id="channelNav" class="channelNav">
                
                <ul>
<li><a class="reference internal" href="#">Configuration</a><ul>
<li><a class="reference internal" href="#data-sources">Data Sources</a><ul>
<li><a class="reference internal" href="#global-sls">Global SLS</a></li>
<li><a class="reference internal" href="#sls">sLS</a></li>
</ul>
</li>
<li><a class="reference internal" href="#database">Database</a></li>
<li><a class="reference internal" href="#test-spec-default-parameters">Test Spec Default parameters</a></li>
<li><a class="reference internal" href="#logging">Logging</a></li>
<li><a class="reference internal" href="#others">Others</a></li>
<li><a class="reference internal" href="#authentication-service-sca-auth">Authentication Service (sca-auth)</a></li>
<li><a class="reference internal" href="#profile-service-sca-profile">Profile Service (sca-profile)</a></li>
</ul>
</li>
</ul>

                <ul>
                  <li>
                  <a href="mca_install.html">Previous topic</a>
                  <ul><li><a href="mca_install.html" title="previous chapter">Installation</a></li></ul>
                  </li>
                </ul>
                  <ul>
                      <li>
                      <a href="mca_userguide.html">Next topic</a>
                      <ul><li><a href="mca_userguide.html" title="next chapter">User Guide</a></li></ul>
                      </li>
                  </ul>
                
                
            </nav>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="mca_userguide.html" title="User Guide"
             >next</a> |</li>
        <li class="right" >
          <a href="mca_install.html" title="Installation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">perfSONAR Toolkit 4.0.2 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="mca.html" >MeshConfig Administrative GUI</a> &raquo;</li> 
      </ul>
    </div>
    <footer id="fat">
        <div class="footerContents">
            <nav id="fatFooterNav" class="fatFooterNav">
                <ul id="menu-partners" class="menu depth-0">
                    <li id="footer-partner-text" class="partner-menu">
                        perfSONAR 
                        <br>
                        partners 
                        <br>
                        include: 
                    </li>
    
                <li id="footer-partner-esnet" class="partner-menu">
                    <a href="http://www.es.net/" title="Visit DOE's Energy Sciences Network"><img src="_static/ESnet-ps.png" alt="" style="border:none;"></a> </li>
                
                <li id="footer-partner-geant" class="partner-menu">
                    <a href="http://www.geant.org/" title="Visit GEANT"><img src="_static/geant-ps.png" alt="" style="border:none;"/></a> </li>
        
                <li id="footer-partner-iu" class="partner-menu">
                    <a href="http://www.iu.edu/" title="Visit Indiana University"><img src="_static/IU-ps.png" alt="" style="border:none;"></a> </li>

                <li id="footer-partner-i2" class="partner-menu">
                    <a href="http://www.internet2.edu/" title="Visit Internet2"><img src="_static/I2-ps.png" alt="" style="border:none;"></a> </li>
                
                <li id="footer-partner-um" class="partner-menu">
                    <a href="http://www.umich.edu/" title="Visit University of Michigan"><img src="_static/UM-ps.png" alt="" style="border:none;"></a> </li>

                </ul>

            </nav>
            <nav id="minFooterNav" class="minFooterNav">
                <span class="copyright">PERFormance Service Oriented Network monitoring ARchitecture </span>
            </nav>
          
        </div> <!-- /footerContents -->
    </footer>
    
    <div class="footer" role="contentinfo">
        &copy; Copyright 2018, perfSONAR Project.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>